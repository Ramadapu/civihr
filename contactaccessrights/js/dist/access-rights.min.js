define("access-rights/modules/controllers",["common/angular","common/angularBootstrap"],function(t){"use strict";return t.module("access-rights.controllers",["ui.bootstrap"])}),define("access-rights/controllers/access-rights-ctrl",["access-rights/modules/controllers"],function(t){"use strict";t.controller("AccessRightsCtrl",["$rootElement","$modal",function(t,e){return{openModal:function(){e.open({targetDomEl:t.children().eq(0),controller:"AccessRightsModalCtrl",controllerAs:"modalCtrl",bindToController:!0,templateUrl:CRM.vars.contactAccessRights.baseURL+"/views/access-rights-modal.html"})}}}])}),define("access-rights/controllers/access-rights-modal-ctrl",["common/lodash","access-rights/modules/controllers"],function(t,e){"use strict";e.controller("AccessRightsModalCtrl",["$q","$modalInstance","Region","Location","Right",function(e,i,n,s,o){function c(i){var n=r.originalData[i],s=r.selectedData[i],c=n.map(function(t){return t.entity_id}),a=t.difference(s,c),l=t.difference(c,s).map(function(e){return t.find(n,function(t){return t.entity_id===e}).id}),u=[];return a.length>0&&u.push(o["save"+t.capitalize(i)](a)),l.length>0&&u.push(o.deleteByIds(l)),e.all(u)}var r=this;r.availableData={regions:[],locations:[]},r.selectedData={locations:[],regions:[]},r.originalData={locations:[],regions:[]},r.errorMsg="",r.dataLoaded=!1,r.cancel=function(){i.dismiss("cancel")},r.submit=function(){e.all([c("regions"),c("locations")]).then(function(){i.dismiss("cancel")})["catch"](function(t){r.errorMsg="Error while saving data"})},e.all([n.getAll().then(function(t){return r.availableData.regions=t,o.getRegions()}).then(function(t){r.originalData.regions=t,r.selectedData.regions=t.map(function(t){return t.entity_id})}),s.getAll().then(function(t){return r.availableData.locations=t,o.getLocations()}).then(function(t){r.originalData.locations=t,r.selectedData.locations=t.map(function(t){return t.entity_id})})]).then(function(){r.dataLoaded=!0})}])}),define("access-rights/modules/models",["common/angular","common/modules/apis"],function(t){"use strict";return t.module("access-rights.models",["common.apis"])}),define("access-rights/models/region",["access-rights/modules/models","common/services/api/api-builder"],function(t){"use strict";t.factory("Region",["apiBuilder",function(t){return t.build({getAll:function(t,e,i){return this.getAllEntities(t,e,i)}},"OptionValue",{option_group_name:"hrjc_region"})}])}),define("access-rights/models/location",["access-rights/modules/models","common/services/api/api-builder"],function(t){"use strict";t.factory("Location",["apiBuilder",function(t){return t.build({getAll:function(t,e,i){return this.getAllEntities(t,e,i)}},"OptionValue",{option_group_name:"hrjc_location"})}])}),define("access-rights/models/right",["access-rights/modules/models","common/services/api/api-builder"],function(t){"use strict";t.factory("Right",["apiBuilder","$q","$location",function(t,e,i){var n={getLocations:function(t,e,i){return this.getAllEntities(t,e,i,{action:"getlocations"})},getRegions:function(t,e,i){return this.getAllEntities(t,e,i,{action:"getregions"})},deleteByIds:function(t){return e.all(t.map(function(t){return this.removeEntity({id:t})}.bind(this)))},saveRegions:function(t){return e.all(t.map(function(t){return this.saveEntity({entity_id:t,entity_type:"hrjc_region"})}.bind(this)))},saveLocations:function(t){return e.all(t.map(function(t){return this.saveEntity({entity_id:t,entity_type:"hrjc_location"})}.bind(this)))}};return t.build(n,"Rights",{contact_id:i.search().cid})}])}),define("access-rights/app",["common/angular","common/ui-select","common/directives/loading","access-rights/controllers/access-rights-ctrl","access-rights/controllers/access-rights-modal-ctrl","access-rights/models/region","access-rights/models/location","access-rights/models/right"],function(t){"use strict";return t.module("access-rights",["ui.select","xeditable-civi","access-rights.controllers","access-rights.models"]).run(["$log","editableOptions","editableThemes",function(t,e,i){t.debug("app.run"),e.theme="bs3"}]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0,requireBase:!1})}]),t}),define("access-rights/dom-initialization",["common/angular"],function(t){"use strict";return{addAppToDOM:function(){var e=t.element(".crm-actions-ribbon ul#actions"),i=t.element('<li id="access-rights">           <div ng-controller="AccessRightsCtrl as $ctrl" id="bootstrap-theme">             <a href class="edit button pull-right" ng-click="$ctrl.openModal()" id="manage-roles-and-teams">               <div class="icon settings-icon"></div> Manage roles and teams             </a>           </div>         </li>');return e.append(i),i}}}),function(){"use strict";var t=CRM.vars.contactAccessRights.baseURL+"/js/src/access-rights";require.config({urlArgs:"bust="+(new Date).getTime(),paths:{"access-rights":t}}),require(["access-rights/app","access-rights/dom-initialization"],function(t,e){t.bootstrap(e.addAppToDOM(),["access-rights"])})}(require);