define("access-rights/modules/controllers",["common/angular","common/angularBootstrap"],function(t){return t.module("access-rights.controllers",["ui.bootstrap"])}),define("access-rights/controllers/access-rights-ctrl",["access-rights/modules/controllers"],function(t){"use strict";t.controller("AccessRightsCtrl",["$rootElement","$modal",function(t,e){return{openModal:function(){e.open({targetDomEl:t.children().eq(0),controller:"AccessRightsModalCtrl",controllerAs:"modalCtrl",bindToController:!0,templateUrl:CRM.vars.contactAccessRights.baseURL+"/views/access-rights-modal.html"})}}}])}),define("access-rights/controllers/access-rights-modal-ctrl",["access-rights/modules/controllers"],function(t){"use strict";t.controller("AccessRightsModalCtrl",["Region","Location","Right","$q","$modalInstance",function(t,e,i,n,s){function o(){return r(a.originalData.regions,a.selectedData.regions,i.saveRegions.bind(i))}function c(){return r(a.originalData.locations,a.selectedData.locations,i.saveLocations.bind(i))}function r(t,e,s){var o=t.map(function(t){return t.entity_id}),c=_.difference(e,o),r=_.difference(o,e).map(function(e){return _.find(t,function(t){return t.entity_id===e}).id}),a=[];return c.length>0&&a.push(s(c)),r.length>0&&a.push(i.deleteByIds(r)),n.all(a)}var a=this;a.availableData={regions:[],locations:[]},a.selectedData={locations:[],regions:[]},a.originalData={locations:[],regions:[]},a.errorMsg="",a.cancel=function(){s.dismiss("cancel")},a.submit=function(){n.all([o(),c()]).then(function(){s.dismiss("cancel")})["catch"](function(t){a.errorMsg="Error while saving data"})},t.getAll().then(function(t){return a.availableData.regions=t,i.getRegions()}).then(function(t){a.originalData.regions=t,a.selectedData.regions=t.map(function(t){return t.entity_id})}),e.getAll().then(function(t){return a.availableData.locations=t,i.getLocations()}).then(function(t){a.originalData.locations=t,a.selectedData.locations=t.map(function(t){return t.entity_id})})}])}),define("access-rights/modules/models",["common/angular","common/modules/apis"],function(t){"use strict";return t.module("access-rights.models",["common.apis"])}),define("access-rights/models/region",["access-rights/modules/models","common/services/api/api-builder"],function(t){"use strict";t.factory("Region",["apiBuilder",function(t){return t.build({getAll:function(t,e,i){return this.getAllEntities(t,e,i)}},"OptionValue",{option_group_name:"hrjc_region"})}])}),define("access-rights/models/location",["access-rights/modules/models","common/services/api/api-builder"],function(t){"use strict";t.factory("Location",["apiBuilder",function(t){return t.build({getAll:function(t,e,i){return this.getAllEntities(t,e,i)}},"OptionValue",{option_group_name:"hrjc_location"})}])}),define("access-rights/models/right",["access-rights/modules/models","common/services/api/api-builder"],function(t){"use strict";t.factory("Right",["apiBuilder","$q","$location",function(t,e,i){var n={getLocations:function(t,e,i){return this.getAllEntities(t,e,i,{action:"getlocations"})},getRegions:function(t,e,i){return this.getAllEntities(t,e,i,{action:"getregions"})},deleteByIds:function(t){return e.all(t.map(function(t){return this.removeEntity({id:t})}.bind(this)))},saveRegions:function(t){return e.all(t.map(function(t){return this.saveEntity({entity_id:t,entity_type:"hrjc_region"})}.bind(this)))},saveLocations:function(t){return e.all(t.map(function(t){return this.saveEntity({entity_id:t,entity_type:"hrjc_location"})}.bind(this)))}};return t.build(n,"Rights",{contact_id:i.search().cid})}])}),define("access-rights/app",["common/angular","common/ui-select","common/directives/loading","access-rights/controllers/access-rights-ctrl","access-rights/controllers/access-rights-modal-ctrl","access-rights/models/region","access-rights/models/location","access-rights/models/right"],function(t){return t.module("access-rights",["access-rights.controllers","access-rights.models","ui.select","xeditable-civi"]).run(["$log","editableOptions","editableThemes",function(t,e,i){t.debug("app.run"),e.theme="bs3"}]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0,requireBase:!1})}]),t}),function(){var t=CRM.vars.contactAccessRights.baseURL+"/js/src/access-rights";require.config({urlArgs:"bust="+(new Date).getTime(),paths:{"access-rights":t}}),require(["access-rights/app"],function(t){var e=t.element(".crm-actions-ribbon ul#actions"),i=t.element('<li id="access-rights"><div id="bootstrap-theme">         <div ng-controller="AccessRightsCtrl as $ctrl">           <a href class="btn btn-secondary-outline text-uppercase pull-right" ng-click="$ctrl.openModal()">             <i class="fa fa-wrench fa-fw"></i> Manage roles and teams           </a>         </div>       </div></li>');e.append(i),t.bootstrap(i,["access-rights"])})}(require);