<div class="chr_leave-balance-tab">
  <crm-loading show="!leaveBalanceTab.loading.component">
    <leave-balance-tab-filters
      absence-periods="leaveBalanceTab.absencePeriods"
      absence-types="leaveBalanceTab.absenceTypes"
      logged-in-contact-id="leaveBalanceTab.loggedInContactId">
    </leave-balance-tab-filters>

    <div class="chr_leave-balance-tab__report panel panel-default">
      <div class="panel-body">
        <crm-loading show="!leaveBalanceTab.loading.report">
          <h4>Results <span class="chr_leave-balance-tab__results-value">({{leaveBalanceTab.reportCount}})</span></h4>
          <div class="chr_leave-balance-tab__overflow-scroll">
            <table class="table table-responsive">
              <tbody>
                <tr>
                  <th colspan="2"></th>
                  <th colspan="4" ng-repeat="type in leaveBalanceTab.selectedAbsenceTypes">{{type.title}}</th>
                </tr>
                <tr>
                  <th class="chr_leave-balance-tab__contact-id-column">Contact ID</th>
                  <th class="chr_leave-balance-tab__name-column">Name</th>
                  <th ng-repeat-start="absenceTypes in leaveBalanceTab.selectedAbsenceTypes">Entitlement</th>
                  <th>Used</th>
                  <th>Balance</th>
                  <th ng-repeat-end>Requested</th>
                </tr>
              </tbody>
              <tbody>
                <tr ng-repeat="record in leaveBalanceTab.report">
                  <td>{{record.contact_id}}</td>
                  <td>{{record.contact_display_name}}</td>
                  <td ng-repeat-start="type in  leaveBalanceTab.selectedAbsenceTypes">{{record.absence_types[type.id].entitlement}}</td>
                  <td>{{record.absence_types[type.id].used}}</td>
                  <td>{{record.absence_types[type.id].balance}}</td>
                  <td ng-repeat-end>{{record.absence_types[type.id].requested}}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <nav class="chr_leave-balance-report__pagination">
            <uib-pagination
              total-items="leaveBalanceTab.reportCount"
              items-per-page="leaveBalanceTab.pagination.size"
              ng-model="leaveBalanceTab.pagination.page"
              ng-change="leaveBalanceTab.loadReportCurrentPage()">
            </uib-pagination>
          </nav>
        </crm-loading>
      </div>
    </div>
  </crm-loading>
</div>
