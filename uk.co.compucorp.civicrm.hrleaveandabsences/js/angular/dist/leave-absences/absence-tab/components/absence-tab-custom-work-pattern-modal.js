define(["common/moment","leave-absences/absence-tab/modules/components"],function(e,n){function t(n,t,o,a,s,r){function c(e){u.errorMessage=e}function l(){return r.get().then(function(e){u.workPatterns=e})}function i(){return a.valuesOf("hrjc_revision_change_reason").then(function(e){u.changeReasons=e})}n.debug("Component: absence-tab-custom-work-pattern-modal");var u=Object.create(this);return u.changeReasons=[],u.errorMessage="",u.saveInProgress=!1,u.workPatterns=[],u.loading={content:!0},u.selected={workPattern:null,effectiveDate:null,changeReason:null},u.uiOptions={effectiveDate:{show:!1,options:{startingDay:1,showWeeks:!1}}},function(){return t.all([l(),i()]).finally(function(){u.loading.content=!1})}(),u.closeModal=function(){u.dismiss({$value:"cancel"})},u.closeAlert=function(){u.errorMessage=""},u.save=function(){var n=e(u.selected.effectiveDate).format(s.serverDateFormat);return u.saveInProgress=!0,r.assignWorkPattern(u.contactId,u.selected.workPattern.id,n,null,u.selected.changeReason).then(function(){o.$broadcast("CustomWorkPattern::Added"),u.closeModal()}).catch(c).finally(function(){u.saveInProgress=!1})},u}n.component("absenceTabCustomWorkPatternModal",{bindings:{contactId:"<",dismiss:"&"},templateUrl:["settings",function(e){return e.pathTpl+"components/absence-tab-custom-work-pattern-modal.html"}],controllerAs:"workPatternModal",controller:["$log","$q","$rootScope","OptionGroup","shared-settings","WorkPatternAPI",t]})});