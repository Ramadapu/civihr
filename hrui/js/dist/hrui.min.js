!function(t,n){function c(n){n?(t(".crm-summary-contactname-block").removeClass("crm-summary-contactname-block-without-contract"),n.position&&t(".crm-contact-detail-position").html("<strong>Position:</strong> "+n.position),n.location&&t(".crm-contact-detail-location").html("<strong>Normal place of work:</strong> "+n.location)):(t(".crm-summary-contactname-block").addClass("crm-summary-contactname-block-without-contract"),t(".crm-contact-detail-position").html(""),t(".crm-contact-detail-location").html(""),o(null))}function o(n){n&&n.departments&&n.departments.length>0?t(".crm-contact-detail-departments").html("<strong>Department:</strong> "+n.departments.join(", ")):t(".crm-contact-detail-departments").html("")}t(document).on("crmLoad",function(n){t(".crm-inline-edit").one("DOMSubtreeModified",function(){var n=t(this).find("form");1===n.length&&n.find("label").each(function(){var n=t(this),c=n.attr("for");t("#"+c).attr("placeholder",n.text())})})}).on("updateContactHeader",function(t,n){void 0!==n.contract&&c(n.contract),void 0!==n.roles&&o(n.roles)}).on("click",function(n){if(t(n.target).is("#crm-contact-actions-link, #crm-contact-actions-link *"))return t("#crm-contact-actions-link").addClass("active"),!1;t("#crm-contact-actions-link").removeClass("active")})}(CRM.$,CRM._);
!function(t,e){function a(){var e=t(".crm-link-home");_(e,d(e,C(e)))}function n(){t.ajax("/civicrm/hrcore/usermenu?snippet=4",{dataType:"html",success:function(t){f(t,"civihr-menu")}})}function o(){if(CRM.cid&&CRM.hideGId){var e=t(".Inline_Custom_Data");e.appendTo(t("#contactinfo-block").parent("div").parent("div")),e.removeClass("crm-collapsible"),e.removeClass("collapsed"),e.addClass("crm-summary-block"),t(".Inline_Custom_Data div.collapsible-title").css({display:"none"}),t(".Inline_Custom_Data div.crm-summary-block").css({display:"block"})}t("#customFields").length<1&&(t("#Inline_Custom_Data label").each(function(){t("#nick_name").parent().after('<td id="customFields"></td>');var e=t(this).attr("for"),a=t("#"+e).detach();t("#customFields").append(t(this)),t("#customFields").append(a)}),t("#Inline_Custom_Data").remove())}function i(e){1===t(e).length&&t(e).on("change",u)}function c(){t(".CRM_HRRecruitment_Form_Application").addClass("crm-form-block"),t(".CRM_HRRecruitment_Form_Application .crm-profile-name-application_profile").addClass("form-layout-compressed")}function r(e){"contactForm"!==CRM.formName&&"viewSummary"!==CRM.pageName||(t(".crm-contact-job_title",".crm-summary-contactinfo-block").length&&t(".crm-contact-tabs-list #tab_summary a",e.target).text("Personal Details"),o(e.target),h(e.target))}function m(){1===t(".CRM_HRRecruitment_Form_HRVacancy").length&&(p(t('label[for="start_date"]').parents("tr")),p(t('label[for="end_date"]').parents("tr")),t('[name="entryURL"]').val().indexOf(";template=1")>-1&&t(t(".CRM_HRRecruitment_Form_HRVacancy tbody").get(0)).addClass("CRM_HRRecruitment_Form_HRVacancy_Template"))}function l(){t("#activityCustomData").attr("colspan",3),t("#crm-activity-view-table .crm-case-activity-view-Client .label").html("Contact"),t("span.crm-frozen-field",".crm-profile-name-hrident_tab").closest("div").parent("div").hide(),t(".crm-accordion-header.crm-master-accordion-header").on("click",function(){window.setTimeout(function(){Array.prototype.forEach.call(document.querySelectorAll(".listing-box"),function(t){Ps.initialize(t)})},0)})}function s(){t("INPUT#contact_source").parent("td").children("a").click(function(){t("#crm-notification-container .crm-help .notify-content").remove(),t("#crm-notification-container .crm-help p").length&&t("#crm-notification-container .crm-help p").remove(),t("#crm-notification-container .crm-help").append("<p>Source is a useful field where data has been migrated to CiviHR from one or a number of other legacy systems. The Source field will indicate which legacy system the contact has come from.</p>")})}function d(e,a){return t("li > a",e).first().text("Home").wrapInner('<span class="menumain-label">').prepend(a)}function f(e,a){var n=t(e),o=t("<div>");o.attr("id",a),o.append(t("#civicrm-menu")),o.append(n),o.insertAfter("#page")}function u(){var e=t(this)[0].files[0];t("#js-uploaded-file").remove(),void 0!==e&&(t(this).after('<span id="js-uploaded-file" class="uploaded-file">'+e.name+' <span class="uploaded-file-icon-trash"><i class="fa fa-trash-o"></i> Remove</span>'),t(".uploaded-file-icon-trash").on("click",v))}function p(t){t.find("label").attr("for",t.find(".crm-form-date").attr("id"))}function h(e){t("div.crm-contact-current_employer, div.crm-contact-job_title",".crm-summary-contactinfo-block").parent("div.crm-summary-row").hide(),t("form#ContactInfo input#employer_id, form#ContactInfo input#job_title",e).closest("div.crm-summary-row").hide(),t("input#employer_id, input#job_title","form#Contact").parent("td").hide(),t(".HRJobContract_Summary",e).insertBefore(t(".crm-summary-contactinfo-block")),t("div.email-signature, td#Email-Bulkmail-html","form#Contact").hide(),t("#Email-Primary","form#Contact").prev("td").prev("td").hide(),t("td#Email-Bulkmail-html, #Email-Primary","form#Contact").prev("td").hide(),t(".crm-demographics-accordion","form#Contact").insertAfter(t(".crm-contactDetails-accordion")),t("tr#Phone_Block_2","form#Contact").length<1&&t("#addPhone").click()}function v(){var e=t("#js-uploaded-file").parent().find('input[type="file"]');t("#js-uploaded-file").remove(),e.val("")}function _(t,e){t.off().find("#civicrm-home").before(e).remove()}function C(e){return t(".crm-logo-sm",e).addClass("chr_logo chr_logo--default-color").removeClass("crm-logo-sm").wrap('<span class="menumain-icon">').parent()}function y(){t(".menumain").not(".crm-Self_Service_Portal").hover(function(){t(this).addClass("activetarget")},function(){t(this).removeClass("activetarget")})}function b(){t("#root-menu-div .menu-item-arrow").each(function(e){var a=t(this);a.before('<i class="fa fa-caret-right menu-item-arrow"></i>'),a.remove()})}t(document).on("crmLoad",function(t){i("input[type='file']"),m(),r(t),l(),s()}).ready(function(){n(),a(),c(),b(),y()})}(CRM.$,CRM._);
!function(t){"use strict";var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t.fn.attrchange=function(t){if(n){var e={subtree:!1,attributes:!0},i=new n(function(n){n.forEach(function(n){t.call(n.target,n)})});return this.each(function(){i.observe(this,e)})}}}(CRM.$);
!function(t){"use strict";var i=t("body");i.on("click",".btn-slide",function(){function n(){t(".civihr-popup").remove(),i.removeClass("civihr-popup-open")}function a(){var n=s.offset(),a=d.clone(!0).appendTo(i).addClass("civihr-popup").attr("id",r.id).addClass(t(r).attr("class"));a.css({left:+n.left-(a.width()-s.outerWidth()),top:+n.top+s.outerHeight()}),a.show(),o(a)}function c(){s.data("attrchange-is-on")||(s.data("attrchange-is-on",!0),s.attrchange(function(){s.hasClass("btn-slide-active")||n()}))}function o(i){i.find("a").click(function(){var i=t(this).parent().index();d.find("li:nth("+i+") a").click()})}function e(){n(),a(),i.addClass("civihr-popup-open")}var s=t(this),r=s.closest(".crm-entity")[0],d=s.children("ul.panel");!function(){e(),c()}()})}(CRM.$);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3QuanMiLCJocnVpLmpzIiwiY2l2aWhyLXBvcHVwL2F0dHJjaGFuZ2UuanMiLCJjaXZpaHItcG9wdXAvY2l2aWhyLXBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJfIiwidXBkYXRlQ29udGFjdEhlYWRlckNvbnRyYWN0RGV0YWlscyIsImNvbnRyYWN0IiwicmVtb3ZlQ2xhc3MiLCJwb3NpdGlvbiIsImh0bWwiLCJsb2NhdGlvbiIsImFkZENsYXNzIiwidXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyIsInJvbGVzIiwiZGVwYXJ0bWVudHMiLCJsZW5ndGgiLCJqb2luIiwiZG9jdW1lbnQiLCJvbiIsImUiLCJvbmUiLCIkZm9ybSIsInRoaXMiLCJmaW5kIiwiZWFjaCIsIiRsYWJlbCIsImlkIiwiYXR0ciIsInRleHQiLCJkYXRhIiwidGFyZ2V0IiwiaXMiLCJDUk0iLCJhbWVuZEFwcExvZ29NZW51SXRlbSIsIiRtZW51SXRlbSIsInJlbW92ZUxvZ29TdWJNZW51QW5kS2VlcE9ubHlIb21lTGluayIsImN1c3RvbWl6ZUhvbWVMaW5rSW5Mb2dvTWVudUl0ZW0iLCJzd2FwQW5kV3JhcEFwcExvZ28iLCJhZGRVc2VyTWVudVRvTWFpbk1lbnUiLCJhamF4IiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwibWVudU1hcmt1cCIsImluamVjdFVzZXJNZW51SW5BTWFpbk1lbnVXcmFwcGVyIiwiYWRkR292ZXJubWVudElkRmllbGQiLCJjaWQiLCJoaWRlR0lkIiwiaW5saW5lRGF0YUJsb2NrIiwiYXBwZW5kVG8iLCJwYXJlbnQiLCJjc3MiLCJkaXNwbGF5IiwiYWZ0ZXIiLCJub2RlSUQiLCJjdXN0b21GaWVsZCIsImRldGFjaCIsImFwcGVuZCIsInJlbW92ZSIsImFkZFVwbG9hZEZpbGVMaXN0ZW5lciIsInNlbGVjdG9yIiwiaW5zZXJ0RmlsZSIsImFtZW5kQXBwbGljYXRpb25Gb3JtIiwiYW1lbmRDb250YWN0UGFnZUFuZEZvcm0iLCJmb3JtTmFtZSIsInBhZ2VOYW1lIiwibWlzY0NvbnRhY3RQYWdlQ2hhbmdlcyIsImFtZW5kVmFjYW5jeUZvcm0iLCJsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCIsInBhcmVudHMiLCJ2YWwiLCJpbmRleE9mIiwiZ2V0IiwiYXBwbHlNaXNjQ2hhbmdlcyIsImNsb3Nlc3QiLCJoaWRlIiwid2luZG93Iiwic2V0VGltZW91dCIsIkFycmF5IiwicHJvdG90eXBlIiwiZm9yRWFjaCIsImNhbGwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWxlbWVudCIsIlBzIiwiaW5pdGlhbGl6ZSIsImNoYW5nZUNvbnRhY3RTb3VyY2VGaWVsZEhlbHBUZXh0IiwiY2hpbGRyZW4iLCJjbGljayIsIiRhcHBMb2dvIiwiZmlyc3QiLCJ3cmFwSW5uZXIiLCJwcmVwZW5kIiwid3JhcHBlcklkIiwiJG1lbnVNYXJrdXAiLCIkbWVudVdyYXBwZXIiLCJpbnNlcnRBZnRlciIsImZpbGVOYW1lIiwiZmlsZXMiLCJ1bmRlZmluZWQiLCJuYW1lIiwicmVtb3ZlRmlsZSIsIiRsaW5lIiwiaW5zZXJ0QmVmb3JlIiwicHJldiIsIiRpbnB1dCIsIiRob21lTGluayIsIm9mZiIsImJlZm9yZSIsIndyYXAiLCJ0b2dnbGVBY3RpdmVDbGFzc09uSG92ZXJPbkFueU1haW5NZW51SXRlbSIsIm5vdCIsImhvdmVyIiwidXNlRm9udEF3ZXNvbWVBcnJvd3NJblN1Yk1lbnVJdGVtcyIsIiRlbGVtZW50IiwiJGFycm93IiwicmVhZHkiLCJNdXRhdGlvbk9ic2VydmVyIiwiV2ViS2l0TXV0YXRpb25PYnNlcnZlciIsIk1vek11dGF0aW9uT2JzZXJ2ZXIiLCJmbiIsImF0dHJjaGFuZ2UiLCJjYWxsYmFjayIsIm9wdGlvbnMiLCJzdWJ0cmVlIiwiYXR0cmlidXRlcyIsIm9ic2VydmVyIiwibXV0YXRpb25zIiwib2JzZXJ2ZSIsIiRib2R5IiwiY2xvc2VQb3B1cFBhbmVscyIsImNyZWF0ZVBvcHVwQ2xvbmUiLCJidXR0b25PZmZzZXQiLCIkYnV0dG9uIiwib2Zmc2V0IiwiJGNsb25lIiwiJHBvcHVwIiwiY2xvbmUiLCIkY2xvc2VzdEVudGl0eSIsImxlZnQiLCJ3aWR0aCIsIm91dGVyV2lkdGgiLCJ0b3AiLCJvdXRlckhlaWdodCIsInNob3ciLCJtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4iLCJsaXN0ZW5Ub01vdXNlT3V0RXZlbnQiLCJoYXNDbGFzcyIsImFjdGlvbkluZGV4IiwiaW5kZXgiLCJvcGVuUG9wdXBQYW5lbCJdLCJtYXBwaW5ncyI6IkNBQUMsU0FBVUEsRUFBR0MsR0F5Q1osUUFBU0MsR0FBbUNDLEdBQ3RDQSxHQUNGSCxFQUFFLGtDQUFrQ0ksWUFBWSxrREFFNUNELEVBQVNFLFVBQ1hMLEVBQUUsZ0NBQWdDTSxLQUFLLDhCQUErQkgsRUFBU0UsVUFHN0VGLEVBQVNJLFVBQ1hQLEVBQUUsZ0NBQWdDTSxLQUFLLDBDQUEyQ0gsRUFBU0ksWUFHN0ZQLEVBQUUsa0NBQWtDUSxTQUFTLGtEQUM3Q1IsRUFBRSxnQ0FBZ0NNLEtBQUssSUFDdkNOLEVBQUUsZ0NBQWdDTSxLQUFLLElBRXZDRyxFQUFnQyxPQVNwQyxRQUFTQSxHQUFnQ0MsR0FDbkNBLEdBQVNBLEVBQU1DLGFBQWVELEVBQU1DLFlBQVlDLE9BQVMsRUFDM0RaLEVBQUUsbUNBQW1DTSxLQUFLLGdDQUFrQ0ksRUFBTUMsWUFBWUUsS0FBSyxPQUVuR2IsRUFBRSxtQ0FBbUNNLEtBQUssSUFwRTlDTixFQUFFYyxVQUNDQyxHQUFHLFVBQVcsU0FBU0MsR0FDdEJoQixFQUFFLG9CQUFvQmlCLElBQUkscUJBQXNCLFdBQzlDLEdBQUlDLEdBQVFsQixFQUFFbUIsTUFBTUMsS0FBSyxPQUVKLEtBQWpCRixFQUFNTixRQUNSTSxFQUFNRSxLQUFLLFNBQVNDLEtBQUssV0FDdkIsR0FBSUMsR0FBU3RCLEVBQUVtQixNQUNYSSxFQUFLRCxFQUFPRSxLQUFLLE1BQ3JCeEIsR0FBRSxJQUFNdUIsR0FBSUMsS0FBSyxjQUFlRixFQUFPRyxjQUs5Q1YsR0FBRyxzQkFBdUIsU0FBVUMsRUFBR1UsT0FDVCxLQUFsQkEsRUFBS3ZCLFVB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b24gKCQsIF8pIHtcblxuICAkKGRvY3VtZW50KVxuICAgIC5vbignY3JtTG9hZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICQoJy5jcm0taW5saW5lLWVkaXQnKS5vbmUoJ0RPTVN1YnRyZWVNb2RpZmllZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJGZvcm0gPSAkKHRoaXMpLmZpbmQoJ2Zvcm0nKTtcblxuICAgICAgICBpZiAoJGZvcm0ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgJGZvcm0uZmluZCgnbGFiZWwnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyICRsYWJlbCA9ICQodGhpcyk7XG4gICAgICAgICAgICB2YXIgaWQgPSAkbGFiZWwuYXR0cignZm9yJyk7XG4gICAgICAgICAgICAkKCcjJyArIGlkKS5hdHRyKCdwbGFjZWhvbGRlcicsICRsYWJlbC50ZXh0KCkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gICAgLm9uKCd1cGRhdGVDb250YWN0SGVhZGVyJywgZnVuY3Rpb24gKGUsIGRhdGEpIHtcbiAgICAgIGlmICh0eXBlb2YgZGF0YS5jb250cmFjdCAhPT0gJ3VuZGVmaW5lZCcpICB7XG4gICAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMoZGF0YS5jb250cmFjdCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgZGF0YS5yb2xlcyAhPT0gJ3VuZGVmaW5lZCcpICB7XG4gICAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJSb2xlc0RldGFpbHMoZGF0YS5yb2xlcyk7XG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIEFjdGlvbnMgbWVudVxuICAgIC5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoJChlLnRhcmdldCkuaXMoJyNjcm0tY29udGFjdC1hY3Rpb25zLWxpbmssICNjcm0tY29udGFjdC1hY3Rpb25zLWxpbmsgKicpKSB7XG4gICAgICAgICQoJyNjcm0tY29udGFjdC1hY3Rpb25zLWxpbmsnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICAkKCcjY3JtLWNvbnRhY3QtYWN0aW9ucy1saW5rJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250YWN0IGhlYWRlciB3aXRoIHRoZSBnaXZlbiBjb250cmFjdCBkZXRhaWxzXG4gICAqXG4gICAqIEBwYXJhbSAge29iamVjdH0gY29udHJhY3RcbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMoY29udHJhY3QpIHtcbiAgICBpZiAoY29udHJhY3QpICB7XG4gICAgICAkKCcuY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2snKS5yZW1vdmVDbGFzcygnY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2std2l0aG91dC1jb250cmFjdCcpO1xuXG4gICAgICBpZiAoY29udHJhY3QucG9zaXRpb24pIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1wb3NpdGlvbicpLmh0bWwoJzxzdHJvbmc+UG9zaXRpb246PC9zdHJvbmc+ICcrIGNvbnRyYWN0LnBvc2l0aW9uKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbnRyYWN0LmxvY2F0aW9uKSB7XG4gICAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtbG9jYXRpb24nKS5odG1sKCc8c3Ryb25nPk5vcm1hbCBwbGFjZSBvZiB3b3JrOjwvc3Ryb25nPiAnKyBjb250cmFjdC5sb2NhdGlvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jaycpLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jay13aXRob3V0LWNvbnRyYWN0Jyk7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLXBvc2l0aW9uJykuaHRtbCgnJyk7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWxvY2F0aW9uJykuaHRtbCgnJyk7XG5cbiAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJSb2xlc0RldGFpbHMobnVsbCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRhY3QgaGVhZGVyIHdpdGggdGhlIGdpdmVuIHJvbGVzIGRldGFpbHNcbiAgICpcbiAgICogQHBhcmFtICB7b2JqZWN0fSBjb250cmFjdFxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyhyb2xlcykge1xuICAgIGlmIChyb2xlcyAmJiByb2xlcy5kZXBhcnRtZW50cyAmJiByb2xlcy5kZXBhcnRtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWRlcGFydG1lbnRzJykuaHRtbCgnPHN0cm9uZz5EZXBhcnRtZW50Ojwvc3Ryb25nPiAnICsgcm9sZXMuZGVwYXJ0bWVudHMuam9pbignLCAnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtZGVwYXJ0bWVudHMnKS5odG1sKCcnKTtcbiAgICB9XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIvKiBnbG9iYWwgUHMgKi9cblxuLy8gQ29weXJpZ2h0IENpdmlDUk0gTExDIDIwMTMuIFNlZSBodHRwOi8vY2l2aWNybS5vcmcvbGljZW5zaW5nXG4oZnVuY3Rpb24gKCQsIF8pIHtcbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NybUxvYWQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgYWRkVXBsb2FkRmlsZUxpc3RlbmVyKFwiaW5wdXRbdHlwZT0nZmlsZSddXCIpO1xuICAgICAgYW1lbmRWYWNhbmN5Rm9ybSgpO1xuICAgICAgYW1lbmRDb250YWN0UGFnZUFuZEZvcm0oZSk7XG4gICAgICBhcHBseU1pc2NDaGFuZ2VzKCk7XG4gICAgICBjaGFuZ2VDb250YWN0U291cmNlRmllbGRIZWxwVGV4dCgpO1xuICAgIH0pXG4gICAgLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgIGFkZFVzZXJNZW51VG9NYWluTWVudSgpO1xuICAgICAgYW1lbmRBcHBMb2dvTWVudUl0ZW0oKTtcbiAgICAgIGFtZW5kQXBwbGljYXRpb25Gb3JtKCk7XG4gICAgICB1c2VGb250QXdlc29tZUFycm93c0luU3ViTWVudUl0ZW1zKCk7XG4gICAgICB0b2dnbGVBY3RpdmVDbGFzc09uSG92ZXJPbkFueU1haW5NZW51SXRlbSgpO1xuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBDdXN0b21pemVzIHRoZSBhcHAgbG9nbyBtZW51IGl0ZW0sIHN3aXRjaGluZyBmcm9tIHRoZSBDaXZpQ1JNIGxvZ29cbiAgICogdG8gdGhlIENpdmlIUiBsb2dvLCBhbmQgbWFraW5nIHRoZSBpdGVtIGEgZGlyZWN0IGxpbmsgaW5zdGVhZCBvZiBhXG4gICAqIHRvZ2dsZSBmb3IgYSBzdWIgbWVudSBkcm9wZG93blxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRBcHBMb2dvTWVudUl0ZW0gKCkge1xuICAgIHZhciAkbWVudUl0ZW0gPSAkKCcuY3JtLWxpbmstaG9tZScpO1xuICAgIHZhciAkd3JhcHBlZExvZ28gPSBzd2FwQW5kV3JhcEFwcExvZ28oJG1lbnVJdGVtKTtcbiAgICB2YXIgJGN1c3RvbUhvbWVMaW5rID0gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSgkbWVudUl0ZW0sICR3cmFwcGVkTG9nbyk7XG5cbiAgICByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsoJG1lbnVJdGVtLCAkY3VzdG9tSG9tZUxpbmspO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIHVzZXIgbWVudSBieSBmZXRjaGluZyBpdCBmcm9tIHRoZSBocmNvcmUgZXh0ZW5zaW9uXG4gICAqL1xuICBmdW5jdGlvbiBhZGRVc2VyTWVudVRvTWFpbk1lbnUgKCkge1xuICAgICQuYWpheCgnL2Npdmljcm0vaHJjb3JlL3VzZXJtZW51P3NuaXBwZXQ9NCcsIHtcbiAgICAgIGRhdGFUeXBlOiAnaHRtbCcsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAobWVudU1hcmt1cCkge1xuICAgICAgICBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlcihtZW51TWFya3VwLCAnY2l2aWhyLW1lbnUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSBHb3Zlcm5tZW50IElEIGZpZWxkIG9uIHRoZSBQZXJzb25hbCBEZXRhaWxzIHBhZ2UgYW5kIG9uIHRoZSBFZGl0XG4gICAqIENvbnRhY3QgZm9ybS5cbiAgICovXG4gIGZ1bmN0aW9uIGFkZEdvdmVybm1lbnRJZEZpZWxkICgpIHtcbiAgICAvLyBVcGRhdGVzIFBlcnNvbmFsIERldGFpbHMgUGFnZVxuICAgIGlmIChDUk0uY2lkICYmIENSTS5oaWRlR0lkKSB7XG4gICAgICB2YXIgaW5saW5lRGF0YUJsb2NrID0gJCgnLklubGluZV9DdXN0b21fRGF0YScpO1xuXG4gICAgICBpbmxpbmVEYXRhQmxvY2suYXBwZW5kVG8oJCgnI2NvbnRhY3RpbmZvLWJsb2NrJykucGFyZW50KCdkaXYnKS5wYXJlbnQoJ2RpdicpKTtcbiAgICAgIGlubGluZURhdGFCbG9jay5yZW1vdmVDbGFzcygnY3JtLWNvbGxhcHNpYmxlJyk7XG4gICAgICBpbmxpbmVEYXRhQmxvY2sucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuICAgICAgaW5saW5lRGF0YUJsb2NrLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1ibG9jaycpO1xuXG4gICAgICAkKCcuSW5saW5lX0N1c3RvbV9EYXRhIGRpdi5jb2xsYXBzaWJsZS10aXRsZScpLmNzcyh7ZGlzcGxheTogJ25vbmUnfSk7XG4gICAgICAkKCcuSW5saW5lX0N1c3RvbV9EYXRhIGRpdi5jcm0tc3VtbWFyeS1ibG9jaycpLmNzcyh7ZGlzcGxheTogJ2Jsb2NrJ30pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZXMgRWRpdCBDb250YWN0IEZvcm1cbiAgICBpZiAoJCgnI2N1c3RvbUZpZWxkcycpLmxlbmd0aCA8IDEpIHtcbiAgICAgICQoJyNJbmxpbmVfQ3VzdG9tX0RhdGEgbGFiZWwnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnI25pY2tfbmFtZScpLnBhcmVudCgpLmFmdGVyKCc8dGQgaWQ9XCJjdXN0b21GaWVsZHNcIj48L3RkPicpO1xuICAgICAgICB2YXIgbm9kZUlEID0gJCh0aGlzKS5hdHRyKCdmb3InKTtcbiAgICAgICAgdmFyIGN1c3RvbUZpZWxkID0gJCgnIycgKyBub2RlSUQpLmRldGFjaCgpO1xuICAgICAgICAkKCcjY3VzdG9tRmllbGRzJykuYXBwZW5kKCQodGhpcykpO1xuICAgICAgICAkKCcjY3VzdG9tRmllbGRzJykuYXBwZW5kKGN1c3RvbUZpZWxkKTtcbiAgICAgIH0pO1xuXG4gICAgICAkKCcjSW5saW5lX0N1c3RvbV9EYXRhJykucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhbiBldmVudCBsaXN0ZW5lciBvbiBpbnB1dFt0eXBlPVwiZmlsZVwiXVxuICAgKiBAcGFyYW0ge2pRdWVyeSBPYmplY3R9IHNlbGVjdG9yIFtzZWxlY3RvciBmcm9tIGlucHV0IGZpbGVdXG4gICAqL1xuICBmdW5jdGlvbiBhZGRVcGxvYWRGaWxlTGlzdGVuZXIgKHNlbGVjdG9yKSB7XG4gICAgaWYgKCQoc2VsZWN0b3IpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgJChzZWxlY3Rvcikub24oJ2NoYW5nZScsIGluc2VydEZpbGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIGFwcGxpY2F0aW9uIGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIGFtZW5kQXBwbGljYXRpb25Gb3JtICgpIHtcbiAgICAkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9BcHBsaWNhdGlvbicpLmFkZENsYXNzKCdjcm0tZm9ybS1ibG9jaycpO1xuICAgICQoJy5DUk1fSFJSZWNydWl0bWVudF9Gb3JtX0FwcGxpY2F0aW9uIC5jcm0tcHJvZmlsZS1uYW1lLWFwcGxpY2F0aW9uX3Byb2ZpbGUnKS5hZGRDbGFzcygnZm9ybS1sYXlvdXQtY29tcHJlc3NlZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFtZW5kcyB0aGUgY29udGFjdCBwYWdlIGFuZCB0aGUgY29udGFjdCBmb3JtXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZENvbnRhY3RQYWdlQW5kRm9ybSAoZSkge1xuICAgIGlmIChDUk0uZm9ybU5hbWUgPT09ICdjb250YWN0Rm9ybScgfHwgQ1JNLnBhZ2VOYW1lID09PSAndmlld1N1bW1hcnknKSB7XG4gICAgICAvLyBSZW5hbWUgXCJTdW1tYXJ5XCIgdGFiIHRvIFwiUGVyc29uYWwgRGV0YWlsc1wiXG4gICAgICAvLyBIYWNrIHRvIGNoZWNrIGNvbnRhY3QgdHlwZSAtIFRoaXMgZmllbGQgb25seSBhcHBlYXJzIGZvciBpbmRpdmlkdWFsc1xuICAgICAgaWYgKCQoJy5jcm0tY29udGFjdC1qb2JfdGl0bGUnLCAnLmNybS1zdW1tYXJ5LWNvbnRhY3RpbmZvLWJsb2NrJykubGVuZ3RoKSB7XG4gICAgICAgICQoJy5jcm0tY29udGFjdC10YWJzLWxpc3QgI3RhYl9zdW1tYXJ5IGEnLCBlLnRhcmdldCkudGV4dCgnUGVyc29uYWwgRGV0YWlscycpO1xuICAgICAgfVxuXG4gICAgICBhZGRHb3Zlcm5tZW50SWRGaWVsZChlLnRhcmdldCk7XG4gICAgICBtaXNjQ29udGFjdFBhZ2VDaGFuZ2VzKGUudGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSB2YWNhbmN5IGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIGFtZW5kVmFjYW5jeUZvcm0gKCkge1xuICAgIGlmICgkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3knKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0KCQoJ2xhYmVsW2Zvcj1cInN0YXJ0X2RhdGVcIl0nKS5wYXJlbnRzKCd0cicpKTtcbiAgICAgIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0KCQoJ2xhYmVsW2Zvcj1cImVuZF9kYXRlXCJdJykucGFyZW50cygndHInKSk7XG5cbiAgICAgIC8vIEFkZCBhIGNsYXNzIHRvIGlkZW50aWZ5IHRoZSBmb3JtICdOZXcgVmFjYW5jeSBUZW1wbGF0ZSdcbiAgICAgIGlmICgkKCdbbmFtZT1cImVudHJ5VVJMXCJdJykudmFsKCkuaW5kZXhPZignO3RlbXBsYXRlPTEnKSA+IC0xKSB7XG4gICAgICAgICQoJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fSFJWYWNhbmN5IHRib2R5JykuZ2V0KDApKS5hZGRDbGFzcygnQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3lfVGVtcGxhdGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXBwbGllcyBtaXNjZWxsYW5lb3VzIFVJIGNoYW5nZXNcbiAgICovXG4gIGZ1bmN0aW9uIGFwcGx5TWlzY0NoYW5nZXMgKCkge1xuICAgICQoJyNhY3Rpdml0eUN1c3RvbURhdGEnKS5hdHRyKCdjb2xzcGFuJywgMyk7XG4gICAgJCgnI2NybS1hY3Rpdml0eS12aWV3LXRhYmxlIC5jcm0tY2FzZS1hY3Rpdml0eS12aWV3LUNsaWVudCAubGFiZWwnKS5odG1sKCdDb250YWN0Jyk7XG4gICAgJCgnc3Bhbi5jcm0tZnJvemVuLWZpZWxkJywgJy5jcm0tcHJvZmlsZS1uYW1lLWhyaWRlbnRfdGFiJykuY2xvc2VzdCgnZGl2JykucGFyZW50KCdkaXYnKS5oaWRlKCk7XG5cbiAgICAkKCcuY3JtLWFjY29yZGlvbi1oZWFkZXIuY3JtLW1hc3Rlci1hY2NvcmRpb24taGVhZGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saXN0aW5nLWJveCcpLCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgIFBzLmluaXRpYWxpemUoZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgMCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hhbmdlcyBvZiBzb3JjZSBoZWxwIHRleHRcbiAgICovXG4gIGZ1bmN0aW9uIGNoYW5nZUNvbnRhY3RTb3VyY2VGaWVsZEhlbHBUZXh0ICgpIHtcbiAgICAkKCdJTlBVVCNjb250YWN0X3NvdXJjZScpLnBhcmVudCgndGQnKS5jaGlsZHJlbignYScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAgLm5vdGlmeS1jb250ZW50JykucmVtb3ZlKCk7XG5cbiAgICAgIGlmICgkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwIHAnKS5sZW5ndGgpIHtcbiAgICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCBwJykucmVtb3ZlKCk7XG4gICAgICB9XG5cbiAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAnKS5hcHBlbmQoJzxwPlNvdXJjZSBpcyBhIHVzZWZ1bCBmaWVsZCB3aGVyZSBkYXRhIGhhcyBiZWVuIG1pZ3JhdGVkIHRvIENpdmlIUiBmcm9tIG9uZSBvciBhIG51bWJlciBvZiBvdGhlciBsZWdhY3kgc3lzdGVtcy4gVGhlIFNvdXJjZSBmaWVsZCB3aWxsIGluZGljYXRlIHdoaWNoIGxlZ2FjeSBzeXN0ZW0gdGhlIGNvbnRhY3QgaGFzIGNvbWUgZnJvbS48L3A+Jyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIG9yaWdpbmFsIGxpbmsgdG8gdGhlIGhvbWVwYWdlLCBjaGFuZ2VzIHRoZSB0ZXh0LCB3cmFwcyBpdCBpbiBhXG4gICAqIGBtZW51bWFpbi1sYWJlbGAgZWxlbWVudCBhbmQgcHJlcGVuZHMgaW50ZXJuYWxseSB0aGUgZ2l2ZW4gYXBwIGxvZ29cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICRtZW51SXRlbSBUaGUgY29udGV4dCB3aGVyZSB0byBmaW5kIHRoZSBsaW5rXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkYXBwTG9nb1xuICAgKiBAcmV0dXJuIHRoZSBjdXN0b21pemVkIGhvbWUgbGlua1xuICAgKi9cbiAgZnVuY3Rpb24gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSAoJG1lbnVJdGVtLCAkYXBwTG9nbykge1xuICAgIHZhciAkaG9tZUxpbmsgPSAkKCdsaSA+IGEnLCAkbWVudUl0ZW0pLmZpcnN0KCk7XG5cbiAgICByZXR1cm4gJGhvbWVMaW5rXG4gICAgICAudGV4dCgnSG9tZScpXG4gICAgICAud3JhcElubmVyKCc8c3BhbiBjbGFzcz1cIm1lbnVtYWluLWxhYmVsXCI+JylcbiAgICAgIC5wcmVwZW5kKCRhcHBMb2dvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmplY3RzIHRoZSBnaXZlbiBtYXJrdXAgaW4gYSBtZW51IHdyYXBwZXIgd2l0aCB0aGUgZ2l2ZW4gaWRcbiAgICogY3JlYXRlZCB0byBjb250YWluIGJvdGggdGhlIG9yaWdpbmFsIG1lbnUgYW5kIHRoZSB1c2VyIG9uZVxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVudU1hcmt1cFxuICAgKiBAcGFyYW0ge3N0cmluZ30gd3JhcHBlcklkXG4gICAqL1xuICBmdW5jdGlvbiBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlciAobWVudU1hcmt1cCwgd3JhcHBlcklkKSB7XG4gICAgdmFyICRtZW51TWFya3VwID0gJChtZW51TWFya3VwKTtcbiAgICB2YXIgJG1lbnVXcmFwcGVyID0gJCgnPGRpdj4nKTtcblxuICAgICRtZW51V3JhcHBlci5hdHRyKCdpZCcsIHdyYXBwZXJJZCk7XG4gICAgJG1lbnVXcmFwcGVyLmFwcGVuZCgkKCcjY2l2aWNybS1tZW51JykpO1xuICAgICRtZW51V3JhcHBlci5hcHBlbmQoJG1lbnVNYXJrdXApO1xuICAgICRtZW51V3JhcHBlci5pbnNlcnRBZnRlcignI3BhZ2UnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnNlcnQgYSBET00gbm9kZSBhZnRlciBpbnB1dFt0eXBlPVwiZmlsZVwiXVxuICAgKiB3aXRoIHRoZSBmaWxlbmFtZVxuICAgKi9cbiAgZnVuY3Rpb24gaW5zZXJ0RmlsZSAoKSB7XG4gICAgdmFyIGZpbGVOYW1lID0gJCh0aGlzKVswXS5maWxlc1swXTtcblxuICAgICQoJyNqcy11cGxvYWRlZC1maWxlJykucmVtb3ZlKCk7XG4gICAgaWYgKGZpbGVOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICQodGhpcykuYWZ0ZXIoJzxzcGFuIGlkPVwianMtdXBsb2FkZWQtZmlsZVwiIGNsYXNzPVwidXBsb2FkZWQtZmlsZVwiPicgKyBmaWxlTmFtZS5uYW1lICsgJyA8c3BhbiBjbGFzcz1cInVwbG9hZGVkLWZpbGUtaWNvbi10cmFzaFwiPjxpIGNsYXNzPVwiZmEgZmEtdHJhc2gtb1wiPjwvaT4gUmVtb3ZlPC9zcGFuPicpO1xuXG4gICAgICAkKCcudXBsb2FkZWQtZmlsZS1pY29uLXRyYXNoJykub24oJ2NsaWNrJywgcmVtb3ZlRmlsZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBsYWJlbCAnZm9yJyBhdHRyIHRvIHdvcmtzIHdpdGggdGhlIGRhdGVwaWNrZXJcbiAgICpcbiAgICogQHBhcmFtICB7alF1ZXJ5IG9iamVjdH0gJGxpbmUgW2RhdGVwaWNrZXIncyBsaW5lIHBhcmVudF1cbiAgICovXG4gIGZ1bmN0aW9uIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0ICgkbGluZSkge1xuICAgICRsaW5lLmZpbmQoJ2xhYmVsJykuYXR0cignZm9yJywgJGxpbmUuZmluZCgnLmNybS1mb3JtLWRhdGUnKS5hdHRyKCdpZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNaXNjIGNoYW5nZXMgdG8gdGhlIHBhZ2UgKGhpZGluZyBlbGVtZW50cywgaW5zZXJ0aW5nIG5ldyBvbmVzLCBldGMpXG4gICAqL1xuICBmdW5jdGlvbiBtaXNjQ29udGFjdFBhZ2VDaGFuZ2VzICh0YXJnZXQpIHtcbiAgICAvLyBIaWRlIGN1cnJlbnQgZW1wbG95ZXIgYW5kIGpvYiB0aXRsZVxuICAgIC8vIENvbnRhY3Qgc3VtbWFyeSBzY3JlZW46XG4gICAgJCgnZGl2LmNybS1jb250YWN0LWN1cnJlbnRfZW1wbG95ZXIsIGRpdi5jcm0tY29udGFjdC1qb2JfdGl0bGUnLCAnLmNybS1zdW1tYXJ5LWNvbnRhY3RpbmZvLWJsb2NrJykucGFyZW50KCdkaXYuY3JtLXN1bW1hcnktcm93JykuaGlkZSgpO1xuICAgIC8vIElubGluZSBlZGl0IGZvcm1cbiAgICAkKCdmb3JtI0NvbnRhY3RJbmZvIGlucHV0I2VtcGxveWVyX2lkLCBmb3JtI0NvbnRhY3RJbmZvIGlucHV0I2pvYl90aXRsZScsIHRhcmdldCkuY2xvc2VzdCgnZGl2LmNybS1zdW1tYXJ5LXJvdycpLmhpZGUoKTtcbiAgICAvLyBDb250YWN0IGVkaXQgc2NyZWVuXG4gICAgJCgnaW5wdXQjZW1wbG95ZXJfaWQsIGlucHV0I2pvYl90aXRsZScsICdmb3JtI0NvbnRhY3QnKS5wYXJlbnQoJ3RkJykuaGlkZSgpO1xuXG4gICAgLyogQ2hhbmdlcyBvbiBBZGQgSW5kaXZpZHVhbCBwYWdlcyBhbmQgUGVyc29uYWwgZGV0YWlscyB0YWIgZm9yIEhSLTM1OCAqL1xuICAgIC8vIE1vdmUgSm9iIHN1bW1hcnkgdG8gdG9wXG4gICAgJCgnLkhSSm9iQ29udHJhY3RfU3VtbWFyeScsIHRhcmdldCkuaW5zZXJ0QmVmb3JlKCQoJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpKTtcbiAgICAvLyBjaGFuZ2VzIG9mIGVtYWlsIGJsb2NrLCByZW1vdmUgYnVsa21haWwgYW5kIG9uaG9sZFxuICAgICQoJ2Rpdi5lbWFpbC1zaWduYXR1cmUsIHRkI0VtYWlsLUJ1bGttYWlsLWh0bWwnLCAnZm9ybSNDb250YWN0JykuaGlkZSgpO1xuICAgICQoJyNFbWFpbC1QcmltYXJ5JywgJ2Zvcm0jQ29udGFjdCcpLnByZXYoJ3RkJykucHJldigndGQnKS5oaWRlKCk7XG4gICAgJCgndGQjRW1haWwtQnVsa21haWwtaHRtbCwgI0VtYWlsLVByaW1hcnknLCAnZm9ybSNDb250YWN0JykucHJldigndGQnKS5oaWRlKCk7XG5cbiAgICAvLyBzaGlmdCBkZW1vZ3JhcGhpYyBhYm92ZSBleHRlbmRlZCBkZW1vZ3JhcGhpY1xuICAgICQoJy5jcm0tZGVtb2dyYXBoaWNzLWFjY29yZGlvbicsICdmb3JtI0NvbnRhY3QnKS5pbnNlcnRBZnRlcigkKCcuY3JtLWNvbnRhY3REZXRhaWxzLWFjY29yZGlvbicpKTtcblxuICAgIGlmICgkKCd0ciNQaG9uZV9CbG9ja18yJywgJ2Zvcm0jQ29udGFjdCcpLmxlbmd0aCA8IDEpIHtcbiAgICAgICQoJyNhZGRQaG9uZScpLmNsaWNrKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgI2pzLXVwbG9hZGVkLWZpbGUgRElWIGFuZFxuICAgKiBjbGVhbiBpbnB1dFt0eXBlPVwiZmlsZVwiXSB2YWx1ZVxuICAgKi9cbiAgZnVuY3Rpb24gcmVtb3ZlRmlsZSAoKSB7XG4gICAgdmFyICRpbnB1dCA9ICQoJyNqcy11cGxvYWRlZC1maWxlJykucGFyZW50KCkuZmluZCgnaW5wdXRbdHlwZT1cImZpbGVcIl0nKTtcblxuICAgICQoJyNqcy11cGxvYWRlZC1maWxlJykucmVtb3ZlKCk7XG4gICAgJGlucHV0LnZhbCgnJyk7XG4gIH1cblxuICAvKipcbiAgICogTW92ZXMgdGhlIGdpdmVuIGhvbWUgbGluayByaWdodCB1bmRlciB0aGUgbWVudSBpdGVtIGFuZCBnZXRzIHJpZFxuICAgKiBvZiB0aGUgb3JpZ2luYWwgc3ViIG1lbnVcbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICRtZW51SXRlbSBUaGUgY29udGV4dCB3aGVyZSB0byBmaW5kIHRoZSBsaW5rXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkaG9tZUxpbmtcbiAgICovXG4gIGZ1bmN0aW9uIHJlbW92ZUxvZ29TdWJNZW51QW5kS2VlcE9ubHlIb21lTGluayAoJG1lbnVJdGVtLCAkaG9tZUxpbmspIHtcbiAgICAkbWVudUl0ZW1cbiAgICAgIC5vZmYoKSAvLyByZW1vdmVzIGFueSBoYW5kbGVyIHRoYXQgdGhlIG9yaWdpbmFsIGl0ZW0gaGFkXG4gICAgICAuZmluZCgnI2Npdmljcm0taG9tZScpXG4gICAgICAuYmVmb3JlKCRob21lTGluaylcbiAgICAgIC5yZW1vdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTd2FwcyB0aGUgQ2l2aUNSTSBsb2dvIHdpdGggdGhlIENpdmlIUiBsb2dvXG4gICAqIGFuZCB3cmFwcyBpdCBpbiBhIGBtZW51bWFpbi1pY29uYCBlbGVtZW50XG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbG9nb1xuICAgKiBAcmV0dXJuIHRoZSB3cmFwcGVyIG9mIHRoZSBsb2dvXG4gICAqL1xuICBmdW5jdGlvbiBzd2FwQW5kV3JhcEFwcExvZ28gKCRtZW51SXRlbSkge1xuICAgIHZhciAkYXBwTG9nbyA9ICQoJy5jcm0tbG9nby1zbScsICRtZW51SXRlbSk7XG5cbiAgICByZXR1cm4gJGFwcExvZ29cbiAgICAgIC5hZGRDbGFzcygnY2hyX2xvZ28gY2hyX2xvZ28tLWRlZmF1bHQtY29sb3InKVxuICAgICAgLnJlbW92ZUNsYXNzKCdjcm0tbG9nby1zbScpXG4gICAgICAud3JhcCgnPHNwYW4gY2xhc3M9XCJtZW51bWFpbi1pY29uXCI+JylcbiAgICAgIC5wYXJlbnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaXZpQ1JNIGJ5IGRlZmF1bHQgYXBwbGllcyBvbiBob3ZlciB0aGUgLmFjdGl2ZXRhcmdldCBjbGFzc1xuICAgKiBvbmx5IHRvIG1haW4gbWVudSBpdGVtcyB3aXRoIGEgc3VibWVudVxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBtYWtlcyBzdXJlIHRoYXQgYW55IGl0ZW0gZ2V0cyB0aGUgY2xhc3MgYXBwbGllZCxcbiAgICogZXZlbiB0aG9zZSB3aXRoIGp1c3QgYSBkaXJlY3QgbGlua1xuICAgKi9cbiAgZnVuY3Rpb24gdG9nZ2xlQWN0aXZlQ2xhc3NPbkhvdmVyT25BbnlNYWluTWVudUl0ZW0gKCkge1xuICAgIHZhciBjbGFzc05hbWUgPSAnYWN0aXZldGFyZ2V0JztcblxuICAgICQoJy5tZW51bWFpbicpLm5vdCgnLmNybS1TZWxmX1NlcnZpY2VfUG9ydGFsJykuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGFycm93IGZvciBtZW51IGl0ZW1zIHdpdGggc3ViLWl0ZW1zLCBhbmQgcmVwbGFjZXMgaXRcbiAgICogd2l0aCBhIGZvbnQgYXdlc29tZSBjYXJldFxuICAgKi9cbiAgZnVuY3Rpb24gdXNlRm9udEF3ZXNvbWVBcnJvd3NJblN1Yk1lbnVJdGVtcyAoKSB7XG4gICAgJCgnI3Jvb3QtbWVudS1kaXYgLm1lbnUtaXRlbS1hcnJvdycpLmVhY2goZnVuY3Rpb24gKCRlbGVtZW50KSB7XG4gICAgICB2YXIgJGFycm93ID0gJCh0aGlzKTtcblxuICAgICAgJGFycm93LmJlZm9yZSgnPGkgY2xhc3M9XCJmYSBmYS1jYXJldC1yaWdodCBtZW51LWl0ZW0tYXJyb3dcIj48L2k+Jyk7XG4gICAgICAkYXJyb3cucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIoZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgTXV0YXRpb25PYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5Nb3pNdXRhdGlvbk9ic2VydmVyO1xuXG4gIC8qXG4gIFRoaXMgcGx1Z2luIGNyZWF0ZXMgTXV0YXRpb25PYnNlcnZlciB3aGljaCBsaXN0ZW5zIHRvIGFsbCBjaGFuZ2VzIHRvIERPTSBOb2RlLlxuICBJZiBjaGFuZ2UgaGFzIGJlZW4gZG9uZSB0byBpdCdzIGF0dHJpYnV0ZXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQuXG5cbiAgQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB0byBiZSBjYWxsZWQgd2hlbiBhdHRyaWJ1dGVzIGNoYW5nZVxuICBAcmV0dXJucyB7QXJyYXl9IC0gbGlzdCBvZiBhbGwgb2JzZXJ2ZWQgZWxlbWVudHNcbiAgKi9cbiAgJC5mbi5hdHRyY2hhbmdlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBzdWJ0cmVlOiBmYWxzZSxcbiAgICAgICAgYXR0cmlidXRlczogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwoZS50YXJnZXQsIGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLCBvcHRpb25zKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoQ1JNLiQpO1xuIiwiLyogZ2xvYmFscyBDUk0gKi9cblxuLypcblByZXZlbnQgUG9wdXBzIHRvIG92ZXJmbG93IHRhYmxlcy5cbiovXG4oZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7XG5cbiAgJGJvZHkub24oJ2NsaWNrJywgJy5idG4tc2xpZGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRidXR0b24gPSAkKHRoaXMpO1xuICAgIHZhciAkY2xvc2VzdEVudGl0eSA9ICRidXR0b24uY2xvc2VzdCgnLmNybS1lbnRpdHknKVswXTtcbiAgICB2YXIgJHBvcHVwID0gJGJ1dHRvbi5jaGlsZHJlbigndWwucGFuZWwnKTtcblxuICAgIChmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgIG9wZW5Qb3B1cFBhbmVsKCk7XG4gICAgICBsaXN0ZW5Ub01vdXNlT3V0RXZlbnQoKTtcbiAgICB9KSgpO1xuXG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBhbnkgcG9wdXAgcGFuZWwgdGhhdCBpcyBjdXJyZW50bHkgb3BlbiBhbmQgcmVtb3ZlcyB0aGVcbiAgICAgKiBgLmNpdmloci1wb3B1cC1vcGVuYCBjbGFzcyBmcm9tIHRoZSBib2R5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsb3NlUG9wdXBQYW5lbHMgKCkge1xuICAgICAgJCgnLmNpdmloci1wb3B1cCcpLnJlbW92ZSgpO1xuICAgICAgJGJvZHkucmVtb3ZlQ2xhc3MoJ2Npdmloci1wb3B1cC1vcGVuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoZSBwb3B1cCBlbGVtZW50IGFuZCBhcHBlbmRzIGl0IHRvIHRoZSBkb2N1bWVudCBib2R5LlxuICAgICAqIFRoaXMgcHJldmVudHMgdGhlIHBvcHVwIHRvIGJlIGhpZGRlbiBieSBhbnkgYG92ZXJmbG93OiBoaWRkZW47YCBydWxlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVBvcHVwQ2xvbmUgKCkge1xuICAgICAgdmFyIGJ1dHRvbk9mZnNldCA9ICRidXR0b24ub2Zmc2V0KCk7XG4gICAgICB2YXIgJGNsb25lID0gJHBvcHVwLmNsb25lKHRydWUpXG4gICAgICAgIC5hcHBlbmRUbygkYm9keSlcbiAgICAgICAgLmFkZENsYXNzKCdjaXZpaHItcG9wdXAnKVxuICAgICAgICAuYXR0cignaWQnLCAkY2xvc2VzdEVudGl0eS5pZClcbiAgICAgICAgLmFkZENsYXNzKCQoJGNsb3Nlc3RFbnRpdHkpLmF0dHIoJ2NsYXNzJykpO1xuXG4gICAgICAkY2xvbmUuY3NzKHtcbiAgICAgICAgbGVmdDogK2J1dHRvbk9mZnNldC5sZWZ0IC0gKCRjbG9uZS53aWR0aCgpIC0gJGJ1dHRvbi5vdXRlcldpZHRoKCkpLFxuICAgICAgICB0b3A6ICtidXR0b25PZmZzZXQudG9wICsgJGJ1dHRvbi5vdXRlckhlaWdodCgpXG4gICAgICB9KTtcbiAgICAgICRjbG9uZS5zaG93KCk7XG4gICAgICBtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4oJGNsb25lKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMaXN0ZW5zIHRvIG1vdXNlIGV2ZW50cyBoYXBwZW5pbmcgb3V0c2lkZSB0aGUgb2YgdGhlIHBhbmVsIGluIG9yZGVyIHRvXG4gICAgICogY2xvc2UgaXQuIFRoZSB3YXkgdG8gZGV0ZWN0ZWQgbW91c2Ugb3V0IGlzIGJ5IGxpc3RlbmluZyB0byB0aGVcbiAgICAgKiAuYnRuLXNsaWRlLWFjdGl2ZSBjbGFzcyBjaGFuZ2UsIHdoaWNoIGlzIGFkZGVkIGFuZCByZW1vdmVkIGJ5IENpdmlDUk0uXG4gICAgICogdGhlIGRhdGEgKmF0dHJjaGFuZ2UtaXMtb24qIGlzIHNldCB0byB0cnVlIGluIG9yZGVyIHRvIGF2b2lkIGFkZGluZ1xuICAgICAqIG11bHRpcGxlIGxpc3RlbmVycyB0byB0aGUgc2FtZSBlbGVtZW50LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpc3RlblRvTW91c2VPdXRFdmVudCAoKSB7XG4gICAgICAvLyBJZiBBdHRyQ2hhbmdlIGV2ZW50IGlzIGFscmVhZHkgbGlzdGVuZWQsIHRoZW4gc2tpcDpcbiAgICAgIGlmICgkYnV0dG9uLmRhdGEoJ2F0dHJjaGFuZ2UtaXMtb24nKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgICRidXR0b24uZGF0YSgnYXR0cmNoYW5nZS1pcy1vbicsIHRydWUpO1xuICAgICAgJGJ1dHRvbi5hdHRyY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSWYgYnV0dG9uIGlzIGFscmVhZHkgb3BlbiwgdGhlbiBza2lwOlxuICAgICAgICBpZiAoJGJ1dHRvbi5oYXNDbGFzcygnYnRuLXNsaWRlLWFjdGl2ZScpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xvc2VQb3B1cFBhbmVscygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFwcyBjbGljayBldmVudHMgb24gdGhlIHBvcHVwIG9wdGlvbnMgYmFjayB0byB0aGVpciBvcmlnaW5hbCBzb3VyY2UuXG4gICAgICogVGhpcyBpcyBkb25lIGJlY2F1c2UgcG9wdXAgYWN0aW9ucyBhcmUgZXhlY3V0ZWQgYXMgZGVsZWdhdGVkIGV2ZW50cyBhbmRcbiAgICAgKiB0aGUgbGlzdGVuZXIgaXMgbm90IHRoZSAqYm9keSogZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSAkY2xvbmUgLSBUaGUgalF1ZXJ5IGNsb25lIGVsZW1lbnQgdG8gbWFwXG4gICAgICogY2xpY2sgZXZlbnRzIGZyb20uXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwQ2xvbmVDbGlja0V2ZW50c1RvT3JpZ2luICgkY2xvbmUpIHtcbiAgICAgICRjbG9uZS5maW5kKCdhJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYWN0aW9uSW5kZXggPSAkKHRoaXMpLnBhcmVudCgpLmluZGV4KCk7XG5cbiAgICAgICAgJHBvcHVwLmZpbmQoJ2xpOm50aCgnICsgYWN0aW9uSW5kZXggKyAnKSBhJykuY2xpY2soKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSBwb3B1cCBwYW5lbFxuICAgICAqIGFuZCBhZGRzIHRoZSAuY2l2aWhyLXBvcHVwLW9wZW4gY2xhc3MgdG8gdGhlIGJvZHlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvcGVuUG9wdXBQYW5lbCAoKSB7XG4gICAgICBjbG9zZVBvcHVwUGFuZWxzKCk7XG4gICAgICBjcmVhdGVQb3B1cENsb25lKCk7XG4gICAgICAkYm9keS5hZGRDbGFzcygnY2l2aWhyLXBvcHVwLW9wZW4nKTtcbiAgICB9XG4gIH0pO1xufSkoQ1JNLiQpO1xuIl19
