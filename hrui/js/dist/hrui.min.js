!function(t,o){function n(o){o&&o.departments&&o.departments.length>0?t(".crm-contact-detail-departments").html("<strong>Department:</strong> "+o.departments.join(", ")):t(".crm-contact-detail-departments").html("")}t(document).on("crmLoad",function(o){t(".crm-inline-edit").one("DOMSubtreeModified",function(){var o=t(this).find("form");1===o.length&&o.find("label").each(function(){var o=t(this),n=o.attr("for");t("#"+n).attr("placeholder",o.text())})})}).on("updateContactHeader",function(o,c){var a;void 0!==c.contract&&((a=c.contract)?(t(".crm-summary-contactname-block").removeClass("crm-summary-contactname-block-without-contract"),a.position&&t(".crm-contact-detail-position").html("<strong>Position:</strong> "+a.position),a.location&&t(".crm-contact-detail-location").html("<strong>Normal place of work:</strong> "+a.location)):(t(".crm-summary-contactname-block").addClass("crm-summary-contactname-block-without-contract"),t(".crm-contact-detail-position").html(""),t(".crm-contact-detail-location").html(""),n(null))),void 0!==c.roles&&n(c.roles)})}(CRM.$,CRM._);
!function(e,t){function a(){var t=e(this)[0].files[0];e("#js-uploaded-file").remove(),void 0!==t&&(e(this).after('<span id="js-uploaded-file" class="uploaded-file">'+t.name+' <span class="uploaded-file-icon-trash"><i class="fa fa-trash-o"></i> Remove</span>'),e(".uploaded-file-icon-trash").on("click",o))}function r(e){e.find("label").attr("for",e.find(".crm-form-date").attr("id"))}function o(){var t=e("#js-uploaded-file").parent().find('input[type="file"]');e("#js-uploaded-file").remove(),t.val("")}e(document).on("crmLoad",function(t){var o,i,n,c;1===e(o="input[type='file']").length&&e(o).on("change",a),1===e(".CRM_HRRecruitment_Form_HRVacancy").length&&(r(e('label[for="start_date"]').parents("tr")),r(e('label[for="end_date"]').parents("tr")),e('[name="entryURL"]').val().indexOf(";template=1")>-1&&e(e(".CRM_HRRecruitment_Form_HRVacancy tbody").get(0)).addClass("CRM_HRRecruitment_Form_HRVacancy_Template")),n=t,"contactForm"!==CRM.formName&&"viewSummary"!==CRM.pageName||(e(".crm-contact-job_title",".crm-summary-contactinfo-block").length&&e(".crm-contact-tabs-list #tab_summary a",n.target).text("Personal Details"),n.target,(i=e(".Inline_Custom_Data")).length&&i.removeClass("crm-collapsible collapsed").addClass("crm-summary-block").insertAfter(".crm-summary-contactinfo-block").find(".collapsible-title").hide().end().find(".crm-summary-block").show(),e("#customFields").length<1&&(e("#Inline_Custom_Data .label").each(function(){var t=e(this),a=t.next(),r=e("<td/>");r.append(t.find("label")),r.append(e("<br/>")),r.append(a.html()),e("#nick_name").parent().after(r)}),e("#Inline_Custom_Data").remove()),c=n.target,e("div.crm-contact-current_employer, div.crm-contact-job_title",".crm-summary-contactinfo-block").parent("div.crm-summary-row").hide(),e("form#ContactInfo input#employer_id, form#ContactInfo input#job_title",c).closest("div.crm-summary-row").hide(),e("input#employer_id, input#job_title","form#Contact").parent("td").hide(),e(".HRJobContract_Summary",c).insertBefore(e(".crm-summary-contactinfo-block")),e("div.email-signature, td#Email-Bulkmail-html","form#Contact").hide(),e("#Email-Primary","form#Contact").prev("td").prev("td").hide(),e("td#Email-Bulkmail-html, #Email-Primary","form#Contact").prev("td").hide(),e(".crm-demographics-accordion","form#Contact").insertAfter(e(".crm-contactDetails-accordion")),e("tr#Phone_Block_2","form#Contact").length<1&&e("#addPhone").click()),e("#activityCustomData").attr("colspan",3),e("#crm-activity-view-table .crm-case-activity-view-Client .label").html("Contact"),e("span.crm-frozen-field",".crm-profile-name-hrident_tab").closest("div").parent("div").hide(),e(".crm-accordion-header.crm-master-accordion-header").on("click",function(){window.setTimeout(function(){Array.prototype.forEach.call(document.querySelectorAll(".listing-box"),function(e){Ps.initialize(e)})},0)}),e("INPUT#contact_source").parent("td").children("a").click(function(){e("#crm-notification-container .crm-help .notify-content").remove(),e("#crm-notification-container .crm-help p").length&&e("#crm-notification-container .crm-help p").remove(),e("#crm-notification-container .crm-help").append("<p>Source is a useful field where data has been migrated to CiviHR from one or a number of other legacy systems. The Source field will indicate which legacy system the contact has come from.</p>")})}).ready(function(){var t,a,r,o,i,n;e.ajax("/civicrm/hrcore/usermenu?snippet=4",{dataType:"html",success:function(t){var a,r,o;a="civihr-menu",r=e(t),(o=e("<div>")).attr("id",a),o.append(e("#civicrm-menu")),o.append(r),o.insertAfter("#page")}}),t=e(".crm-link-home"),a=e(".crm-logo-sm",t).addClass("chr_logo chr_logo--default-color").removeClass("crm-logo-sm").wrap('<span class="menumain-icon">').parent(),o=a,r=e("li > a",t).first().text("Home").wrapInner('<span class="menumain-label">').prepend(o),i=r,t.off().find("#civicrm-home").before(i).remove(),e(".CRM_HRRecruitment_Form_Application").addClass("crm-form-block"),e(".CRM_HRRecruitment_Form_Application .crm-profile-name-application_profile").addClass("form-layout-compressed"),e("#root-menu-div .menu-item-arrow").each(function(t){var a=e(this);a.before('<i class="fa fa-caret-right menu-item-arrow"></i>'),a.remove()}),n="activetarget",e(".menumain").not(".crm-Self_Service_Portal").hover(function(){e(this).addClass(n)},function(){e(this).removeClass(n)})})}(CRM.$,CRM._);
!function(t){"use strict";var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t.fn.attrchange=function(t){if(n){var e={subtree:!1,attributes:!0},i=new n(function(n){n.forEach(function(n){t.call(n.target,n)})});return this.each(function(){i.observe(this,e)})}}}(CRM.$);
!function(t){"use strict";var i=t("body");i.on("click","#bootstrap-theme .btn-slide",function(){var n,a,e=t(this),o=e.children("ul.panel");function c(){t(".civihr-popup").remove(),i.removeClass("civihr-popup-open")}c(),n=o.clone(!0).appendTo(i).addClass("civihr-popup"),a=e.offset(),n.css({left:+a.left-(n.width()-e.outerWidth()),top:+a.top+e.outerHeight()}),n.show(),i.addClass("civihr-popup-open"),n.find("a").click(function(){var i=t(this).parent().index();o.find("li:nth("+i+") a").click()}),e.data("attrchange-is-on")||(e.data("attrchange-is-on",!0),e.attrchange(function(){e.hasClass("btn-slide-active")||c()}))})}(CRM.$);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3QuanMiLCJocnVpLmpzIiwiY2l2aWhyLXBvcHVwL2F0dHJjaGFuZ2UuanMiLCJjaXZpaHItcG9wdXAvY2l2aWhyLXBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJfIiwidXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyIsInJvbGVzIiwiZGVwYXJ0bWVudHMiLCJsZW5ndGgiLCJodG1sIiwiam9pbiIsImRvY3VtZW50Iiwib24iLCJlIiwib25lIiwiJGZvcm0iLCJ0aGlzIiwiZmluZCIsImVhY2giLCIkbGFiZWwiLCJpZCIsImF0dHIiLCJ0ZXh0IiwiZGF0YSIsImNvbnRyYWN0IiwicmVtb3ZlQ2xhc3MiLCJwb3NpdGlvbiIsImxvY2F0aW9uIiwiYWRkQ2xhc3MiLCJDUk0iLCJpbnNlcnRGaWxlIiwiZmlsZU5hbWUiLCJmaWxlcyIsInJlbW92ZSIsInVuZGVmaW5lZCIsImFmdGVyIiwibmFtZSIsInJlbW92ZUZpbGUiLCJsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCIsIiRsaW5lIiwiJGlucHV0IiwicGFyZW50IiwidmFsIiwic2VsZWN0b3IiLCIkaW5saW5lRGF0YUJsb2NrIiwidGFyZ2V0IiwicGFyZW50cyIsImluZGV4T2YiLCJnZXQiLCJmb3JtTmFtZSIsInBhZ2VOYW1lIiwiaW5zZXJ0QWZ0ZXIiLCJoaWRlIiwiZW5kIiwic2hvdyIsIiRsYWJlbENlbGwiLCIkZmllbGRDZWxsIiwibmV4dCIsIiRuZXdUZCIsImFwcGVuZCIsImNsb3Nlc3QiLCJpbnNlcnRCZWZvcmUiLCJwcmV2IiwiY2xpY2siLCJ3aW5kb3ciLCJzZXRUaW1lb3V0IiwiQXJyYXkiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbGVtZW50IiwiUHMiLCJpbml0aWFsaXplIiwiY2hpbGRyZW4iLCJyZWFkeSIsIiRtZW51SXRlbSIsIiR3cmFwcGVkTG9nbyIsIiRjdXN0b21Ib21lTGluayIsIiRhcHBMb2dvIiwiJGhvbWVMaW5rIiwiY2xhc3NOYW1lIiwiYWpheCIsImRhdGFUeXBlIiwic3VjY2VzcyIsIm1lbnVNYXJrdXAiLCJ3cmFwcGVySWQiLCIkbWVudU1hcmt1cCIsIiRtZW51V3JhcHBlciIsIndyYXAiLCJmaXJzdCIsIndyYXBJbm5lciIsInByZXBlbmQiLCJvZmYiLCJiZWZvcmUiLCIkZWxlbWVudCIsIiRhcnJvdyIsIm5vdCIsImhvdmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIldlYktpdE11dGF0aW9uT2JzZXJ2ZXIiLCJNb3pNdXRhdGlvbk9ic2VydmVyIiwiZm4iLCJhdHRyY2hhbmdlIiwiY2FsbGJhY2siLCJvcHRpb25zIiwic3VidHJlZSIsImF0dHJpYnV0ZXMiLCJvYnNlcnZlciIsIm11dGF0aW9ucyIsIm9ic2VydmUiLCIkYm9keSIsIiRwb3B1cENsb25lIiwiYnV0dG9uT2Zmc2V0IiwiJGJ1dHRvbiIsIiRwb3B1cCIsImNsb3NlUG9wdXBQYW5lbHMiLCJjbG9uZSIsImFwcGVuZFRvIiwib2Zmc2V0IiwiY3NzIiwibGVmdCIsIndpZHRoIiwib3V0ZXJXaWR0aCIsInRvcCIsIm91dGVySGVpZ2h0IiwiYWN0aW9uSW5kZXgiLCJpbmRleCIsImhhc0NsYXNzIl0sIm1hcHBpbmdzIjoiQ0FBQyxTQUFVQSxFQUFHQyxHQXdEWixTQUFTQyxFQUFnQ0MsR0FDbkNBLEdBQVNBLEVBQU1DLGFBQWVELEVBQU1DLFlBQVlDLE9BQVMsRUFDM0RMLEVBQUUsbUNBQW1DTSxLQUFLLGdDQUFrQ0gsRUFBTUMsWUFBWUcsS0FBSyxPQUVuR1AsRUFBRSxtQ0FBbUNNLEtBQUssSUExRDlDTixFQUFFUSxVQUNDQyxHQUFHLFVBQVcsU0FBU0MsR0FDdEJWLEVBQUUsb0JBQW9CVyxJQUFJLHFCQUFzQixXQUM5QyxJQUFJQyxFQUFRWixFQUFFYSxNQUFNQyxLQUFLLFFBRUosSUFBakJGLEVBQU1QLFFBQ1JPLEVBQU1FLEtBQUssU0FBU0MsS0FBSyxXQUN2QixJQUFJQyxFQUFTaEIsRUFBRWEsTUFDWEksRUFBS0QsRUFBT0UsS0FBSyxPQUNyQmxCLEVBQUUsSUFBTWlCLEdBQUlDLEtBQUssY0FBZUYsRUFBT0csY0FLOUNWLEdBQUcsc0JBQXVCLFNBQVVDLEVBQUdVLEdBZTFDLElBQTRDQyxPQWRYLElBQWxCRCxFQUFLQyxZQWN3QkEsRUFiSEQsRUFBS0MsV0FlMUNyQixFQUFFLGtDQUFrQ3NCLFlBQVksa0RBRTVDRCxFQUFTRSxVQUNYdkIsRUFBRSxnQ0FBZ0NNLEtBQUssOEJBQStCZSxFQUFTRSxVQUc3RUYsRUFBU0csVUFDWHhCLEVBQUUsZ0NBQWdDTSxLQUFLLDBDQUEyQ2UsRUFBU0csWUFHN0Z4QixFQUFFLGtDQUFrQ3lCLFNBQVMsa0RBQzdDekIsRUFBRSxnQ0FBZ0NNLEtBQUssSUFDdkNOLEVBQUUsZ0NBQWdDTSxLQUFLLElBRXZDSixFQUFnQyxhQTFCTixJQUFma0IsRUFBS2pCLE9BQ2RELEVBQWdDa0IsRUFBS2pCLFNBdEI3QyxDQStERXVCLElBQUkxQixFQUFHMEIsSUFBSXpCO0NDNURaLFNBQVVELEVBQUdDLEdBaUtaLFNBQVMwQixJQUNQLElBQUlDLEVBQVc1QixFQUFFYSxNQUFNLEdBQUdnQixNQUFNLEdBRWhDN0IsRUFBRSxxQkFBcUI4QixjQUNOQyxJQUFiSCxJQUNGNUIsRUFBRWEsTUFBTW1CLE1BQU0scURBQXVESixFQUFTSyxLQUFPLHVGQUVyRmpDLEVBQUUsNkJBQTZCUyxHQUFHLFFBQVN5QixJQVMvQyxTQUFTQyxFQUE0QkMsR0FDbkNBLEVBQU10QixLQUFLLFNBQVNJLEtBQUssTUFBT2tCLEVBQU10QixLQUFLLGtCQUFrQkksS0FBSyxPQXNFcEUsU0FBU2dCLElBQ1AsSUFBSUcsRUFBU3JDLEVBQUUscUJBQXFCc0MsU0FBU3hCLEtBQUssc0JBRWxEZCxFQUFFLHFCQUFxQjhCLFNBQ3ZCTyxFQUFPRSxJQUFJLElBM1BidkMsRUFBRVEsVUFDQ0MsR0FBRyxVQUFXLFNBQVVDLEdBNEMzQixJQUFnQzhCLEVBNkkxQkMsRUE1SDRCL0IsRUE0SkRnQyxFQTVLSixJQUF2QjFDLEVBRDBCd0MsRUEzQ04sc0JBNENSbkMsUUFDZEwsRUFBRXdDLEdBQVUvQixHQUFHLFNBQVVrQixHQWdDMkIsSUFBbEQzQixFQUFFLHFDQUFxQ0ssU0FDekM4QixFQUEyQm5DLEVBQUUsMkJBQTJCMkMsUUFBUSxPQUNoRVIsRUFBMkJuQyxFQUFFLHlCQUF5QjJDLFFBQVEsT0FHMUQzQyxFQUFFLHFCQUFxQnVDLE1BQU1LLFFBQVEsZ0JBQWtCLEdBQ3pENUMsRUFBRUEsRUFBRSwyQ0FBMkM2QyxJQUFJLElBQUlwQixTQUFTLDhDQXZCcENmLEVBMUROQSxFQTJETCxnQkFBakJnQixJQUFJb0IsVUFBK0MsZ0JBQWpCcEIsSUFBSXFCLFdBR3BDL0MsRUFBRSx5QkFBMEIsa0NBQWtDSyxRQUNoRUwsRUFBRSx3Q0FBeUNVLEVBQUVnQyxRQUFRdkIsS0FBSyxvQkFHNUJULEVBQUVnQyxRQW9IaENELEVBQW1CekMsRUFBRSx3QkFFSkssUUFDbkJvQyxFQUNHbkIsWUFBWSw2QkFDWkcsU0FBUyxxQkFDVHVCLFlBQVksa0NBQ1psQyxLQUFLLHNCQUFzQm1DLE9BQU9DLE1BQ2xDcEMsS0FBSyxzQkFBc0JxQyxPQUk1Qm5ELEVBQUUsaUJBQWlCSyxPQUFTLElBQzlCTCxFQUFFLDhCQUE4QmUsS0FBSyxXQUNuQyxJQUFJcUMsRUFBYXBELEVBQUVhLE1BQ2Z3QyxFQUFhRCxFQUFXRSxPQUN4QkMsRUFBU3ZELEVBQUUsU0FFZnVELEVBQU9DLE9BQU9KLEVBQVd0QyxLQUFLLFVBQzlCeUMsRUFBT0MsT0FBT3hELEVBQUUsVUFDaEJ1RCxFQUFPQyxPQUFPSCxFQUFXL0MsUUFFekJOLEVBQUUsY0FBY3NDLFNBQVNOLE1BQU11QixLQUdqQ3ZELEVBQUUsdUJBQXVCOEIsVUFPSVksRUFuSk5oQyxFQUFFZ0MsT0FzSjNCMUMsRUFBRSw4REFBK0Qsa0NBQWtDc0MsT0FBTyx1QkFBdUJXLE9BRWpJakQsRUFBRSx1RUFBd0UwQyxHQUFRZSxRQUFRLHVCQUF1QlIsT0FFakhqRCxFQUFFLHFDQUFzQyxnQkFBZ0JzQyxPQUFPLE1BQU1XLE9BSXJFakQsRUFBRSx5QkFBMEIwQyxHQUFRZ0IsYUFBYTFELEVBQUUsbUNBRW5EQSxFQUFFLDhDQUErQyxnQkFBZ0JpRCxPQUNqRWpELEVBQUUsaUJBQWtCLGdCQUFnQjJELEtBQUssTUFBTUEsS0FBSyxNQUFNVixPQUMxRGpELEVBQUUseUNBQTBDLGdCQUFnQjJELEtBQUssTUFBTVYsT0FHdkVqRCxFQUFFLDhCQUErQixnQkFBZ0JnRCxZQUFZaEQsRUFBRSxrQ0FFM0RBLEVBQUUsbUJBQW9CLGdCQUFnQkssT0FBUyxHQUNqREwsRUFBRSxhQUFhNEQsU0FqSmpCNUQsRUFBRSx1QkFBdUJrQixLQUFLLFVBQVcsR0FDekNsQixFQUFFLGtFQUFrRU0sS0FBSyxXQUN6RU4sRUFBRSx3QkFBeUIsaUNBQWlDeUQsUUFBUSxPQUFPbkIsT0FBTyxPQUFPVyxPQUV6RmpELEVBQUUscURBQXFEUyxHQUFHLFFBQVMsV0FDakVvRCxPQUFPQyxXQUFXLFdBQ2hCQyxNQUFNQyxVQUFVQyxRQUFRQyxLQUFLMUQsU0FBUzJELGlCQUFpQixnQkFBaUIsU0FBVUMsR0FDaEZDLEdBQUdDLFdBQVdGLE1BRWYsS0FRTHBFLEVBQUUsd0JBQXdCc0MsT0FBTyxNQUFNaUMsU0FBUyxLQUFLWCxNQUFNLFdBQ3pENUQsRUFBRSx5REFBeUQ4QixTQUV2RDlCLEVBQUUsMkNBQTJDSyxRQUMvQ0wsRUFBRSwyQ0FBMkM4QixTQUcvQzlCLEVBQUUseUNBQXlDd0QsT0FBTywwTUE5R25EZ0IsTUFBTSxXQWFULElBQ01DLEVBQ0FDLEVBQ0FDLEVBMEcrQ0MsRUFtSUtDLEVBaUNwREMsRUFyUUo5RSxFQUFFK0UsS0FBSyxzQ0FDTEMsU0FBVSxPQUNWQyxRQUFTLFNBQVVDLEdBK0d2QixJQUF1REMsRUFDakRDLEVBQ0FDLEVBRmlERixFQTlHSixjQStHN0NDLEVBQWNwRixFQS9HbUJrRixJQWdIakNHLEVBQWVyRixFQUFFLFVBRVJrQixLQUFLLEtBQU1pRSxHQUN4QkUsRUFBYTdCLE9BQU94RCxFQUFFLGtCQUN0QnFGLEVBQWE3QixPQUFPNEIsR0FDcEJDLEVBQWFyQyxZQUFZLFlBbklyQnlCLEVBQVl6RSxFQUFFLGtCQUNkMEUsRUE4UFcxRSxFQUFFLGVBOVBxQnlFLEdBaVFuQ2hELFNBQVMsb0NBQ1RILFlBQVksZUFDWmdFLEtBQUssZ0NBQ0xoRCxTQXpKZ0RzQyxFQTFHY0YsRUFBN0RDLEVBMkdZM0UsRUFBRSxTQTNHb0N5RSxHQTJHZmMsUUFHcENwRSxLQUFLLFFBQ0xxRSxVQUFVLGlDQUNWQyxRQUFRYixHQTZINkNDLEVBM09SRixFQUFYRixFQTZPbENpQixNQUNBNUUsS0FBSyxpQkFDTDZFLE9BQU9kLEdBQ1AvQyxTQW5OSDlCLEVBQUUsdUNBQXVDeUIsU0FBUyxrQkFDbER6QixFQUFFLDZFQUE2RXlCLFNBQVMsMEJBNFB4RnpCLEVBQUUsbUNBQW1DZSxLQUFLLFNBQVU2RSxHQUNsRCxJQUFJQyxFQUFTN0YsRUFBRWEsTUFFZmdGLEVBQU9GLE9BQU8scURBQ2RFLEVBQU8vRCxXQWxCTGdELEVBQVksZUFFaEI5RSxFQUFFLGFBQWE4RixJQUFJLDRCQUE0QkMsTUFBTSxXQUNuRC9GLEVBQUVhLE1BQU1ZLFNBQVNxRCxJQUNoQixXQUNEOUUsRUFBRWEsTUFBTVMsWUFBWXdELE9BNVMxQixDQTRURXBELElBQUkxQixFQUFHMEIsSUFBSXpCO0NDL1RiLFNBQVdELEdBQ1QsYUFDQSxJQUFJZ0csRUFBbUJuQyxPQUFPbUMsa0JBQW9CbkMsT0FBT29DLHdCQUEwQnBDLE9BQU9xQyxvQkFTMUZsRyxFQUFFbUcsR0FBR0MsV0FBYSxTQUFVQyxHQUMxQixHQUFJTCxFQUFrQixDQUNwQixJQUFJTSxHQUNGQyxTQUFTLEVBQ1RDLFlBQVksR0FHVkMsRUFBVyxJQUFJVCxFQUFpQixTQUFVVSxHQUM1Q0EsRUFBVXpDLFFBQVEsU0FBVXZELEdBQzFCMkYsRUFBU25DLEtBQUt4RCxFQUFFZ0MsT0FBUWhDLE9BSTVCLE9BQU9HLEtBQUtFLEtBQUssV0FDZjBGLEVBQVNFLFFBQVE5RixLQUFNeUYsT0F6Qi9CLENBNkJHNUUsSUFBSTFCO0NDbkJQLFNBQVdBLEdBQ1QsYUFDQSxJQUFJNEcsRUFBUTVHLEVBQUUsUUFFZDRHLEVBQU1uRyxHQUFHLFFBQVMsOEJBQStCLFdBQy9DLElBQUlvRyxFQXlFRUMsRUF4RUZDLEVBQVUvRyxFQUFFYSxNQUNabUcsRUFBU0QsRUFBUXhDLFNBQVMsWUFjOUIsU0FBUzBDLElBQ1BqSCxFQUFFLGlCQUFpQjhCLFNBQ25COEUsRUFBTXRGLFlBQVkscUJBYmxCMkYsSUFxQkFKLEVBQWNHLEVBQU9FLE9BQU0sR0FDeEJDLFNBQVNQLEdBQ1RuRixTQUFTLGdCQTZDUnFGLEVBQWVDLEVBQVFLLFNBRTNCUCxFQUFZUSxLQUNWQyxNQUFPUixFQUFhUSxNQUFRVCxFQUFZVSxRQUFVUixFQUFRUyxjQUMxREMsS0FBTVgsRUFBYVcsSUFBTVYsRUFBUVcsZ0JBRW5DYixFQUFZMUQsT0FDWnlELEVBQU1uRixTQUFTLHFCQW5CZm9GLEVBQVkvRixLQUFLLEtBQUs4QyxNQUFNLFdBQzFCLElBQUkrRCxFQUFjM0gsRUFBRWEsTUFBTXlCLFNBQVNzRixRQUVuQ1osRUFBT2xHLEtBQUssVUFBWTZHLEVBQWMsT0FBTy9ELFVBeEIzQ21ELEVBQVEzRixLQUFLLHNCQUlqQjJGLEVBQVEzRixLQUFLLG9CQUFvQixHQUNqQzJGLEVBQVFYLFdBQVcsV0FFYlcsRUFBUWMsU0FBUyxxQkFJckJaLFNBeERSLENBd0ZHdkYsSUFBSTFCIiwiZmlsZSI6ImhydWkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgkLCBfKSB7XG5cbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NybUxvYWQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAkKCcuY3JtLWlubGluZS1lZGl0Jykub25lKCdET01TdWJ0cmVlTW9kaWZpZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICRmb3JtID0gJCh0aGlzKS5maW5kKCdmb3JtJyk7XG5cbiAgICAgICAgaWYgKCRmb3JtLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICRmb3JtLmZpbmQoJ2xhYmVsJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciAkbGFiZWwgPSAkKHRoaXMpO1xuICAgICAgICAgICAgdmFyIGlkID0gJGxhYmVsLmF0dHIoJ2ZvcicpO1xuICAgICAgICAgICAgJCgnIycgKyBpZCkuYXR0cigncGxhY2Vob2xkZXInLCAkbGFiZWwudGV4dCgpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICAgIC5vbigndXBkYXRlQ29udGFjdEhlYWRlcicsIGZ1bmN0aW9uIChlLCBkYXRhKSB7XG4gICAgICBpZiAodHlwZW9mIGRhdGEuY29udHJhY3QgIT09ICd1bmRlZmluZWQnKSAge1xuICAgICAgICB1cGRhdGVDb250YWN0SGVhZGVyQ29udHJhY3REZXRhaWxzKGRhdGEuY29udHJhY3QpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGRhdGEucm9sZXMgIT09ICd1bmRlZmluZWQnKSAge1xuICAgICAgICB1cGRhdGVDb250YWN0SGVhZGVyUm9sZXNEZXRhaWxzKGRhdGEucm9sZXMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250YWN0IGhlYWRlciB3aXRoIHRoZSBnaXZlbiBjb250cmFjdCBkZXRhaWxzXG4gICAqXG4gICAqIEBwYXJhbSAge29iamVjdH0gY29udHJhY3RcbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMoY29udHJhY3QpIHtcbiAgICBpZiAoY29udHJhY3QpICB7XG4gICAgICAkKCcuY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2snKS5yZW1vdmVDbGFzcygnY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2std2l0aG91dC1jb250cmFjdCcpO1xuXG4gICAgICBpZiAoY29udHJhY3QucG9zaXRpb24pIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1wb3NpdGlvbicpLmh0bWwoJzxzdHJvbmc+UG9zaXRpb246PC9zdHJvbmc+ICcrIGNvbnRyYWN0LnBvc2l0aW9uKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbnRyYWN0LmxvY2F0aW9uKSB7XG4gICAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtbG9jYXRpb24nKS5odG1sKCc8c3Ryb25nPk5vcm1hbCBwbGFjZSBvZiB3b3JrOjwvc3Ryb25nPiAnKyBjb250cmFjdC5sb2NhdGlvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jaycpLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jay13aXRob3V0LWNvbnRyYWN0Jyk7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLXBvc2l0aW9uJykuaHRtbCgnJyk7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWxvY2F0aW9uJykuaHRtbCgnJyk7XG5cbiAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJSb2xlc0RldGFpbHMobnVsbCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRhY3QgaGVhZGVyIHdpdGggdGhlIGdpdmVuIHJvbGVzIGRldGFpbHNcbiAgICpcbiAgICogQHBhcmFtICB7b2JqZWN0fSBjb250cmFjdFxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyhyb2xlcykge1xuICAgIGlmIChyb2xlcyAmJiByb2xlcy5kZXBhcnRtZW50cyAmJiByb2xlcy5kZXBhcnRtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWRlcGFydG1lbnRzJykuaHRtbCgnPHN0cm9uZz5EZXBhcnRtZW50Ojwvc3Ryb25nPiAnICsgcm9sZXMuZGVwYXJ0bWVudHMuam9pbignLCAnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtZGVwYXJ0bWVudHMnKS5odG1sKCcnKTtcbiAgICB9XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIvKiBnbG9iYWwgUHMgKi9cblxuLy8gQ29weXJpZ2h0IENpdmlDUk0gTExDIDIwMTMuIFNlZSBodHRwOi8vY2l2aWNybS5vcmcvbGljZW5zaW5nXG4oZnVuY3Rpb24gKCQsIF8pIHtcbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NybUxvYWQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgYWRkVXBsb2FkRmlsZUxpc3RlbmVyKFwiaW5wdXRbdHlwZT0nZmlsZSddXCIpO1xuICAgICAgYW1lbmRWYWNhbmN5Rm9ybSgpO1xuICAgICAgYW1lbmRDb250YWN0UGFnZUFuZEZvcm0oZSk7XG4gICAgICBhcHBseU1pc2NDaGFuZ2VzKCk7XG4gICAgICBjaGFuZ2VDb250YWN0U291cmNlRmllbGRIZWxwVGV4dCgpO1xuICAgIH0pXG4gICAgLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgIGFkZFVzZXJNZW51VG9NYWluTWVudSgpO1xuICAgICAgYW1lbmRBcHBMb2dvTWVudUl0ZW0oKTtcbiAgICAgIGFtZW5kQXBwbGljYXRpb25Gb3JtKCk7XG4gICAgICB1c2VGb250QXdlc29tZUFycm93c0luU3ViTWVudUl0ZW1zKCk7XG4gICAgICB0b2dnbGVBY3RpdmVDbGFzc09uSG92ZXJPbkFueU1haW5NZW51SXRlbSgpO1xuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBDdXN0b21pemVzIHRoZSBhcHAgbG9nbyBtZW51IGl0ZW0sIHN3aXRjaGluZyBmcm9tIHRoZSBDaXZpQ1JNIGxvZ29cbiAgICogdG8gdGhlIENpdmlIUiBsb2dvLCBhbmQgbWFraW5nIHRoZSBpdGVtIGEgZGlyZWN0IGxpbmsgaW5zdGVhZCBvZiBhXG4gICAqIHRvZ2dsZSBmb3IgYSBzdWIgbWVudSBkcm9wZG93blxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRBcHBMb2dvTWVudUl0ZW0gKCkge1xuICAgIHZhciAkbWVudUl0ZW0gPSAkKCcuY3JtLWxpbmstaG9tZScpO1xuICAgIHZhciAkd3JhcHBlZExvZ28gPSBzd2FwQW5kV3JhcEFwcExvZ28oJG1lbnVJdGVtKTtcbiAgICB2YXIgJGN1c3RvbUhvbWVMaW5rID0gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSgkbWVudUl0ZW0sICR3cmFwcGVkTG9nbyk7XG5cbiAgICByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsoJG1lbnVJdGVtLCAkY3VzdG9tSG9tZUxpbmspO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIHVzZXIgbWVudSBieSBmZXRjaGluZyBpdCBmcm9tIHRoZSBocmNvcmUgZXh0ZW5zaW9uXG4gICAqL1xuICBmdW5jdGlvbiBhZGRVc2VyTWVudVRvTWFpbk1lbnUgKCkge1xuICAgICQuYWpheCgnL2Npdmljcm0vaHJjb3JlL3VzZXJtZW51P3NuaXBwZXQ9NCcsIHtcbiAgICAgIGRhdGFUeXBlOiAnaHRtbCcsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAobWVudU1hcmt1cCkge1xuICAgICAgICBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlcihtZW51TWFya3VwLCAnY2l2aWhyLW1lbnUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgb24gaW5wdXRbdHlwZT1cImZpbGVcIl1cbiAgICogQHBhcmFtIHtqUXVlcnkgT2JqZWN0fSBzZWxlY3RvciBbc2VsZWN0b3IgZnJvbSBpbnB1dCBmaWxlXVxuICAgKi9cbiAgZnVuY3Rpb24gYWRkVXBsb2FkRmlsZUxpc3RlbmVyIChzZWxlY3Rvcikge1xuICAgIGlmICgkKHNlbGVjdG9yKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICQoc2VsZWN0b3IpLm9uKCdjaGFuZ2UnLCBpbnNlcnRGaWxlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSBhcHBsaWNhdGlvbiBmb3JtXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZEFwcGxpY2F0aW9uRm9ybSAoKSB7XG4gICAgJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fQXBwbGljYXRpb24nKS5hZGRDbGFzcygnY3JtLWZvcm0tYmxvY2snKTtcbiAgICAkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9BcHBsaWNhdGlvbiAuY3JtLXByb2ZpbGUtbmFtZS1hcHBsaWNhdGlvbl9wcm9maWxlJykuYWRkQ2xhc3MoJ2Zvcm0tbGF5b3V0LWNvbXByZXNzZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIGNvbnRhY3QgcGFnZSBhbmQgdGhlIGNvbnRhY3QgZm9ybVxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRDb250YWN0UGFnZUFuZEZvcm0gKGUpIHtcbiAgICBpZiAoQ1JNLmZvcm1OYW1lID09PSAnY29udGFjdEZvcm0nIHx8IENSTS5wYWdlTmFtZSA9PT0gJ3ZpZXdTdW1tYXJ5Jykge1xuICAgICAgLy8gUmVuYW1lIFwiU3VtbWFyeVwiIHRhYiB0byBcIlBlcnNvbmFsIERldGFpbHNcIlxuICAgICAgLy8gSGFjayB0byBjaGVjayBjb250YWN0IHR5cGUgLSBUaGlzIGZpZWxkIG9ubHkgYXBwZWFycyBmb3IgaW5kaXZpZHVhbHNcbiAgICAgIGlmICgkKCcuY3JtLWNvbnRhY3Qtam9iX3RpdGxlJywgJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpLmxlbmd0aCkge1xuICAgICAgICAkKCcuY3JtLWNvbnRhY3QtdGFicy1saXN0ICN0YWJfc3VtbWFyeSBhJywgZS50YXJnZXQpLnRleHQoJ1BlcnNvbmFsIERldGFpbHMnKTtcbiAgICAgIH1cblxuICAgICAgbWFuaXB1bGF0ZURPTU9mSW5saW5lQ3VzdG9tRGF0YShlLnRhcmdldCk7XG4gICAgICBtaXNjQ29udGFjdFBhZ2VDaGFuZ2VzKGUudGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSB2YWNhbmN5IGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIGFtZW5kVmFjYW5jeUZvcm0gKCkge1xuICAgIGlmICgkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3knKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0KCQoJ2xhYmVsW2Zvcj1cInN0YXJ0X2RhdGVcIl0nKS5wYXJlbnRzKCd0cicpKTtcbiAgICAgIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0KCQoJ2xhYmVsW2Zvcj1cImVuZF9kYXRlXCJdJykucGFyZW50cygndHInKSk7XG5cbiAgICAgIC8vIEFkZCBhIGNsYXNzIHRvIGlkZW50aWZ5IHRoZSBmb3JtICdOZXcgVmFjYW5jeSBUZW1wbGF0ZSdcbiAgICAgIGlmICgkKCdbbmFtZT1cImVudHJ5VVJMXCJdJykudmFsKCkuaW5kZXhPZignO3RlbXBsYXRlPTEnKSA+IC0xKSB7XG4gICAgICAgICQoJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fSFJWYWNhbmN5IHRib2R5JykuZ2V0KDApKS5hZGRDbGFzcygnQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3lfVGVtcGxhdGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXBwbGllcyBtaXNjZWxsYW5lb3VzIFVJIGNoYW5nZXNcbiAgICovXG4gIGZ1bmN0aW9uIGFwcGx5TWlzY0NoYW5nZXMgKCkge1xuICAgICQoJyNhY3Rpdml0eUN1c3RvbURhdGEnKS5hdHRyKCdjb2xzcGFuJywgMyk7XG4gICAgJCgnI2NybS1hY3Rpdml0eS12aWV3LXRhYmxlIC5jcm0tY2FzZS1hY3Rpdml0eS12aWV3LUNsaWVudCAubGFiZWwnKS5odG1sKCdDb250YWN0Jyk7XG4gICAgJCgnc3Bhbi5jcm0tZnJvemVuLWZpZWxkJywgJy5jcm0tcHJvZmlsZS1uYW1lLWhyaWRlbnRfdGFiJykuY2xvc2VzdCgnZGl2JykucGFyZW50KCdkaXYnKS5oaWRlKCk7XG5cbiAgICAkKCcuY3JtLWFjY29yZGlvbi1oZWFkZXIuY3JtLW1hc3Rlci1hY2NvcmRpb24taGVhZGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saXN0aW5nLWJveCcpLCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgIFBzLmluaXRpYWxpemUoZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgMCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hhbmdlcyBvZiBzb3JjZSBoZWxwIHRleHRcbiAgICovXG4gIGZ1bmN0aW9uIGNoYW5nZUNvbnRhY3RTb3VyY2VGaWVsZEhlbHBUZXh0ICgpIHtcbiAgICAkKCdJTlBVVCNjb250YWN0X3NvdXJjZScpLnBhcmVudCgndGQnKS5jaGlsZHJlbignYScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAgLm5vdGlmeS1jb250ZW50JykucmVtb3ZlKCk7XG5cbiAgICAgIGlmICgkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwIHAnKS5sZW5ndGgpIHtcbiAgICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCBwJykucmVtb3ZlKCk7XG4gICAgICB9XG5cbiAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAnKS5hcHBlbmQoJzxwPlNvdXJjZSBpcyBhIHVzZWZ1bCBmaWVsZCB3aGVyZSBkYXRhIGhhcyBiZWVuIG1pZ3JhdGVkIHRvIENpdmlIUiBmcm9tIG9uZSBvciBhIG51bWJlciBvZiBvdGhlciBsZWdhY3kgc3lzdGVtcy4gVGhlIFNvdXJjZSBmaWVsZCB3aWxsIGluZGljYXRlIHdoaWNoIGxlZ2FjeSBzeXN0ZW0gdGhlIGNvbnRhY3QgaGFzIGNvbWUgZnJvbS48L3A+Jyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIG9yaWdpbmFsIGxpbmsgdG8gdGhlIGhvbWVwYWdlLCBjaGFuZ2VzIHRoZSB0ZXh0LCB3cmFwcyBpdCBpbiBhXG4gICAqIGBtZW51bWFpbi1sYWJlbGAgZWxlbWVudCBhbmQgcHJlcGVuZHMgaW50ZXJuYWxseSB0aGUgZ2l2ZW4gYXBwIGxvZ29cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICRtZW51SXRlbSBUaGUgY29udGV4dCB3aGVyZSB0byBmaW5kIHRoZSBsaW5rXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkYXBwTG9nb1xuICAgKiBAcmV0dXJuIHRoZSBjdXN0b21pemVkIGhvbWUgbGlua1xuICAgKi9cbiAgZnVuY3Rpb24gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSAoJG1lbnVJdGVtLCAkYXBwTG9nbykge1xuICAgIHZhciAkaG9tZUxpbmsgPSAkKCdsaSA+IGEnLCAkbWVudUl0ZW0pLmZpcnN0KCk7XG5cbiAgICByZXR1cm4gJGhvbWVMaW5rXG4gICAgICAudGV4dCgnSG9tZScpXG4gICAgICAud3JhcElubmVyKCc8c3BhbiBjbGFzcz1cIm1lbnVtYWluLWxhYmVsXCI+JylcbiAgICAgIC5wcmVwZW5kKCRhcHBMb2dvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmplY3RzIHRoZSBnaXZlbiBtYXJrdXAgaW4gYSBtZW51IHdyYXBwZXIgd2l0aCB0aGUgZ2l2ZW4gaWRcbiAgICogY3JlYXRlZCB0byBjb250YWluIGJvdGggdGhlIG9yaWdpbmFsIG1lbnUgYW5kIHRoZSB1c2VyIG9uZVxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVudU1hcmt1cFxuICAgKiBAcGFyYW0ge3N0cmluZ30gd3JhcHBlcklkXG4gICAqL1xuICBmdW5jdGlvbiBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlciAobWVudU1hcmt1cCwgd3JhcHBlcklkKSB7XG4gICAgdmFyICRtZW51TWFya3VwID0gJChtZW51TWFya3VwKTtcbiAgICB2YXIgJG1lbnVXcmFwcGVyID0gJCgnPGRpdj4nKTtcblxuICAgICRtZW51V3JhcHBlci5hdHRyKCdpZCcsIHdyYXBwZXJJZCk7XG4gICAgJG1lbnVXcmFwcGVyLmFwcGVuZCgkKCcjY2l2aWNybS1tZW51JykpO1xuICAgICRtZW51V3JhcHBlci5hcHBlbmQoJG1lbnVNYXJrdXApO1xuICAgICRtZW51V3JhcHBlci5pbnNlcnRBZnRlcignI3BhZ2UnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnNlcnQgYSBET00gbm9kZSBhZnRlciBpbnB1dFt0eXBlPVwiZmlsZVwiXVxuICAgKiB3aXRoIHRoZSBmaWxlbmFtZVxuICAgKi9cbiAgZnVuY3Rpb24gaW5zZXJ0RmlsZSAoKSB7XG4gICAgdmFyIGZpbGVOYW1lID0gJCh0aGlzKVswXS5maWxlc1swXTtcblxuICAgICQoJyNqcy11cGxvYWRlZC1maWxlJykucmVtb3ZlKCk7XG4gICAgaWYgKGZpbGVOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICQodGhpcykuYWZ0ZXIoJzxzcGFuIGlkPVwianMtdXBsb2FkZWQtZmlsZVwiIGNsYXNzPVwidXBsb2FkZWQtZmlsZVwiPicgKyBmaWxlTmFtZS5uYW1lICsgJyA8c3BhbiBjbGFzcz1cInVwbG9hZGVkLWZpbGUtaWNvbi10cmFzaFwiPjxpIGNsYXNzPVwiZmEgZmEtdHJhc2gtb1wiPjwvaT4gUmVtb3ZlPC9zcGFuPicpO1xuXG4gICAgICAkKCcudXBsb2FkZWQtZmlsZS1pY29uLXRyYXNoJykub24oJ2NsaWNrJywgcmVtb3ZlRmlsZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBsYWJlbCAnZm9yJyBhdHRyIHRvIHdvcmtzIHdpdGggdGhlIGRhdGVwaWNrZXJcbiAgICpcbiAgICogQHBhcmFtICB7alF1ZXJ5IG9iamVjdH0gJGxpbmUgW2RhdGVwaWNrZXIncyBsaW5lIHBhcmVudF1cbiAgICovXG4gIGZ1bmN0aW9uIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0ICgkbGluZSkge1xuICAgICRsaW5lLmZpbmQoJ2xhYmVsJykuYXR0cignZm9yJywgJGxpbmUuZmluZCgnLmNybS1mb3JtLWRhdGUnKS5hdHRyKCdpZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYW5pcHVsYXRlcywgYXQgdGhlIERPTSBsZXZlbCwgdGhlIGJsb2Nrcy9maWVsZHMgYmVsb25naW5nIHRvIHRoZVxuICAgKiBJbmxpbmUgQ3VzdG9tIERhdGEgY3VzdG9tIGZpZWxkcyBzZXRcbiAgICovXG4gIGZ1bmN0aW9uIG1hbmlwdWxhdGVET01PZklubGluZUN1c3RvbURhdGEgKCkge1xuICAgIC8vIEluIFBlcnNvbmFsIERldGFpbHMgUGFnZVxuICAgIHZhciAkaW5saW5lRGF0YUJsb2NrID0gJCgnLklubGluZV9DdXN0b21fRGF0YScpO1xuXG4gICAgaWYgKCRpbmxpbmVEYXRhQmxvY2subGVuZ3RoKSB7XG4gICAgICAkaW5saW5lRGF0YUJsb2NrXG4gICAgICAgIC5yZW1vdmVDbGFzcygnY3JtLWNvbGxhcHNpYmxlIGNvbGxhcHNlZCcpXG4gICAgICAgIC5hZGRDbGFzcygnY3JtLXN1bW1hcnktYmxvY2snKVxuICAgICAgICAuaW5zZXJ0QWZ0ZXIoJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpXG4gICAgICAgIC5maW5kKCcuY29sbGFwc2libGUtdGl0bGUnKS5oaWRlKCkuZW5kKClcbiAgICAgICAgLmZpbmQoJy5jcm0tc3VtbWFyeS1ibG9jaycpLnNob3coKTtcbiAgICB9XG5cbiAgICAvLyBJbiBFZGl0IENvbnRhY3QgRm9ybVxuICAgIGlmICgkKCcjY3VzdG9tRmllbGRzJykubGVuZ3RoIDwgMSkge1xuICAgICAgJCgnI0lubGluZV9DdXN0b21fRGF0YSAubGFiZWwnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyICRsYWJlbENlbGwgPSAkKHRoaXMpO1xuICAgICAgICB2YXIgJGZpZWxkQ2VsbCA9ICRsYWJlbENlbGwubmV4dCgpO1xuICAgICAgICB2YXIgJG5ld1RkID0gJCgnPHRkLz4nKTtcblxuICAgICAgICAkbmV3VGQuYXBwZW5kKCRsYWJlbENlbGwuZmluZCgnbGFiZWwnKSk7XG4gICAgICAgICRuZXdUZC5hcHBlbmQoJCgnPGJyLz4nKSk7XG4gICAgICAgICRuZXdUZC5hcHBlbmQoJGZpZWxkQ2VsbC5odG1sKCkpO1xuXG4gICAgICAgICQoJyNuaWNrX25hbWUnKS5wYXJlbnQoKS5hZnRlcigkbmV3VGQpO1xuICAgICAgfSk7XG5cbiAgICAgICQoJyNJbmxpbmVfQ3VzdG9tX0RhdGEnKS5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWlzYyBjaGFuZ2VzIHRvIHRoZSBwYWdlIChoaWRpbmcgZWxlbWVudHMsIGluc2VydGluZyBuZXcgb25lcywgZXRjKVxuICAgKi9cbiAgZnVuY3Rpb24gbWlzY0NvbnRhY3RQYWdlQ2hhbmdlcyAodGFyZ2V0KSB7XG4gICAgLy8gSGlkZSBjdXJyZW50IGVtcGxveWVyIGFuZCBqb2IgdGl0bGVcbiAgICAvLyBDb250YWN0IHN1bW1hcnkgc2NyZWVuOlxuICAgICQoJ2Rpdi5jcm0tY29udGFjdC1jdXJyZW50X2VtcGxveWVyLCBkaXYuY3JtLWNvbnRhY3Qtam9iX3RpdGxlJywgJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpLnBhcmVudCgnZGl2LmNybS1zdW1tYXJ5LXJvdycpLmhpZGUoKTtcbiAgICAvLyBJbmxpbmUgZWRpdCBmb3JtXG4gICAgJCgnZm9ybSNDb250YWN0SW5mbyBpbnB1dCNlbXBsb3llcl9pZCwgZm9ybSNDb250YWN0SW5mbyBpbnB1dCNqb2JfdGl0bGUnLCB0YXJnZXQpLmNsb3Nlc3QoJ2Rpdi5jcm0tc3VtbWFyeS1yb3cnKS5oaWRlKCk7XG4gICAgLy8gQ29udGFjdCBlZGl0IHNjcmVlblxuICAgICQoJ2lucHV0I2VtcGxveWVyX2lkLCBpbnB1dCNqb2JfdGl0bGUnLCAnZm9ybSNDb250YWN0JykucGFyZW50KCd0ZCcpLmhpZGUoKTtcblxuICAgIC8qIENoYW5nZXMgb24gQWRkIEluZGl2aWR1YWwgcGFnZXMgYW5kIFBlcnNvbmFsIGRldGFpbHMgdGFiIGZvciBIUi0zNTggKi9cbiAgICAvLyBNb3ZlIEpvYiBzdW1tYXJ5IHRvIHRvcFxuICAgICQoJy5IUkpvYkNvbnRyYWN0X1N1bW1hcnknLCB0YXJnZXQpLmluc2VydEJlZm9yZSgkKCcuY3JtLXN1bW1hcnktY29udGFjdGluZm8tYmxvY2snKSk7XG4gICAgLy8gY2hhbmdlcyBvZiBlbWFpbCBibG9jaywgcmVtb3ZlIGJ1bGttYWlsIGFuZCBvbmhvbGRcbiAgICAkKCdkaXYuZW1haWwtc2lnbmF0dXJlLCB0ZCNFbWFpbC1CdWxrbWFpbC1odG1sJywgJ2Zvcm0jQ29udGFjdCcpLmhpZGUoKTtcbiAgICAkKCcjRW1haWwtUHJpbWFyeScsICdmb3JtI0NvbnRhY3QnKS5wcmV2KCd0ZCcpLnByZXYoJ3RkJykuaGlkZSgpO1xuICAgICQoJ3RkI0VtYWlsLUJ1bGttYWlsLWh0bWwsICNFbWFpbC1QcmltYXJ5JywgJ2Zvcm0jQ29udGFjdCcpLnByZXYoJ3RkJykuaGlkZSgpO1xuXG4gICAgLy8gc2hpZnQgZGVtb2dyYXBoaWMgYWJvdmUgZXh0ZW5kZWQgZGVtb2dyYXBoaWNcbiAgICAkKCcuY3JtLWRlbW9ncmFwaGljcy1hY2NvcmRpb24nLCAnZm9ybSNDb250YWN0JykuaW5zZXJ0QWZ0ZXIoJCgnLmNybS1jb250YWN0RGV0YWlscy1hY2NvcmRpb24nKSk7XG5cbiAgICBpZiAoJCgndHIjUGhvbmVfQmxvY2tfMicsICdmb3JtI0NvbnRhY3QnKS5sZW5ndGggPCAxKSB7XG4gICAgICAkKCcjYWRkUGhvbmUnKS5jbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlICNqcy11cGxvYWRlZC1maWxlIERJViBhbmRcbiAgICogY2xlYW4gaW5wdXRbdHlwZT1cImZpbGVcIl0gdmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIHJlbW92ZUZpbGUgKCkge1xuICAgIHZhciAkaW5wdXQgPSAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnBhcmVudCgpLmZpbmQoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnJlbW92ZSgpO1xuICAgICRpbnB1dC52YWwoJycpO1xuICB9XG5cbiAgLyoqXG4gICAqIE1vdmVzIHRoZSBnaXZlbiBob21lIGxpbmsgcmlnaHQgdW5kZXIgdGhlIG1lbnUgaXRlbSBhbmQgZ2V0cyByaWRcbiAgICogb2YgdGhlIG9yaWdpbmFsIHN1YiBtZW51XG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbGlua1xuICAgKiBAcGFyYW0ge29iamVjdH0gJGhvbWVMaW5rXG4gICAqL1xuICBmdW5jdGlvbiByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsgKCRtZW51SXRlbSwgJGhvbWVMaW5rKSB7XG4gICAgJG1lbnVJdGVtXG4gICAgICAub2ZmKCkgLy8gcmVtb3ZlcyBhbnkgaGFuZGxlciB0aGF0IHRoZSBvcmlnaW5hbCBpdGVtIGhhZFxuICAgICAgLmZpbmQoJyNjaXZpY3JtLWhvbWUnKVxuICAgICAgLmJlZm9yZSgkaG9tZUxpbmspXG4gICAgICAucmVtb3ZlKCk7XG4gIH1cblxuICAvKipcbiAgICogU3dhcHMgdGhlIENpdmlDUk0gbG9nbyB3aXRoIHRoZSBDaXZpSFIgbG9nb1xuICAgKiBhbmQgd3JhcHMgaXQgaW4gYSBgbWVudW1haW4taWNvbmAgZWxlbWVudFxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gJG1lbnVJdGVtIFRoZSBjb250ZXh0IHdoZXJlIHRvIGZpbmQgdGhlIGxvZ29cbiAgICogQHJldHVybiB0aGUgd3JhcHBlciBvZiB0aGUgbG9nb1xuICAgKi9cbiAgZnVuY3Rpb24gc3dhcEFuZFdyYXBBcHBMb2dvICgkbWVudUl0ZW0pIHtcbiAgICB2YXIgJGFwcExvZ28gPSAkKCcuY3JtLWxvZ28tc20nLCAkbWVudUl0ZW0pO1xuXG4gICAgcmV0dXJuICRhcHBMb2dvXG4gICAgICAuYWRkQ2xhc3MoJ2Nocl9sb2dvIGNocl9sb2dvLS1kZWZhdWx0LWNvbG9yJylcbiAgICAgIC5yZW1vdmVDbGFzcygnY3JtLWxvZ28tc20nKVxuICAgICAgLndyYXAoJzxzcGFuIGNsYXNzPVwibWVudW1haW4taWNvblwiPicpXG4gICAgICAucGFyZW50KCk7XG4gIH1cblxuICAvKipcbiAgICogQ2l2aUNSTSBieSBkZWZhdWx0IGFwcGxpZXMgb24gaG92ZXIgdGhlIC5hY3RpdmV0YXJnZXQgY2xhc3NcbiAgICogb25seSB0byBtYWluIG1lbnUgaXRlbXMgd2l0aCBhIHN1Ym1lbnVcbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgbWFrZXMgc3VyZSB0aGF0IGFueSBpdGVtIGdldHMgdGhlIGNsYXNzIGFwcGxpZWQsXG4gICAqIGV2ZW4gdGhvc2Ugd2l0aCBqdXN0IGEgZGlyZWN0IGxpbmtcbiAgICovXG4gIGZ1bmN0aW9uIHRvZ2dsZUFjdGl2ZUNsYXNzT25Ib3Zlck9uQW55TWFpbk1lbnVJdGVtICgpIHtcbiAgICB2YXIgY2xhc3NOYW1lID0gJ2FjdGl2ZXRhcmdldCc7XG5cbiAgICAkKCcubWVudW1haW4nKS5ub3QoJy5jcm0tU2VsZl9TZXJ2aWNlX1BvcnRhbCcpLmhvdmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBhcnJvdyBmb3IgbWVudSBpdGVtcyB3aXRoIHN1Yi1pdGVtcywgYW5kIHJlcGxhY2VzIGl0XG4gICAqIHdpdGggYSBmb250IGF3ZXNvbWUgY2FyZXRcbiAgICovXG4gIGZ1bmN0aW9uIHVzZUZvbnRBd2Vzb21lQXJyb3dzSW5TdWJNZW51SXRlbXMgKCkge1xuICAgICQoJyNyb290LW1lbnUtZGl2IC5tZW51LWl0ZW0tYXJyb3cnKS5lYWNoKGZ1bmN0aW9uICgkZWxlbWVudCkge1xuICAgICAgdmFyICRhcnJvdyA9ICQodGhpcyk7XG5cbiAgICAgICRhcnJvdy5iZWZvcmUoJzxpIGNsYXNzPVwiZmEgZmEtY2FyZXQtcmlnaHQgbWVudS1pdGVtLWFycm93XCI+PC9pPicpO1xuICAgICAgJGFycm93LnJlbW92ZSgpO1xuICAgIH0pO1xuICB9XG59KENSTS4kLCBDUk0uXykpO1xuIiwiKGZ1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlcjtcblxuICAvKlxuICBUaGlzIHBsdWdpbiBjcmVhdGVzIE11dGF0aW9uT2JzZXJ2ZXIgd2hpY2ggbGlzdGVucyB0byBhbGwgY2hhbmdlcyB0byBET00gTm9kZS5cbiAgSWYgY2hhbmdlIGhhcyBiZWVuIGRvbmUgdG8gaXQncyBhdHRyaWJ1dGVzIGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkLlxuXG4gIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gdG8gYmUgY2FsbGVkIHdoZW4gYXR0cmlidXRlcyBjaGFuZ2VcbiAgQHJldHVybnMge0FycmF5fSAtIGxpc3Qgb2YgYWxsIG9ic2VydmVkIGVsZW1lbnRzXG4gICovXG4gICQuZm4uYXR0cmNoYW5nZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgc3VidHJlZTogZmFsc2UsXG4gICAgICAgIGF0dHJpYnV0ZXM6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBjYWxsYmFjay5jYWxsKGUudGFyZ2V0LCBlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUodGhpcywgb3B0aW9ucyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKENSTS4kKTtcbiIsIi8qIGdsb2JhbHMgQ1JNICovXG5cbi8qKlxuICogSGVscHMgdG8gZGlzcGxheSBwb3B1cCBtZW51cyBpbnNpZGUgI2Jvb3RzdHJhcC10aGVtZSBlbGVtZW50cywgc2luY2UgLnBhbmVsJ3NcbiAqIGFuZCBvdGhlciBCb290c3RyYXAgZWxlbWVudHMgY2xhc2ggd2l0aCBDaXZpQ1JNIHN0eWxlcyBwcm9kdWNpbmcgdW5kZXNpcmVkXG4gKiByZXN1bHRzLlxuICpcbiAqIEl0IGFsc28gaGVscHMgd2l0aCBldmVudCBiaW5kaW5ncywgaW4gY2FzZSB0aGUgb3JpZ2luYWwgcG9wdXAgYnV0dG9uIHdhc1xuICogcmVtb3ZlZCBhbmQgcmVjcmVhdGVkLCBieSBmb3J3YXJkaW5nIHRoZSBldmVudHMgdG8gdGhlIG9yaWdpbmFsIHNvdXJjZS5cbiAqL1xuKGZ1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyICRib2R5ID0gJCgnYm9keScpO1xuXG4gICRib2R5Lm9uKCdjbGljaycsICcjYm9vdHN0cmFwLXRoZW1lIC5idG4tc2xpZGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRwb3B1cENsb25lO1xuICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKTtcbiAgICB2YXIgJHBvcHVwID0gJGJ1dHRvbi5jaGlsZHJlbigndWwucGFuZWwnKTtcblxuICAgIChmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgIGNsb3NlUG9wdXBQYW5lbHMoKTtcbiAgICAgIGNyZWF0ZVBvcHVwQ2xvbmUoKTtcbiAgICAgIG9wZW5Qb3B1cENsb25lKCk7XG4gICAgICBtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4oKTtcbiAgICAgIGxpc3RlblRvTW91c2VPdXRFdmVudCgpO1xuICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIGFueSBwb3B1cCBwYW5lbCB0aGF0IGlzIGN1cnJlbnRseSBvcGVuIGFuZCByZW1vdmVzIHRoZVxuICAgICAqIGAuY2l2aWhyLXBvcHVwLW9wZW5gIGNsYXNzIGZyb20gdGhlIGJvZHkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvc2VQb3B1cFBhbmVscyAoKSB7XG4gICAgICAkKCcuY2l2aWhyLXBvcHVwJykucmVtb3ZlKCk7XG4gICAgICAkYm9keS5yZW1vdmVDbGFzcygnY2l2aWhyLXBvcHVwLW9wZW4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgdGhlIHBvcHVwIGVsZW1lbnQgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGRvY3VtZW50IGJvZHkuXG4gICAgICogVGhpcyBwcmV2ZW50cyB0aGUgcG9wdXAgdG8gYmUgaGlkZGVuIGJ5IGFueSBgb3ZlcmZsb3c6IGhpZGRlbjtgIHJ1bGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUG9wdXBDbG9uZSAoKSB7XG4gICAgICAkcG9wdXBDbG9uZSA9ICRwb3B1cC5jbG9uZSh0cnVlKVxuICAgICAgICAuYXBwZW5kVG8oJGJvZHkpXG4gICAgICAgIC5hZGRDbGFzcygnY2l2aWhyLXBvcHVwJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlzdGVucyB0byBtb3VzZSBldmVudHMgaGFwcGVuaW5nIG91dHNpZGUgdGhlIG9mIHRoZSBwYW5lbCBpbiBvcmRlciB0b1xuICAgICAqIGNsb3NlIGl0LiBUaGUgd2F5IHRvIGRldGVjdGVkIG1vdXNlIG91dCBpcyBieSBsaXN0ZW5pbmcgdG8gdGhlXG4gICAgICogLmJ0bi1zbGlkZS1hY3RpdmUgY2xhc3MgY2hhbmdlLCB3aGljaCBpcyBhZGRlZCBhbmQgcmVtb3ZlZCBieSBDaXZpQ1JNLlxuICAgICAqIHRoZSBkYXRhICphdHRyY2hhbmdlLWlzLW9uKiBpcyBzZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBhdm9pZCBhZGRpbmdcbiAgICAgKiBtdWx0aXBsZSBsaXN0ZW5lcnMgdG8gdGhlIHNhbWUgZWxlbWVudC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsaXN0ZW5Ub01vdXNlT3V0RXZlbnQgKCkge1xuICAgICAgLy8gSWYgQXR0ckNoYW5nZSBldmVudCBpcyBhbHJlYWR5IGxpc3RlbmVkLCB0aGVuIHNraXA6XG4gICAgICBpZiAoJGJ1dHRvbi5kYXRhKCdhdHRyY2hhbmdlLWlzLW9uJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAkYnV0dG9uLmRhdGEoJ2F0dHJjaGFuZ2UtaXMtb24nLCB0cnVlKTtcbiAgICAgICRidXR0b24uYXR0cmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIElmIGJ1dHRvbiBpcyBhbHJlYWR5IG9wZW4sIHRoZW4gc2tpcDpcbiAgICAgICAgaWYgKCRidXR0b24uaGFzQ2xhc3MoJ2J0bi1zbGlkZS1hY3RpdmUnKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsb3NlUG9wdXBQYW5lbHMoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcHMgY2xpY2sgZXZlbnRzIG9uIHRoZSBwb3B1cCBvcHRpb25zIGJhY2sgdG8gdGhlaXIgb3JpZ2luYWwgc291cmNlLlxuICAgICAqIFRoaXMgaXMgZG9uZSBiZWNhdXNlIHBvcHVwIGFjdGlvbnMgYXJlIGV4ZWN1dGVkIGFzIGRlbGVnYXRlZCBldmVudHMgYW5kXG4gICAgICogdGhlIGxpc3RlbmVyIGlzIG5vdCB0aGUgKmJvZHkqIGVsZW1lbnQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwQ2xvbmVDbGlja0V2ZW50c1RvT3JpZ2luICgpIHtcbiAgICAgICRwb3B1cENsb25lLmZpbmQoJ2EnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhY3Rpb25JbmRleCA9ICQodGhpcykucGFyZW50KCkuaW5kZXgoKTtcblxuICAgICAgICAkcG9wdXAuZmluZCgnbGk6bnRoKCcgKyBhY3Rpb25JbmRleCArICcpIGEnKS5jbGljaygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIHBvcHVwIHBhbmVsIGNsb25lXG4gICAgICogYW5kIGFkZHMgdGhlIC5jaXZpaHItcG9wdXAtb3BlbiBjbGFzcyB0byB0aGUgYm9keVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9wZW5Qb3B1cENsb25lICgpIHtcbiAgICAgIHZhciBidXR0b25PZmZzZXQgPSAkYnV0dG9uLm9mZnNldCgpO1xuXG4gICAgICAkcG9wdXBDbG9uZS5jc3Moe1xuICAgICAgICBsZWZ0OiArYnV0dG9uT2Zmc2V0LmxlZnQgLSAoJHBvcHVwQ2xvbmUud2lkdGgoKSAtICRidXR0b24ub3V0ZXJXaWR0aCgpKSxcbiAgICAgICAgdG9wOiArYnV0dG9uT2Zmc2V0LnRvcCArICRidXR0b24ub3V0ZXJIZWlnaHQoKVxuICAgICAgfSk7XG4gICAgICAkcG9wdXBDbG9uZS5zaG93KCk7XG4gICAgICAkYm9keS5hZGRDbGFzcygnY2l2aWhyLXBvcHVwLW9wZW4nKTtcbiAgICB9XG4gIH0pO1xufSkoQ1JNLiQpO1xuIl19
