!function(t,o){function n(o){o&&o.departments&&o.departments.length>0?t(".crm-contact-detail-departments").html("<strong>Department:</strong> "+o.departments.join(", ")):t(".crm-contact-detail-departments").html("")}t(document).on("crmLoad",function(o){t(".crm-inline-edit").one("DOMSubtreeModified",function(){var o=t(this).find("form");1===o.length&&o.find("label").each(function(){var o=t(this),n=o.attr("for");t("#"+n).attr("placeholder",o.text())})})}).on("updateContactHeader",function(o,c){var a;void 0!==c.contract&&((a=c.contract)?(t(".crm-summary-contactname-block").removeClass("crm-summary-contactname-block-without-contract"),a.position&&t(".crm-contact-detail-position").html("<strong>Position:</strong> "+a.position),a.location&&t(".crm-contact-detail-location").html("<strong>Normal place of work:</strong> "+a.location)):(t(".crm-summary-contactname-block").addClass("crm-summary-contactname-block-without-contract"),t(".crm-contact-detail-position").html(""),t(".crm-contact-detail-location").html(""),n(null))),void 0!==c.roles&&n(c.roles)})}(CRM.$,CRM._);
!function(e,t){function a(){var t=e(this)[0].files[0];e("#js-uploaded-file").remove(),void 0!==t&&(e(this).after('<span id="js-uploaded-file" class="uploaded-file">'+t.name+' <span class="uploaded-file-icon-trash"><i class="fa fa-trash-o"></i> Remove</span>'),e(".uploaded-file-icon-trash").on("click",r))}function o(e){e.find("label").attr("for",e.find(".crm-form-date").attr("id"))}function r(){var t=e("#js-uploaded-file").parent().find('input[type="file"]');e("#js-uploaded-file").remove(),t.val("")}function n(t){e(t).removeClass("crm-collapsible collapsed").addClass("crm-summary-block").appendTo(".contactTopBar .contactCardLeft").find(".collapsible-title").hide().end().find(".crm-summary-block").show()}e(document).on("crmLoad",function(t){var r,n,i;1===e(r="input[type='file']").length&&e(r).on("change",a),1===e(".CRM_HRRecruitment_Form_HRVacancy").length&&(o(e('label[for="start_date"]').parents("tr")),o(e('label[for="end_date"]').parents("tr")),e('[name="entryURL"]').val().indexOf(";template=1")>-1&&e(e(".CRM_HRRecruitment_Form_HRVacancy tbody").get(0)).addClass("CRM_HRRecruitment_Form_HRVacancy_Template")),n=t,"contactForm"!==CRM.formName&&"viewSummary"!==CRM.pageName||(e(".crm-contact-job_title",".crm-summary-contactinfo-block").length&&e(".crm-contact-tabs-list #tab_summary a",n.target).text("Personal Details"),n.target,e("#customFields").length<1&&e("#Inline_Custom_Data").detach().find(".label").each(function(){var t=e(this),a=t.next(),o=e("<td/>");o.append(t.find("label")),o.append(e("<br/>")),o.append(a.html()),e("#nick_name").parent().after(o)}),i=n.target,e("div.crm-contact-current_employer, div.crm-contact-job_title",".crm-summary-contactinfo-block").parent("div.crm-summary-row").hide(),e("form#ContactInfo input#employer_id, form#ContactInfo input#job_title",i).closest("div.crm-summary-row").hide(),e("input#employer_id, input#job_title","form#Contact").parent("td").hide(),e(".HRJobContract_Summary",i).insertBefore(e(".crm-summary-contactinfo-block")),e("div.email-signature, td#Email-Bulkmail-html","form#Contact").hide(),e("#Email-Primary","form#Contact").prev("td").prev("td").hide(),e("td#Email-Bulkmail-html, #Email-Primary","form#Contact").prev("td").hide(),e(".crm-demographics-accordion","form#Contact").insertAfter(e(".crm-contactDetails-accordion")),e("tr#Phone_Block_2","form#Contact").length<1&&e("#addPhone").click()),e("#activityCustomData").attr("colspan",3),e("#crm-activity-view-table .crm-case-activity-view-Client .label").html("Contact"),e("span.crm-frozen-field",".crm-profile-name-hrident_tab").closest("div").parent("div").hide(),e(".crm-accordion-header.crm-master-accordion-header").on("click",function(){window.setTimeout(function(){Array.prototype.forEach.call(document.querySelectorAll(".listing-box"),function(e){Ps.initialize(e)})},0)}),e("INPUT#contact_source").parent("td").children("a").click(function(){e("#crm-notification-container .crm-help .notify-content").remove(),e("#crm-notification-container .crm-help p").length&&e("#crm-notification-container .crm-help p").remove(),e("#crm-notification-container .crm-help").append("<p>Source is a useful field where data has been migrated to CiviHR from one or a number of other legacy systems. The Source field will indicate which legacy system the contact has come from.</p>")})}).ready(function(){var t,a,o,r,n,i;e.ajax("/civicrm/hrcore/usermenu?snippet=4",{dataType:"html",success:function(t){var a,o,r;a="civihr-menu",o=e(t),(r=e("<div>")).attr("id",a),r.append(e("#civicrm-menu")),r.append(o),r.insertAfter("#page")}}),t=e(".crm-link-home"),a=e(".crm-logo-sm",t).addClass("chr_logo chr_logo--default-color").removeClass("crm-logo-sm").wrap('<span class="menumain-icon">').parent(),r=a,o=e("li > a",t).first().text("Home").wrapInner('<span class="menumain-label">').prepend(r),n=o,t.off().find("#civicrm-home").before(n).remove(),e(".CRM_HRRecruitment_Form_Application").addClass("crm-form-block"),e(".CRM_HRRecruitment_Form_Application .crm-profile-name-application_profile").addClass("form-layout-compressed"),e("#root-menu-div .menu-item-arrow").each(function(t){var a=e(this);a.before('<i class="fa fa-caret-right menu-item-arrow"></i>'),a.remove()}),i="activetarget",e(".menumain").not(".crm-Self_Service_Portal").hover(function(){e(this).addClass(i)},function(){e(this).removeClass(i)})}),e(".Inline_Custom_Data").length&&n(".Inline_Custom_Data"),n(".Extended_Demographics")}(CRM.$,CRM._);
!function(t){"use strict";var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t.fn.attrchange=function(t){if(n){var e={subtree:!1,attributes:!0},i=new n(function(n){n.forEach(function(n){t.call(n.target,n)})});return this.each(function(){i.observe(this,e)})}}}(CRM.$);
!function(t){"use strict";var i=t("body");i.on("click","#bootstrap-theme .btn-slide",function(){var n,a,e=t(this),o=e.children("ul.panel");function c(){t(".civihr-popup").remove(),i.removeClass("civihr-popup-open")}c(),n=o.clone(!0).appendTo(i).addClass("civihr-popup"),a=e.offset(),n.css({left:+a.left-(n.width()-e.outerWidth()),top:+a.top+e.outerHeight()}),n.show(),i.addClass("civihr-popup-open"),n.find("a").click(function(){var i=t(this).parent().index();o.find("li:nth("+i+") a").click()}),e.data("attrchange-is-on")||(e.data("attrchange-is-on",!0),e.attrchange(function(){e.hasClass("btn-slide-active")||c()}))})}(CRM.$);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3QuanMiLCJocnVpLmpzIiwiY2l2aWhyLXBvcHVwL2F0dHJjaGFuZ2UuanMiLCJjaXZpaHItcG9wdXAvY2l2aWhyLXBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJfIiwidXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyIsInJvbGVzIiwiZGVwYXJ0bWVudHMiLCJsZW5ndGgiLCJodG1sIiwiam9pbiIsImRvY3VtZW50Iiwib24iLCJlIiwib25lIiwiJGZvcm0iLCJ0aGlzIiwiZmluZCIsImVhY2giLCIkbGFiZWwiLCJpZCIsImF0dHIiLCJ0ZXh0IiwiZGF0YSIsImNvbnRyYWN0IiwicmVtb3ZlQ2xhc3MiLCJwb3NpdGlvbiIsImxvY2F0aW9uIiwiYWRkQ2xhc3MiLCJDUk0iLCJpbnNlcnRGaWxlIiwiZmlsZU5hbWUiLCJmaWxlcyIsInJlbW92ZSIsInVuZGVmaW5lZCIsImFmdGVyIiwibmFtZSIsInJlbW92ZUZpbGUiLCJsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCIsIiRsaW5lIiwiJGlucHV0IiwicGFyZW50IiwidmFsIiwicmVwb3NpdGlvblBlcnNvbmFsRGV0YWlsc0Jsb2NrIiwic2VsZWN0b3IiLCJhcHBlbmRUbyIsImhpZGUiLCJlbmQiLCJzaG93IiwidGFyZ2V0IiwicGFyZW50cyIsImluZGV4T2YiLCJnZXQiLCJmb3JtTmFtZSIsInBhZ2VOYW1lIiwiZGV0YWNoIiwiJGxhYmVsQ2VsbCIsIiRmaWVsZENlbGwiLCJuZXh0IiwiJG5ld1RkIiwiYXBwZW5kIiwiY2xvc2VzdCIsImluc2VydEJlZm9yZSIsInByZXYiLCJpbnNlcnRBZnRlciIsImNsaWNrIiwid2luZG93Iiwic2V0VGltZW91dCIsIkFycmF5IiwicHJvdG90eXBlIiwiZm9yRWFjaCIsImNhbGwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWxlbWVudCIsIlBzIiwiaW5pdGlhbGl6ZSIsImNoaWxkcmVuIiwicmVhZHkiLCIkbWVudUl0ZW0iLCIkd3JhcHBlZExvZ28iLCIkY3VzdG9tSG9tZUxpbmsiLCIkYXBwTG9nbyIsIiRob21lTGluayIsImNsYXNzTmFtZSIsImFqYXgiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJtZW51TWFya3VwIiwid3JhcHBlcklkIiwiJG1lbnVNYXJrdXAiLCIkbWVudVdyYXBwZXIiLCJ3cmFwIiwiZmlyc3QiLCJ3cmFwSW5uZXIiLCJwcmVwZW5kIiwib2ZmIiwiYmVmb3JlIiwiJGVsZW1lbnQiLCIkYXJyb3ciLCJub3QiLCJob3ZlciIsIk11dGF0aW9uT2JzZXJ2ZXIiLCJXZWJLaXRNdXRhdGlvbk9ic2VydmVyIiwiTW96TXV0YXRpb25PYnNlcnZlciIsImZuIiwiYXR0cmNoYW5nZSIsImNhbGxiYWNrIiwib3B0aW9ucyIsInN1YnRyZWUiLCJhdHRyaWJ1dGVzIiwib2JzZXJ2ZXIiLCJtdXRhdGlvbnMiLCJvYnNlcnZlIiwiJGJvZHkiLCIkcG9wdXBDbG9uZSIsImJ1dHRvbk9mZnNldCIsIiRidXR0b24iLCIkcG9wdXAiLCJjbG9zZVBvcHVwUGFuZWxzIiwiY2xvbmUiLCJvZmZzZXQiLCJjc3MiLCJsZWZ0Iiwid2lkdGgiLCJvdXRlcldpZHRoIiwidG9wIiwib3V0ZXJIZWlnaHQiLCJhY3Rpb25JbmRleCIsImluZGV4IiwiaGFzQ2xhc3MiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEVBQUdDLEdBdURaLFNBQVNDLEVBQWlDQyxHQUNwQ0EsR0FBU0EsRUFBTUMsYUFBZUQsRUFBTUMsWUFBWUMsT0FBUyxFQUMzREwsRUFBRSxtQ0FBbUNNLEtBQUssZ0NBQWtDSCxFQUFNQyxZQUFZRyxLQUFLLE9BRW5HUCxFQUFFLG1DQUFtQ00sS0FBSyxJQTFEOUNOLEVBQUVRLFVBQ0NDLEdBQUcsVUFBVyxTQUFVQyxHQUN2QlYsRUFBRSxvQkFBb0JXLElBQUkscUJBQXNCLFdBQzlDLElBQUlDLEVBQVFaLEVBQUVhLE1BQU1DLEtBQUssUUFFSixJQUFqQkYsRUFBTVAsUUFDUk8sRUFBTUUsS0FBSyxTQUFTQyxLQUFLLFdBQ3ZCLElBQUlDLEVBQVNoQixFQUFFYSxN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TTJGLE9BekIvQixDQTZCRzlFLElBQUkxQjtDQ25CUCxTQUFXQSxHQUNULGFBQ0EsSUFBSThHLEVBQVE5RyxFQUFFLFFBRWQ4RyxFQUFNckcsR0FBRyxRQUFTLDhCQUErQixXQUMvQyxJQUFJc0csRUF5RUVDLEVBeEVGQyxFQUFVakgsRUFBRWEsTUFDWnFHLEVBQVNELEVBQVF4QyxTQUFTLFlBYzlCLFNBQVMwQyxJQUNQbkgsRUFBRSxpQkFBaUI4QixTQUNuQmdGLEVBQU14RixZQUFZLHFCQWJsQjZGLElBcUJBSixFQUFjRyxFQUFPRSxPQUFNLEdBQ3hCMUUsU0FBU29FLEdBQ1RyRixTQUFTLGdCQTZDUnVGLEVBQWVDLEVBQVFJLFNBRTNCTixFQUFZTyxLQUNWQyxNQUFPUCxFQUFhTyxNQUFRUixFQUFZUyxRQUFVUCxFQUFRUSxjQUMxREMsS0FBTVYsRUFBYVUsSUFBTVQsRUFBUVUsZ0JBRW5DWixFQUFZbEUsT0FDWmlFLEVBQU1yRixTQUFTLHFCQW5CZnNGLEVBQVlqRyxLQUFLLEtBQUtnRCxNQUFNLFdBQzFCLElBQUk4RCxFQUFjNUgsRUFBRWEsTUFBTXlCLFNBQVN1RixRQUVuQ1gsRUFBT3BHLEtBQUssVUFBWThHLEVBQWMsT0FBTzlELFVBeEIzQ21ELEVBQVE3RixLQUFLLHNCQUlqQjZGLEVBQVE3RixLQUFLLG9CQUFvQixHQUNqQzZGLEVBQVFYLFdBQVcsV0FFYlcsRUFBUWEsU0FBUyxxQkFJckJYLFNBeERSLENBd0ZHekYsSUFBSTFCIiwiZmlsZSI6ImhydWkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgkLCBfKSB7XG4gICQoZG9jdW1lbnQpXG4gICAgLm9uKCdjcm1Mb2FkJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICQoJy5jcm0taW5saW5lLWVkaXQnKS5vbmUoJ0RPTVN1YnRyZWVNb2RpZmllZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyICRmb3JtID0gJCh0aGlzKS5maW5kKCdmb3JtJyk7XG5cbiAgICAgICAgaWYgKCRmb3JtLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICRmb3JtLmZpbmQoJ2xhYmVsJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJGxhYmVsID0gJCh0aGlzKTtcbiAgICAgICAgICAgIHZhciBpZCA9ICRsYWJlbC5hdHRyKCdmb3InKTtcbiAgICAgICAgICAgICQoJyMnICsgaWQpLmF0dHIoJ3BsYWNlaG9sZGVyJywgJGxhYmVsLnRleHQoKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLm9uKCd1cGRhdGVDb250YWN0SGVhZGVyJywgZnVuY3Rpb24gKGUsIGRhdGEpIHtcbiAgICAgIGlmICh0eXBlb2YgZGF0YS5jb250cmFjdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdXBkYXRlQ29udGFjdEhlYWRlckNvbnRyYWN0RGV0YWlscyhkYXRhLmNvbnRyYWN0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBkYXRhLnJvbGVzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB1cGRhdGVDb250YWN0SGVhZGVyUm9sZXNEZXRhaWxzKGRhdGEucm9sZXMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250YWN0IGhlYWRlciB3aXRoIHRoZSBnaXZlbiBjb250cmFjdCBkZXRhaWxzXG4gICAqXG4gICAqIEBwYXJhbSAge29iamVjdH0gY29udHJhY3RcbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMgKGNvbnRyYWN0KSB7XG4gICAgaWYgKGNvbnRyYWN0KSB7XG4gICAgICAkKCcuY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2snKS5yZW1vdmVDbGFzcygnY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2std2l0aG91dC1jb250cmFjdCcpO1xuXG4gICAgICBpZiAoY29udHJhY3QucG9zaXRpb24pIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1wb3NpdGlvbicpLmh0bWwoJzxzdHJvbmc+UG9zaXRpb246PC9zdHJvbmc+ICcgKyBjb250cmFjdC5wb3NpdGlvbik7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb250cmFjdC5sb2NhdGlvbikge1xuICAgICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWxvY2F0aW9uJykuaHRtbCgnPHN0cm9uZz5Ob3JtYWwgcGxhY2Ugb2Ygd29yazo8L3N0cm9uZz4gJyArIGNvbnRyYWN0LmxvY2F0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJCgnLmNybS1zdW1tYXJ5LWNvbnRhY3RuYW1lLWJsb2NrJykuYWRkQ2xhc3MoJ2NybS1zdW1tYXJ5LWNvbnRhY3RuYW1lLWJsb2NrLXdpdGhvdXQtY29udHJhY3QnKTtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtcG9zaXRpb24nKS5odG1sKCcnKTtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtbG9jYXRpb24nKS5odG1sKCcnKTtcblxuICAgICAgdXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyhudWxsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY29udGFjdCBoZWFkZXIgd2l0aCB0aGUgZ2l2ZW4gcm9sZXMgZGV0YWlsc1xuICAgKlxuICAgKiBAcGFyYW0gIHtvYmplY3R9IGNvbnRyYWN0XG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVDb250YWN0SGVhZGVyUm9sZXNEZXRhaWxzIChyb2xlcykge1xuICAgIGlmIChyb2xlcyAmJiByb2xlcy5kZXBhcnRtZW50cyAmJiByb2xlcy5kZXBhcnRtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWRlcGFydG1lbnRzJykuaHRtbCgnPHN0cm9uZz5EZXBhcnRtZW50Ojwvc3Ryb25nPiAnICsgcm9sZXMuZGVwYXJ0bWVudHMuam9pbignLCAnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtZGVwYXJ0bWVudHMnKS5odG1sKCcnKTtcbiAgICB9XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIvKiBnbG9iYWwgUHMgKi9cblxuLy8gQ29weXJpZ2h0IENpdmlDUk0gTExDIDIwMTMuIFNlZSBodHRwOi8vY2l2aWNybS5vcmcvbGljZW5zaW5nXG4oZnVuY3Rpb24gKCQsIF8pIHtcbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NybUxvYWQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgYWRkVXBsb2FkRmlsZUxpc3RlbmVyKFwiaW5wdXRbdHlwZT0nZmlsZSddXCIpO1xuICAgICAgYW1lbmRWYWNhbmN5Rm9ybSgpO1xuICAgICAgYW1lbmRDb250YWN0UGFnZUFuZEZvcm0oZSk7XG4gICAgICBhcHBseU1pc2NDaGFuZ2VzKCk7XG4gICAgICBjaGFuZ2VDb250YWN0U291cmNlRmllbGRIZWxwVGV4dCgpO1xuICAgIH0pXG4gICAgLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgIGFkZFVzZXJNZW51VG9NYWluTWVudSgpO1xuICAgICAgYW1lbmRBcHBMb2dvTWVudUl0ZW0oKTtcbiAgICAgIGFtZW5kQXBwbGljYXRpb25Gb3JtKCk7XG4gICAgICB1c2VGb250QXdlc29tZUFycm93c0luU3ViTWVudUl0ZW1zKCk7XG4gICAgICB0b2dnbGVBY3RpdmVDbGFzc09uSG92ZXJPbkFueU1haW5NZW51SXRlbSgpO1xuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBDdXN0b21pemVzIHRoZSBhcHAgbG9nbyBtZW51IGl0ZW0sIHN3aXRjaGluZyBmcm9tIHRoZSBDaXZpQ1JNIGxvZ29cbiAgICogdG8gdGhlIENpdmlIUiBsb2dvLCBhbmQgbWFraW5nIHRoZSBpdGVtIGEgZGlyZWN0IGxpbmsgaW5zdGVhZCBvZiBhXG4gICAqIHRvZ2dsZSBmb3IgYSBzdWIgbWVudSBkcm9wZG93blxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRBcHBMb2dvTWVudUl0ZW0gKCkge1xuICAgIHZhciAkbWVudUl0ZW0gPSAkKCcuY3JtLWxpbmstaG9tZScpO1xuICAgIHZhciAkd3JhcHBlZExvZ28gPSBzd2FwQW5kV3JhcEFwcExvZ28oJG1lbnVJdGVtKTtcbiAgICB2YXIgJGN1c3RvbUhvbWVMaW5rID0gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSgkbWVudUl0ZW0sICR3cmFwcGVkTG9nbyk7XG5cbiAgICByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsoJG1lbnVJdGVtLCAkY3VzdG9tSG9tZUxpbmspO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIHVzZXIgbWVudSBieSBmZXRjaGluZyBpdCBmcm9tIHRoZSBocmNvcmUgZXh0ZW5zaW9uXG4gICAqL1xuICBmdW5jdGlvbiBhZGRVc2VyTWVudVRvTWFpbk1lbnUgKCkge1xuICAgICQuYWpheCgnL2Npdmljcm0vaHJjb3JlL3VzZXJtZW51P3NuaXBwZXQ9NCcsIHtcbiAgICAgIGRhdGFUeXBlOiAnaHRtbCcsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAobWVudU1hcmt1cCkge1xuICAgICAgICBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlcihtZW51TWFya3VwLCAnY2l2aWhyLW1lbnUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgb24gaW5wdXRbdHlwZT1cImZpbGVcIl1cbiAgICogQHBhcmFtIHtqUXVlcnkgT2JqZWN0fSBzZWxlY3RvciBbc2VsZWN0b3IgZnJvbSBpbnB1dCBmaWxlXVxuICAgKi9cbiAgZnVuY3Rpb24gYWRkVXBsb2FkRmlsZUxpc3RlbmVyIChzZWxlY3Rvcikge1xuICAgIGlmICgkKHNlbGVjdG9yKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICQoc2VsZWN0b3IpLm9uKCdjaGFuZ2UnLCBpbnNlcnRGaWxlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSBhcHBsaWNhdGlvbiBmb3JtXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZEFwcGxpY2F0aW9uRm9ybSAoKSB7XG4gICAgJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fQXBwbGljYXRpb24nKS5hZGRDbGFzcygnY3JtLWZvcm0tYmxvY2snKTtcbiAgICAkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9BcHBsaWNhdGlvbiAuY3JtLXByb2ZpbGUtbmFtZS1hcHBsaWNhdGlvbl9wcm9maWxlJykuYWRkQ2xhc3MoJ2Zvcm0tbGF5b3V0LWNvbXByZXNzZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIGNvbnRhY3QgcGFnZSBhbmQgdGhlIGNvbnRhY3QgZm9ybVxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRDb250YWN0UGFnZUFuZEZvcm0gKGUpIHtcbiAgICBpZiAoQ1JNLmZvcm1OYW1lID09PSAnY29udGFjdEZvcm0nIHx8IENSTS5wYWdlTmFtZSA9PT0gJ3ZpZXdTdW1tYXJ5Jykge1xuICAgICAgLy8gUmVuYW1lIFwiU3VtbWFyeVwiIHRhYiB0byBcIlBlcnNvbmFsIERldGFpbHNcIlxuICAgICAgLy8gSGFjayB0byBjaGVjayBjb250YWN0IHR5cGUgLSBUaGlzIGZpZWxkIG9ubHkgYXBwZWFycyBmb3IgaW5kaXZpZHVhbHNcbiAgICAgIGlmICgkKCcuY3JtLWNvbnRhY3Qtam9iX3RpdGxlJywgJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpLmxlbmd0aCkge1xuICAgICAgICAkKCcuY3JtLWNvbnRhY3QtdGFicy1saXN0ICN0YWJfc3VtbWFyeSBhJywgZS50YXJnZXQpLnRleHQoJ1BlcnNvbmFsIERldGFpbHMnKTtcbiAgICAgIH1cblxuICAgICAgbWFuaXB1bGF0ZURPTU9mSW5saW5lQ3VzdG9tRGF0YShlLnRhcmdldCk7XG4gICAgICBtaXNjQ29udGFjdFBhZ2VDaGFuZ2VzKGUudGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSB2YWNhbmN5IGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIGFtZW5kVmFjYW5jeUZvcm0gKCkge1xuICAgIGlmICgkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3knKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0KCQoJ2xhYmVsW2Zvcj1cInN0YXJ0X2RhdGVcIl0nKS5wYXJlbnRzKCd0cicpKTtcbiAgICAgIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0KCQoJ2xhYmVsW2Zvcj1cImVuZF9kYXRlXCJdJykucGFyZW50cygndHInKSk7XG5cbiAgICAgIC8vIEFkZCBhIGNsYXNzIHRvIGlkZW50aWZ5IHRoZSBmb3JtICdOZXcgVmFjYW5jeSBUZW1wbGF0ZSdcbiAgICAgIGlmICgkKCdbbmFtZT1cImVudHJ5VVJMXCJdJykudmFsKCkuaW5kZXhPZignO3RlbXBsYXRlPTEnKSA+IC0xKSB7XG4gICAgICAgICQoJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fSFJWYWNhbmN5IHRib2R5JykuZ2V0KDApKS5hZGRDbGFzcygnQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3lfVGVtcGxhdGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXBwbGllcyBtaXNjZWxsYW5lb3VzIFVJIGNoYW5nZXNcbiAgICovXG4gIGZ1bmN0aW9uIGFwcGx5TWlzY0NoYW5nZXMgKCkge1xuICAgICQoJyNhY3Rpdml0eUN1c3RvbURhdGEnKS5hdHRyKCdjb2xzcGFuJywgMyk7XG4gICAgJCgnI2NybS1hY3Rpdml0eS12aWV3LXRhYmxlIC5jcm0tY2FzZS1hY3Rpdml0eS12aWV3LUNsaWVudCAubGFiZWwnKS5odG1sKCdDb250YWN0Jyk7XG4gICAgJCgnc3Bhbi5jcm0tZnJvemVuLWZpZWxkJywgJy5jcm0tcHJvZmlsZS1uYW1lLWhyaWRlbnRfdGFiJykuY2xvc2VzdCgnZGl2JykucGFyZW50KCdkaXYnKS5oaWRlKCk7XG5cbiAgICAkKCcuY3JtLWFjY29yZGlvbi1oZWFkZXIuY3JtLW1hc3Rlci1hY2NvcmRpb24taGVhZGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saXN0aW5nLWJveCcpLCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgIFBzLmluaXRpYWxpemUoZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgMCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hhbmdlcyBvZiBzb3JjZSBoZWxwIHRleHRcbiAgICovXG4gIGZ1bmN0aW9uIGNoYW5nZUNvbnRhY3RTb3VyY2VGaWVsZEhlbHBUZXh0ICgpIHtcbiAgICAkKCdJTlBVVCNjb250YWN0X3NvdXJjZScpLnBhcmVudCgndGQnKS5jaGlsZHJlbignYScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAgLm5vdGlmeS1jb250ZW50JykucmVtb3ZlKCk7XG5cbiAgICAgIGlmICgkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwIHAnKS5sZW5ndGgpIHtcbiAgICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCBwJykucmVtb3ZlKCk7XG4gICAgICB9XG5cbiAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAnKS5hcHBlbmQoJzxwPlNvdXJjZSBpcyBhIHVzZWZ1bCBmaWVsZCB3aGVyZSBkYXRhIGhhcyBiZWVuIG1pZ3JhdGVkIHRvIENpdmlIUiBmcm9tIG9uZSBvciBhIG51bWJlciBvZiBvdGhlciBsZWdhY3kgc3lzdGVtcy4gVGhlIFNvdXJjZSBmaWVsZCB3aWxsIGluZGljYXRlIHdoaWNoIGxlZ2FjeSBzeXN0ZW0gdGhlIGNvbnRhY3QgaGFzIGNvbWUgZnJvbS48L3A+Jyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIG9yaWdpbmFsIGxpbmsgdG8gdGhlIGhvbWVwYWdlLCBjaGFuZ2VzIHRoZSB0ZXh0LCB3cmFwcyBpdCBpbiBhXG4gICAqIGBtZW51bWFpbi1sYWJlbGAgZWxlbWVudCBhbmQgcHJlcGVuZHMgaW50ZXJuYWxseSB0aGUgZ2l2ZW4gYXBwIGxvZ29cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICRtZW51SXRlbSBUaGUgY29udGV4dCB3aGVyZSB0byBmaW5kIHRoZSBsaW5rXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkYXBwTG9nb1xuICAgKiBAcmV0dXJuIHRoZSBjdXN0b21pemVkIGhvbWUgbGlua1xuICAgKi9cbiAgZnVuY3Rpb24gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSAoJG1lbnVJdGVtLCAkYXBwTG9nbykge1xuICAgIHZhciAkaG9tZUxpbmsgPSAkKCdsaSA+IGEnLCAkbWVudUl0ZW0pLmZpcnN0KCk7XG5cbiAgICByZXR1cm4gJGhvbWVMaW5rXG4gICAgICAudGV4dCgnSG9tZScpXG4gICAgICAud3JhcElubmVyKCc8c3BhbiBjbGFzcz1cIm1lbnVtYWluLWxhYmVsXCI+JylcbiAgICAgIC5wcmVwZW5kKCRhcHBMb2dvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmplY3RzIHRoZSBnaXZlbiBtYXJrdXAgaW4gYSBtZW51IHdyYXBwZXIgd2l0aCB0aGUgZ2l2ZW4gaWRcbiAgICogY3JlYXRlZCB0byBjb250YWluIGJvdGggdGhlIG9yaWdpbmFsIG1lbnUgYW5kIHRoZSB1c2VyIG9uZVxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVudU1hcmt1cFxuICAgKiBAcGFyYW0ge3N0cmluZ30gd3JhcHBlcklkXG4gICAqL1xuICBmdW5jdGlvbiBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlciAobWVudU1hcmt1cCwgd3JhcHBlcklkKSB7XG4gICAgdmFyICRtZW51TWFya3VwID0gJChtZW51TWFya3VwKTtcbiAgICB2YXIgJG1lbnVXcmFwcGVyID0gJCgnPGRpdj4nKTtcblxuICAgICRtZW51V3JhcHBlci5hdHRyKCdpZCcsIHdyYXBwZXJJZCk7XG4gICAgJG1lbnVXcmFwcGVyLmFwcGVuZCgkKCcjY2l2aWNybS1tZW51JykpO1xuICAgICRtZW51V3JhcHBlci5hcHBlbmQoJG1lbnVNYXJrdXApO1xuICAgICRtZW51V3JhcHBlci5pbnNlcnRBZnRlcignI3BhZ2UnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnNlcnQgYSBET00gbm9kZSBhZnRlciBpbnB1dFt0eXBlPVwiZmlsZVwiXVxuICAgKiB3aXRoIHRoZSBmaWxlbmFtZVxuICAgKi9cbiAgZnVuY3Rpb24gaW5zZXJ0RmlsZSAoKSB7XG4gICAgdmFyIGZpbGVOYW1lID0gJCh0aGlzKVswXS5maWxlc1swXTtcblxuICAgICQoJyNqcy11cGxvYWRlZC1maWxlJykucmVtb3ZlKCk7XG4gICAgaWYgKGZpbGVOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICQodGhpcykuYWZ0ZXIoJzxzcGFuIGlkPVwianMtdXBsb2FkZWQtZmlsZVwiIGNsYXNzPVwidXBsb2FkZWQtZmlsZVwiPicgKyBmaWxlTmFtZS5uYW1lICsgJyA8c3BhbiBjbGFzcz1cInVwbG9hZGVkLWZpbGUtaWNvbi10cmFzaFwiPjxpIGNsYXNzPVwiZmEgZmEtdHJhc2gtb1wiPjwvaT4gUmVtb3ZlPC9zcGFuPicpO1xuXG4gICAgICAkKCcudXBsb2FkZWQtZmlsZS1pY29uLXRyYXNoJykub24oJ2NsaWNrJywgcmVtb3ZlRmlsZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBsYWJlbCAnZm9yJyBhdHRyIHRvIHdvcmtzIHdpdGggdGhlIGRhdGVwaWNrZXJcbiAgICpcbiAgICogQHBhcmFtICB7alF1ZXJ5IG9iamVjdH0gJGxpbmUgW2RhdGVwaWNrZXIncyBsaW5lIHBhcmVudF1cbiAgICovXG4gIGZ1bmN0aW9uIGxpbmtMYWJlbFRvRGF0ZXBpY2tlcklucHV0ICgkbGluZSkge1xuICAgICRsaW5lLmZpbmQoJ2xhYmVsJykuYXR0cignZm9yJywgJGxpbmUuZmluZCgnLmNybS1mb3JtLWRhdGUnKS5hdHRyKCdpZCcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYW5pcHVsYXRlcywgYXQgdGhlIERPTSBsZXZlbCwgdGhlIGJsb2Nrcy9maWVsZHMgYmVsb25naW5nIHRvIHRoZVxuICAgKiBJbmxpbmUgQ3VzdG9tIERhdGEgY3VzdG9tIGZpZWxkcyBzZXRcbiAgICovXG4gIGlmICgkKCcuSW5saW5lX0N1c3RvbV9EYXRhJykubGVuZ3RoKSB7XG4gICAgcmVwb3NpdGlvblBlcnNvbmFsRGV0YWlsc0Jsb2NrKCcuSW5saW5lX0N1c3RvbV9EYXRhJyk7XG4gIH1cblxuICByZXBvc2l0aW9uUGVyc29uYWxEZXRhaWxzQmxvY2soJy5FeHRlbmRlZF9EZW1vZ3JhcGhpY3MnKTtcblxuICBmdW5jdGlvbiBtYW5pcHVsYXRlRE9NT2ZJbmxpbmVDdXN0b21EYXRhICgpIHtcbiAgICBpZiAoJCgnI2N1c3RvbUZpZWxkcycpLmxlbmd0aCA8IDEpIHtcbiAgICAgIHJlcG9zaXRpb25JbmxpbmVDdXN0b21EYXRhRmllbGRzSW5FZGl0Q29udGFjdEZvcm0oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWlzYyBjaGFuZ2VzIHRvIHRoZSBwYWdlIChoaWRpbmcgZWxlbWVudHMsIGluc2VydGluZyBuZXcgb25lcywgZXRjKVxuICAgKi9cbiAgZnVuY3Rpb24gbWlzY0NvbnRhY3RQYWdlQ2hhbmdlcyAodGFyZ2V0KSB7XG4gICAgLy8gSGlkZSBjdXJyZW50IGVtcGxveWVyIGFuZCBqb2IgdGl0bGVcbiAgICAvLyBDb250YWN0IHN1bW1hcnkgc2NyZWVuOlxuICAgICQoJ2Rpdi5jcm0tY29udGFjdC1jdXJyZW50X2VtcGxveWVyLCBkaXYuY3JtLWNvbnRhY3Qtam9iX3RpdGxlJywgJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpLnBhcmVudCgnZGl2LmNybS1zdW1tYXJ5LXJvdycpLmhpZGUoKTtcbiAgICAvLyBJbmxpbmUgZWRpdCBmb3JtXG4gICAgJCgnZm9ybSNDb250YWN0SW5mbyBpbnB1dCNlbXBsb3llcl9pZCwgZm9ybSNDb250YWN0SW5mbyBpbnB1dCNqb2JfdGl0bGUnLCB0YXJnZXQpLmNsb3Nlc3QoJ2Rpdi5jcm0tc3VtbWFyeS1yb3cnKS5oaWRlKCk7XG4gICAgLy8gQ29udGFjdCBlZGl0IHNjcmVlblxuICAgICQoJ2lucHV0I2VtcGxveWVyX2lkLCBpbnB1dCNqb2JfdGl0bGUnLCAnZm9ybSNDb250YWN0JykucGFyZW50KCd0ZCcpLmhpZGUoKTtcblxuICAgIC8qIENoYW5nZXMgb24gQWRkIEluZGl2aWR1YWwgcGFnZXMgYW5kIFBlcnNvbmFsIGRldGFpbHMgdGFiIGZvciBIUi0zNTggKi9cbiAgICAvLyBNb3ZlIEpvYiBzdW1tYXJ5IHRvIHRvcFxuICAgICQoJy5IUkpvYkNvbnRyYWN0X1N1bW1hcnknLCB0YXJnZXQpLmluc2VydEJlZm9yZSgkKCcuY3JtLXN1bW1hcnktY29udGFjdGluZm8tYmxvY2snKSk7XG4gICAgLy8gY2hhbmdlcyBvZiBlbWFpbCBibG9jaywgcmVtb3ZlIGJ1bGttYWlsIGFuZCBvbmhvbGRcbiAgICAkKCdkaXYuZW1haWwtc2lnbmF0dXJlLCB0ZCNFbWFpbC1CdWxrbWFpbC1odG1sJywgJ2Zvcm0jQ29udGFjdCcpLmhpZGUoKTtcbiAgICAkKCcjRW1haWwtUHJpbWFyeScsICdmb3JtI0NvbnRhY3QnKS5wcmV2KCd0ZCcpLnByZXYoJ3RkJykuaGlkZSgpO1xuICAgICQoJ3RkI0VtYWlsLUJ1bGttYWlsLWh0bWwsICNFbWFpbC1QcmltYXJ5JywgJ2Zvcm0jQ29udGFjdCcpLnByZXYoJ3RkJykuaGlkZSgpO1xuXG4gICAgLy8gc2hpZnQgZGVtb2dyYXBoaWMgYWJvdmUgZXh0ZW5kZWQgZGVtb2dyYXBoaWNcbiAgICAkKCcuY3JtLWRlbW9ncmFwaGljcy1hY2NvcmRpb24nLCAnZm9ybSNDb250YWN0JykuaW5zZXJ0QWZ0ZXIoJCgnLmNybS1jb250YWN0RGV0YWlscy1hY2NvcmRpb24nKSk7XG5cbiAgICBpZiAoJCgndHIjUGhvbmVfQmxvY2tfMicsICdmb3JtI0NvbnRhY3QnKS5sZW5ndGggPCAxKSB7XG4gICAgICAkKCcjYWRkUGhvbmUnKS5jbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlICNqcy11cGxvYWRlZC1maWxlIERJViBhbmRcbiAgICogY2xlYW4gaW5wdXRbdHlwZT1cImZpbGVcIl0gdmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIHJlbW92ZUZpbGUgKCkge1xuICAgIHZhciAkaW5wdXQgPSAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnBhcmVudCgpLmZpbmQoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnJlbW92ZSgpO1xuICAgICRpbnB1dC52YWwoJycpO1xuICB9XG5cbiAgLyoqXG4gICAqIE1vdmVzIHRoZSBnaXZlbiBob21lIGxpbmsgcmlnaHQgdW5kZXIgdGhlIG1lbnUgaXRlbSBhbmQgZ2V0cyByaWRcbiAgICogb2YgdGhlIG9yaWdpbmFsIHN1YiBtZW51XG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbGlua1xuICAgKiBAcGFyYW0ge29iamVjdH0gJGhvbWVMaW5rXG4gICAqL1xuICBmdW5jdGlvbiByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsgKCRtZW51SXRlbSwgJGhvbWVMaW5rKSB7XG4gICAgJG1lbnVJdGVtXG4gICAgICAub2ZmKCkgLy8gcmVtb3ZlcyBhbnkgaGFuZGxlciB0aGF0IHRoZSBvcmlnaW5hbCBpdGVtIGhhZFxuICAgICAgLmZpbmQoJyNjaXZpY3JtLWhvbWUnKVxuICAgICAgLmJlZm9yZSgkaG9tZUxpbmspXG4gICAgICAucmVtb3ZlKCk7XG4gIH1cblxuICAvKipcbiAgICogTW92ZXMgdGhlIFwiSW5saW5lIEN1c3RvbSBEYXRhXCIgZmllbGRzIHRvd2FyZHMgdGhlIHRvcCBvZiB0aGVcbiAgICogZWRpdCBjb250YWN0IGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIHJlcG9zaXRpb25JbmxpbmVDdXN0b21EYXRhRmllbGRzSW5FZGl0Q29udGFjdEZvcm0gKCkge1xuICAgIHZhciAkZmllbGRzID0gJCgnI0lubGluZV9DdXN0b21fRGF0YScpLmRldGFjaCgpO1xuXG4gICAgJGZpZWxkcy5maW5kKCcubGFiZWwnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciAkbGFiZWxDZWxsID0gJCh0aGlzKTtcbiAgICAgIHZhciAkZmllbGRDZWxsID0gJGxhYmVsQ2VsbC5uZXh0KCk7XG4gICAgICB2YXIgJG5ld1RkID0gJCgnPHRkLz4nKTtcblxuICAgICAgJG5ld1RkLmFwcGVuZCgkbGFiZWxDZWxsLmZpbmQoJ2xhYmVsJykpO1xuICAgICAgJG5ld1RkLmFwcGVuZCgkKCc8YnIvPicpKTtcbiAgICAgICRuZXdUZC5hcHBlbmQoJGZpZWxkQ2VsbC5odG1sKCkpO1xuXG4gICAgICAkKCcjbmlja19uYW1lJykucGFyZW50KCkuYWZ0ZXIoJG5ld1RkKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNb3ZlcyB0aGUgc3BlY2lmaWVkIHNlbGVjdG9yIGVsZW1lbnQgdG8gdGhlIHBlcnNvbmFsIGRldGFpbHMgdGFiXG4gICAqXG4gICAqIEBwYXJhbSBzZWxlY3RvclxuICAgKi9cbiAgZnVuY3Rpb24gcmVwb3NpdGlvblBlcnNvbmFsRGV0YWlsc0Jsb2NrIChzZWxlY3Rvcikge1xuICAgICQoc2VsZWN0b3IpXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2NybS1jb2xsYXBzaWJsZSBjb2xsYXBzZWQnKVxuICAgICAgLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1ibG9jaycpXG4gICAgICAuYXBwZW5kVG8oJy5jb250YWN0VG9wQmFyIC5jb250YWN0Q2FyZExlZnQnKVxuICAgICAgLmZpbmQoJy5jb2xsYXBzaWJsZS10aXRsZScpLmhpZGUoKS5lbmQoKVxuICAgICAgLmZpbmQoJy5jcm0tc3VtbWFyeS1ibG9jaycpLnNob3coKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTd2FwcyB0aGUgQ2l2aUNSTSBsb2dvIHdpdGggdGhlIENpdmlIUiBsb2dvXG4gICAqIGFuZCB3cmFwcyBpdCBpbiBhIGBtZW51bWFpbi1pY29uYCBlbGVtZW50XG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbG9nb1xuICAgKiBAcmV0dXJuIHRoZSB3cmFwcGVyIG9mIHRoZSBsb2dvXG4gICAqL1xuICBmdW5jdGlvbiBzd2FwQW5kV3JhcEFwcExvZ28gKCRtZW51SXRlbSkge1xuICAgIHZhciAkYXBwTG9nbyA9ICQoJy5jcm0tbG9nby1zbScsICRtZW51SXRlbSk7XG5cbiAgICByZXR1cm4gJGFwcExvZ29cbiAgICAgIC5hZGRDbGFzcygnY2hyX2xvZ28gY2hyX2xvZ28tLWRlZmF1bHQtY29sb3InKVxuICAgICAgLnJlbW92ZUNsYXNzKCdjcm0tbG9nby1zbScpXG4gICAgICAud3JhcCgnPHNwYW4gY2xhc3M9XCJtZW51bWFpbi1pY29uXCI+JylcbiAgICAgIC5wYXJlbnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaXZpQ1JNIGJ5IGRlZmF1bHQgYXBwbGllcyBvbiBob3ZlciB0aGUgLmFjdGl2ZXRhcmdldCBjbGFzc1xuICAgKiBvbmx5IHRvIG1haW4gbWVudSBpdGVtcyB3aXRoIGEgc3VibWVudVxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBtYWtlcyBzdXJlIHRoYXQgYW55IGl0ZW0gZ2V0cyB0aGUgY2xhc3MgYXBwbGllZCxcbiAgICogZXZlbiB0aG9zZSB3aXRoIGp1c3QgYSBkaXJlY3QgbGlua1xuICAgKi9cbiAgZnVuY3Rpb24gdG9nZ2xlQWN0aXZlQ2xhc3NPbkhvdmVyT25BbnlNYWluTWVudUl0ZW0gKCkge1xuICAgIHZhciBjbGFzc05hbWUgPSAnYWN0aXZldGFyZ2V0JztcblxuICAgICQoJy5tZW51bWFpbicpLm5vdCgnLmNybS1TZWxmX1NlcnZpY2VfUG9ydGFsJykuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGFycm93IGZvciBtZW51IGl0ZW1zIHdpdGggc3ViLWl0ZW1zLCBhbmQgcmVwbGFjZXMgaXRcbiAgICogd2l0aCBhIGZvbnQgYXdlc29tZSBjYXJldFxuICAgKi9cbiAgZnVuY3Rpb24gdXNlRm9udEF3ZXNvbWVBcnJvd3NJblN1Yk1lbnVJdGVtcyAoKSB7XG4gICAgJCgnI3Jvb3QtbWVudS1kaXYgLm1lbnUtaXRlbS1hcnJvdycpLmVhY2goZnVuY3Rpb24gKCRlbGVtZW50KSB7XG4gICAgICB2YXIgJGFycm93ID0gJCh0aGlzKTtcblxuICAgICAgJGFycm93LmJlZm9yZSgnPGkgY2xhc3M9XCJmYSBmYS1jYXJldC1yaWdodCBtZW51LWl0ZW0tYXJyb3dcIj48L2k+Jyk7XG4gICAgICAkYXJyb3cucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIoZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgTXV0YXRpb25PYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5Nb3pNdXRhdGlvbk9ic2VydmVyO1xuXG4gIC8qXG4gIFRoaXMgcGx1Z2luIGNyZWF0ZXMgTXV0YXRpb25PYnNlcnZlciB3aGljaCBsaXN0ZW5zIHRvIGFsbCBjaGFuZ2VzIHRvIERPTSBOb2RlLlxuICBJZiBjaGFuZ2UgaGFzIGJlZW4gZG9uZSB0byBpdCdzIGF0dHJpYnV0ZXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQuXG5cbiAgQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB0byBiZSBjYWxsZWQgd2hlbiBhdHRyaWJ1dGVzIGNoYW5nZVxuICBAcmV0dXJucyB7QXJyYXl9IC0gbGlzdCBvZiBhbGwgb2JzZXJ2ZWQgZWxlbWVudHNcbiAgKi9cbiAgJC5mbi5hdHRyY2hhbmdlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBzdWJ0cmVlOiBmYWxzZSxcbiAgICAgICAgYXR0cmlidXRlczogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwoZS50YXJnZXQsIGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLCBvcHRpb25zKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoQ1JNLiQpO1xuIiwiLyogZ2xvYmFscyBDUk0gKi9cblxuLyoqXG4gKiBIZWxwcyB0byBkaXNwbGF5IHBvcHVwIG1lbnVzIGluc2lkZSAjYm9vdHN0cmFwLXRoZW1lIGVsZW1lbnRzLCBzaW5jZSAucGFuZWwnc1xuICogYW5kIG90aGVyIEJvb3RzdHJhcCBlbGVtZW50cyBjbGFzaCB3aXRoIENpdmlDUk0gc3R5bGVzIHByb2R1Y2luZyB1bmRlc2lyZWRcbiAqIHJlc3VsdHMuXG4gKlxuICogSXQgYWxzbyBoZWxwcyB3aXRoIGV2ZW50IGJpbmRpbmdzLCBpbiBjYXNlIHRoZSBvcmlnaW5hbCBwb3B1cCBidXR0b24gd2FzXG4gKiByZW1vdmVkIGFuZCByZWNyZWF0ZWQsIGJ5IGZvcndhcmRpbmcgdGhlIGV2ZW50cyB0byB0aGUgb3JpZ2luYWwgc291cmNlLlxuICovXG4oZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7XG5cbiAgJGJvZHkub24oJ2NsaWNrJywgJyNib290c3RyYXAtdGhlbWUgLmJ0bi1zbGlkZScsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHBvcHVwQ2xvbmU7XG4gICAgdmFyICRidXR0b24gPSAkKHRoaXMpO1xuICAgIHZhciAkcG9wdXAgPSAkYnV0dG9uLmNoaWxkcmVuKCd1bC5wYW5lbCcpO1xuXG4gICAgKGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgY2xvc2VQb3B1cFBhbmVscygpO1xuICAgICAgY3JlYXRlUG9wdXBDbG9uZSgpO1xuICAgICAgb3BlblBvcHVwQ2xvbmUoKTtcbiAgICAgIG1hcENsb25lQ2xpY2tFdmVudHNUb09yaWdpbigpO1xuICAgICAgbGlzdGVuVG9Nb3VzZU91dEV2ZW50KCk7XG4gICAgfSkoKTtcblxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgYW55IHBvcHVwIHBhbmVsIHRoYXQgaXMgY3VycmVudGx5IG9wZW4gYW5kIHJlbW92ZXMgdGhlXG4gICAgICogYC5jaXZpaHItcG9wdXAtb3BlbmAgY2xhc3MgZnJvbSB0aGUgYm9keS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9zZVBvcHVwUGFuZWxzICgpIHtcbiAgICAgICQoJy5jaXZpaHItcG9wdXAnKS5yZW1vdmUoKTtcbiAgICAgICRib2R5LnJlbW92ZUNsYXNzKCdjaXZpaHItcG9wdXAtb3BlbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjbG9uZSBvZiB0aGUgcG9wdXAgZWxlbWVudCBhbmQgYXBwZW5kcyBpdCB0byB0aGUgZG9jdW1lbnQgYm9keS5cbiAgICAgKiBUaGlzIHByZXZlbnRzIHRoZSBwb3B1cCB0byBiZSBoaWRkZW4gYnkgYW55IGBvdmVyZmxvdzogaGlkZGVuO2AgcnVsZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVQb3B1cENsb25lICgpIHtcbiAgICAgICRwb3B1cENsb25lID0gJHBvcHVwLmNsb25lKHRydWUpXG4gICAgICAgIC5hcHBlbmRUbygkYm9keSlcbiAgICAgICAgLmFkZENsYXNzKCdjaXZpaHItcG9wdXAnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMaXN0ZW5zIHRvIG1vdXNlIGV2ZW50cyBoYXBwZW5pbmcgb3V0c2lkZSB0aGUgb2YgdGhlIHBhbmVsIGluIG9yZGVyIHRvXG4gICAgICogY2xvc2UgaXQuIFRoZSB3YXkgdG8gZGV0ZWN0ZWQgbW91c2Ugb3V0IGlzIGJ5IGxpc3RlbmluZyB0byB0aGVcbiAgICAgKiAuYnRuLXNsaWRlLWFjdGl2ZSBjbGFzcyBjaGFuZ2UsIHdoaWNoIGlzIGFkZGVkIGFuZCByZW1vdmVkIGJ5IENpdmlDUk0uXG4gICAgICogdGhlIGRhdGEgKmF0dHJjaGFuZ2UtaXMtb24qIGlzIHNldCB0byB0cnVlIGluIG9yZGVyIHRvIGF2b2lkIGFkZGluZ1xuICAgICAqIG11bHRpcGxlIGxpc3RlbmVycyB0byB0aGUgc2FtZSBlbGVtZW50LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpc3RlblRvTW91c2VPdXRFdmVudCAoKSB7XG4gICAgICAvLyBJZiBBdHRyQ2hhbmdlIGV2ZW50IGlzIGFscmVhZHkgbGlzdGVuZWQsIHRoZW4gc2tpcDpcbiAgICAgIGlmICgkYnV0dG9uLmRhdGEoJ2F0dHJjaGFuZ2UtaXMtb24nKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgICRidXR0b24uZGF0YSgnYXR0cmNoYW5nZS1pcy1vbicsIHRydWUpO1xuICAgICAgJGJ1dHRvbi5hdHRyY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSWYgYnV0dG9uIGlzIGFscmVhZHkgb3BlbiwgdGhlbiBza2lwOlxuICAgICAgICBpZiAoJGJ1dHRvbi5oYXNDbGFzcygnYnRuLXNsaWRlLWFjdGl2ZScpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xvc2VQb3B1cFBhbmVscygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFwcyBjbGljayBldmVudHMgb24gdGhlIHBvcHVwIG9wdGlvbnMgYmFjayB0byB0aGVpciBvcmlnaW5hbCBzb3VyY2UuXG4gICAgICogVGhpcyBpcyBkb25lIGJlY2F1c2UgcG9wdXAgYWN0aW9ucyBhcmUgZXhlY3V0ZWQgYXMgZGVsZWdhdGVkIGV2ZW50cyBhbmRcbiAgICAgKiB0aGUgbGlzdGVuZXIgaXMgbm90IHRoZSAqYm9keSogZWxlbWVudC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4gKCkge1xuICAgICAgJHBvcHVwQ2xvbmUuZmluZCgnYScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFjdGlvbkluZGV4ID0gJCh0aGlzKS5wYXJlbnQoKS5pbmRleCgpO1xuXG4gICAgICAgICRwb3B1cC5maW5kKCdsaTpudGgoJyArIGFjdGlvbkluZGV4ICsgJykgYScpLmNsaWNrKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgcG9wdXAgcGFuZWwgY2xvbmVcbiAgICAgKiBhbmQgYWRkcyB0aGUgLmNpdmloci1wb3B1cC1vcGVuIGNsYXNzIHRvIHRoZSBib2R5XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3BlblBvcHVwQ2xvbmUgKCkge1xuICAgICAgdmFyIGJ1dHRvbk9mZnNldCA9ICRidXR0b24ub2Zmc2V0KCk7XG5cbiAgICAgICRwb3B1cENsb25lLmNzcyh7XG4gICAgICAgIGxlZnQ6ICtidXR0b25PZmZzZXQubGVmdCAtICgkcG9wdXBDbG9uZS53aWR0aCgpIC0gJGJ1dHRvbi5vdXRlcldpZHRoKCkpLFxuICAgICAgICB0b3A6ICtidXR0b25PZmZzZXQudG9wICsgJGJ1dHRvbi5vdXRlckhlaWdodCgpXG4gICAgICB9KTtcbiAgICAgICRwb3B1cENsb25lLnNob3coKTtcbiAgICAgICRib2R5LmFkZENsYXNzKCdjaXZpaHItcG9wdXAtb3BlbicpO1xuICAgIH1cbiAgfSk7XG59KShDUk0uJCk7XG4iXX0=
