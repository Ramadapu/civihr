!function(t,o){function n(o){o&&o.departments&&o.departments.length>0?t(".crm-contact-detail-departments").html("<strong>Department:</strong> "+o.departments.join(", ")):t(".crm-contact-detail-departments").html("")}t(document).on("crmLoad",function(o){t(".crm-inline-edit").one("DOMSubtreeModified",function(){var o=t(this).find("form");1===o.length&&o.find("label").each(function(){var o=t(this),n=o.attr("for");t("#"+n).attr("placeholder",o.text())})})}).on("updateContactHeader",function(o,c){var a;void 0!==c.contract&&((a=c.contract)?(t(".crm-summary-contactname-block").removeClass("crm-summary-contactname-block-without-contract"),a.position&&t(".crm-contact-detail-position").html("<strong>Position:</strong> "+a.position),a.location&&t(".crm-contact-detail-location").html("<strong>Normal place of work:</strong> "+a.location)):(t(".crm-summary-contactname-block").addClass("crm-summary-contactname-block-without-contract"),t(".crm-contact-detail-position").html(""),t(".crm-contact-detail-location").html(""),n(null))),void 0!==c.roles&&n(c.roles)})}(CRM.$,CRM._);
!function(e,t){function a(){var t=e(this)[0].files[0];e("#js-uploaded-file").remove(),void 0!==t&&(e(this).after('<span id="js-uploaded-file" class="uploaded-file">'+t.name+' <span class="uploaded-file-icon-trash"><i class="fa fa-trash-o"></i> Remove</span>'),e(".uploaded-file-icon-trash").on("click",i))}function o(e){e.find("label").attr("for",e.find(".crm-form-date").attr("id"))}function i(){var t=e("#js-uploaded-file").parent().find('input[type="file"]');e("#js-uploaded-file").remove(),t.val("")}e(document).on("crmLoad",function(t){var i,r,n,c;1===e(i="input[type='file']").length&&e(i).on("change",a),1===e(".CRM_HRRecruitment_Form_HRVacancy").length&&(o(e('label[for="start_date"]').parents("tr")),o(e('label[for="end_date"]').parents("tr")),e('[name="entryURL"]').val().indexOf(";template=1")>-1&&e(e(".CRM_HRRecruitment_Form_HRVacancy tbody").get(0)).addClass("CRM_HRRecruitment_Form_HRVacancy_Template")),r=t,"contactForm"!==CRM.formName&&"viewSummary"!==CRM.pageName||(e(".crm-contact-job_title",".crm-summary-contactinfo-block").length&&e(".crm-contact-tabs-list #tab_summary a",r.target).text("Personal Details"),r.target,(c=e(".Inline_Custom_Data")).appendTo(e("#contactinfo-block").parent("div").parent("div")),c.removeClass("crm-collapsible"),c.removeClass("collapsed"),c.addClass("crm-summary-block"),e(".Inline_Custom_Data div.collapsible-title").css({display:"none"}),e(".Inline_Custom_Data div.crm-summary-block").css({display:"block"}),e("#customFields").length<1&&(e("#Inline_Custom_Data label").each(function(){e("#nick_name").parent().after('<td id="customFields"></td>');var t=e(this).attr("for"),a=e("#"+t).detach();e("#customFields").append(e(this)),e("#customFields").append(a)}),e("#Inline_Custom_Data").remove()),n=r.target,e("div.crm-contact-current_employer, div.crm-contact-job_title",".crm-summary-contactinfo-block").parent("div.crm-summary-row").hide(),e("form#ContactInfo input#employer_id, form#ContactInfo input#job_title",n).closest("div.crm-summary-row").hide(),e("input#employer_id, input#job_title","form#Contact").parent("td").hide(),e(".HRJobContract_Summary",n).insertBefore(e(".crm-summary-contactinfo-block")),e("div.email-signature, td#Email-Bulkmail-html","form#Contact").hide(),e("#Email-Primary","form#Contact").prev("td").prev("td").hide(),e("td#Email-Bulkmail-html, #Email-Primary","form#Contact").prev("td").hide(),e(".crm-demographics-accordion","form#Contact").insertAfter(e(".crm-contactDetails-accordion")),e("tr#Phone_Block_2","form#Contact").length<1&&e("#addPhone").click()),e("#activityCustomData").attr("colspan",3),e("#crm-activity-view-table .crm-case-activity-view-Client .label").html("Contact"),e("span.crm-frozen-field",".crm-profile-name-hrident_tab").closest("div").parent("div").hide(),e(".crm-accordion-header.crm-master-accordion-header").on("click",function(){window.setTimeout(function(){Array.prototype.forEach.call(document.querySelectorAll(".listing-box"),function(e){Ps.initialize(e)})},0)}),e("INPUT#contact_source").parent("td").children("a").click(function(){e("#crm-notification-container .crm-help .notify-content").remove(),e("#crm-notification-container .crm-help p").length&&e("#crm-notification-container .crm-help p").remove(),e("#crm-notification-container .crm-help").append("<p>Source is a useful field where data has been migrated to CiviHR from one or a number of other legacy systems. The Source field will indicate which legacy system the contact has come from.</p>")})}).ready(function(){var t,a,o,i,r,n;e.ajax("/civicrm/hrcore/usermenu?snippet=4",{dataType:"html",success:function(t){var a,o,i;a="civihr-menu",o=e(t),(i=e("<div>")).attr("id",a),i.append(e("#civicrm-menu")),i.append(o),i.insertAfter("#page")}}),t=e(".crm-link-home"),a=e(".crm-logo-sm",t).addClass("chr_logo chr_logo--default-color").removeClass("crm-logo-sm").wrap('<span class="menumain-icon">').parent(),i=a,o=e("li > a",t).first().text("Home").wrapInner('<span class="menumain-label">').prepend(i),r=o,t.off().find("#civicrm-home").before(r).remove(),e(".CRM_HRRecruitment_Form_Application").addClass("crm-form-block"),e(".CRM_HRRecruitment_Form_Application .crm-profile-name-application_profile").addClass("form-layout-compressed"),e("#root-menu-div .menu-item-arrow").each(function(t){var a=e(this);a.before('<i class="fa fa-caret-right menu-item-arrow"></i>'),a.remove()}),n="activetarget",e(".menumain").not(".crm-Self_Service_Portal").hover(function(){e(this).addClass(n)},function(){e(this).removeClass(n)})})}(CRM.$,CRM._);
!function(t){"use strict";var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t.fn.attrchange=function(t){if(n){var e={subtree:!1,attributes:!0},i=new n(function(n){n.forEach(function(n){t.call(n.target,n)})});return this.each(function(){i.observe(this,e)})}}}(CRM.$);
!function(t){"use strict";var i=t("body");i.on("click","#bootstrap-theme .btn-slide",function(){var n,a,e=t(this),o=e.children("ul.panel");function c(){t(".civihr-popup").remove(),i.removeClass("civihr-popup-open")}c(),n=o.clone(!0).appendTo(i).addClass("civihr-popup"),a=e.offset(),n.css({left:+a.left-(n.width()-e.outerWidth()),top:+a.top+e.outerHeight()}),n.show(),i.addClass("civihr-popup-open"),n.find("a").click(function(){var i=t(this).parent().index();o.find("li:nth("+i+") a").click()}),e.data("attrchange-is-on")||(e.data("attrchange-is-on",!0),e.attrchange(function(){e.hasClass("btn-slide-active")||c()}))})}(CRM.$);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3QuanMiLCJocnVpLmpzIiwiY2l2aWhyLXBvcHVwL2F0dHJjaGFuZ2UuanMiLCJjaXZpaHItcG9wdXAvY2l2aWhyLXBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJfIiwidXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyIsInJvbGVzIiwiZGVwYXJ0bWVudHMiLCJsZW5ndGgiLCJodG1sIiwiam9pbiIsImRvY3VtZW50Iiwib24iLCJlIiwib25lIiwiJGZvcm0iLCJ0aGlzIiwiZmluZCIsImVhY2giLCIkbGFiZWwiLCJpZCIsImF0dHIiLCJ0ZXh0IiwiZGF0YSIsImNvbnRyYWN0IiwicmVtb3ZlQ2xhc3MiLCJwb3NpdGlvbiIsImxvY2F0aW9uIiwiYWRkQ2xhc3MiLCJDUk0iLCJpbnNlcnRGaWxlIiwiZmlsZU5hbWUiLCJmaWxlcyIsInJlbW92ZSIsInVuZGVmaW5lZCIsImFmdGVyIiwibmFtZSIsInJlbW92ZUZpbGUiLCJsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCIsIiRsaW5lIiwiJGlucHV0IiwicGFyZW50IiwidmFsIiwic2VsZWN0b3IiLCJ0YXJnZXQiLCJpbmxpbmVEYXRhQmxvY2siLCJwYXJlbnRzIiwiaW5kZXhPZiIsImdldCIsImZvcm1OYW1lIiwicGFnZU5hbWUiLCJhcHBlbmRUbyIsImNzcyIsImRpc3BsYXkiLCJub2RlSUQiLCJjdXN0b21GaWVsZCIsImRldGFjaCIsImFwcGVuZCIsImhpZGUiLCJjbG9zZXN0IiwiaW5zZXJ0QmVmb3JlIiwicHJldiIsImluc2VydEFmdGVyIiwiY2xpY2siLCJ3aW5kb3ciLCJzZXRUaW1lb3V0IiwiQXJyYXkiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbGVtZW50IiwiUHMiLCJpbml0aWFsaXplIiwiY2hpbGRyZW4iLCJyZWFkeSIsIiRtZW51SXRlbSIsIiR3cmFwcGVkTG9nbyIsIiRjdXN0b21Ib21lTGluayIsIiRhcHBMb2dvIiwiJGhvbWVMaW5rIiwiY2xhc3NOYW1lIiwiYWpheCIsImRhdGFUeXBlIiwic3VjY2VzcyIsIm1lbnVNYXJrdXAiLCJ3cmFwcGVySWQiLCIkbWVudU1hcmt1cCIsIiRtZW51V3JhcHBlciIsIndyYXAiLCJmaXJzdCIsIndyYXBJbm5lciIsInByZXBlbmQiLCJvZmYiLCJiZWZvcmUiLCIkZWxlbWVudCIsIiRhcnJvdyIsIm5vdCIsImhvdmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIldlYktpdE11dGF0aW9uT2JzZXJ2ZXIiLCJNb3pNdXRhdGlvbk9ic2VydmVyIiwiZm4iLCJhdHRyY2hhbmdlIiwiY2FsbGJhY2siLCJvcHRpb25zIiwic3VidHJlZSIsImF0dHJpYnV0ZXMiLCJvYnNlcnZlciIsIm11dGF0aW9ucyIsIm9ic2VydmUiLCIkYm9keSIsIiRwb3B1cENsb25lIiwiYnV0dG9uT2Zmc2V0IiwiJGJ1dHRvbiIsIiRwb3B1cCIsImNsb3NlUG9wdXBQYW5lbHMiLCJjbG9uZSIsIm9mZnNldCIsImxlZnQiLCJ3aWR0aCIsIm91dGVyV2lkdGgiLCJ0b3AiLCJvdXRlckhlaWdodCIsInNob3ciLCJhY3Rpb25JbmRleCIsImluZGV4IiwiaGFzQ2xhc3MiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEVBQUdDLEdBd0RaLFNBQVNDLEVBQWdDQyxHQUNuQ0EsR0FBU0EsRUFBTUMsYUFBZUQsRUFBTUMsWUFBWUMsT0FBUyxFQUMzREwsRUFBRSxtQ0FBbUNNLEtBQUssZ0NBQWtDSCxFQUFNQyxZQUFZRyxLQUFLLE9BRW5HUCxFQUFFLG1DQUFtQ00sS0FBSyxJQTFEOUNOLEVBQUVRLFVBQ0NDLEdBQUcsVUFBVyxTQUFTQyxHQUN0QlYsRUFBRSxvQkFBb0JXLElBQUkscUJBQXNCLFdBQzlDLElBQUlDLEVBQVFaLEVBQUVhLE1BQU1DLEtBQUssUUFFSixJQUFqQkYsRUFBTVAsUUFDUk8sRUFBTUUsS0FBSyxTQUFTQyxLQUFLLFdBQ3ZCLElBQUlDLEVBQVNoQixFQUFFYSxNQUNYSSxFQUFLRCxFQUFPRSxLQUFLLE9BQ3JCbEIs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QTZCRzVFLElBQUkxQjtDQ25CUCxTQUFXQSxHQUNULGFBQ0EsSUFBSTRHLEVBQVE1RyxFQUFFLFFBRWQ0RyxFQUFNbkcsR0FBRyxRQUFTLDhCQUErQixXQUMvQyxJQUFJb0csRUF5RUVDLEVBeEVGQyxFQUFVL0csRUFBRWEsTUFDWm1HLEVBQVNELEVBQVF4QyxTQUFTLFlBYzlCLFNBQVMwQyxJQUNQakgsRUFBRSxpQkFBaUI4QixTQUNuQjhFLEVBQU10RixZQUFZLHFCQWJsQjJGLElBcUJBSixFQUFjRyxFQUFPRSxPQUFNLEdBQ3hCbEUsU0FBUzRELEdBQ1RuRixTQUFTLGdCQTZDUnFGLEVBQWVDLEVBQVFJLFNBRTNCTixFQUFZNUQsS0FDVm1FLE1BQU9OLEVBQWFNLE1BQVFQLEVBQVlRLFFBQVVOLEVBQVFPLGNBQzFEQyxLQUFNVCxFQUFhUyxJQUFNUixFQUFRUyxnQkFFbkNYLEVBQVlZLE9BQ1piLEVBQU1uRixTQUFTLHFCQW5CZm9GLEVBQVkvRixLQUFLLEtBQUs4QyxNQUFNLFdBQzFCLElBQUk4RCxFQUFjMUgsRUFBRWEsTUFBTXlCLFNBQVNxRixRQUVuQ1gsRUFBT2xHLEtBQUssVUFBWTRHLEVBQWMsT0FBTzlELFVBeEIzQ21ELEVBQVEzRixLQUFLLHNCQUlqQjJGLEVBQVEzRixLQUFLLG9CQUFvQixHQUNqQzJGLEVBQVFYLFdBQVcsV0FFYlcsRUFBUWEsU0FBUyxxQkFJckJYLFNBeERSLENBd0ZHdkYsSUFBSTFCIiwiZmlsZSI6ImhydWkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgkLCBfKSB7XG5cbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NybUxvYWQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAkKCcuY3JtLWlubGluZS1lZGl0Jykub25lKCdET01TdWJ0cmVlTW9kaWZpZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICRmb3JtID0gJCh0aGlzKS5maW5kKCdmb3JtJyk7XG5cbiAgICAgICAgaWYgKCRmb3JtLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICRmb3JtLmZpbmQoJ2xhYmVsJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciAkbGFiZWwgPSAkKHRoaXMpO1xuICAgICAgICAgICAgdmFyIGlkID0gJGxhYmVsLmF0dHIoJ2ZvcicpO1xuICAgICAgICAgICAgJCgnIycgKyBpZCkuYXR0cigncGxhY2Vob2xkZXInLCAkbGFiZWwudGV4dCgpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICAgIC5vbigndXBkYXRlQ29udGFjdEhlYWRlcicsIGZ1bmN0aW9uIChlLCBkYXRhKSB7XG4gICAgICBpZiAodHlwZW9mIGRhdGEuY29udHJhY3QgIT09ICd1bmRlZmluZWQnKSAge1xuICAgICAgICB1cGRhdGVDb250YWN0SGVhZGVyQ29udHJhY3REZXRhaWxzKGRhdGEuY29udHJhY3QpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGRhdGEucm9sZXMgIT09ICd1bmRlZmluZWQnKSAge1xuICAgICAgICB1cGRhdGVDb250YWN0SGVhZGVyUm9sZXNEZXRhaWxzKGRhdGEucm9sZXMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250YWN0IGhlYWRlciB3aXRoIHRoZSBnaXZlbiBjb250cmFjdCBkZXRhaWxzXG4gICAqXG4gICAqIEBwYXJhbSAge29iamVjdH0gY29udHJhY3RcbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMoY29udHJhY3QpIHtcbiAgICBpZiAoY29udHJhY3QpICB7XG4gICAgICAkKCcuY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2snKS5yZW1vdmVDbGFzcygnY3JtLXN1bW1hcnktY29udGFjdG5hbWUtYmxvY2std2l0aG91dC1jb250cmFjdCcpO1xuXG4gICAgICBpZiAoY29udHJhY3QucG9zaXRpb24pIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1wb3NpdGlvbicpLmh0bWwoJzxzdHJvbmc+UG9zaXRpb246PC9zdHJvbmc+ICcrIGNvbnRyYWN0LnBvc2l0aW9uKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbnRyYWN0LmxvY2F0aW9uKSB7XG4gICAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtbG9jYXRpb24nKS5odG1sKCc8c3Ryb25nPk5vcm1hbCBwbGFjZSBvZiB3b3JrOjwvc3Ryb25nPiAnKyBjb250cmFjdC5sb2NhdGlvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jaycpLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jay13aXRob3V0LWNvbnRyYWN0Jyk7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLXBvc2l0aW9uJykuaHRtbCgnJyk7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWxvY2F0aW9uJykuaHRtbCgnJyk7XG5cbiAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJSb2xlc0RldGFpbHMobnVsbCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRhY3QgaGVhZGVyIHdpdGggdGhlIGdpdmVuIHJvbGVzIGRldGFpbHNcbiAgICpcbiAgICogQHBhcmFtICB7b2JqZWN0fSBjb250cmFjdFxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyhyb2xlcykge1xuICAgIGlmIChyb2xlcyAmJiByb2xlcy5kZXBhcnRtZW50cyAmJiByb2xlcy5kZXBhcnRtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLWRlcGFydG1lbnRzJykuaHRtbCgnPHN0cm9uZz5EZXBhcnRtZW50Ojwvc3Ryb25nPiAnICsgcm9sZXMuZGVwYXJ0bWVudHMuam9pbignLCAnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtZGVwYXJ0bWVudHMnKS5odG1sKCcnKTtcbiAgICB9XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIvKiBnbG9iYWwgUHMgKi9cblxuLy8gQ29weXJpZ2h0IENpdmlDUk0gTExDIDIwMTMuIFNlZSBodHRwOi8vY2l2aWNybS5vcmcvbGljZW5zaW5nXG4oZnVuY3Rpb24gKCQsIF8pIHtcbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NybUxvYWQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgYWRkVXBsb2FkRmlsZUxpc3RlbmVyKFwiaW5wdXRbdHlwZT0nZmlsZSddXCIpO1xuICAgICAgYW1lbmRWYWNhbmN5Rm9ybSgpO1xuICAgICAgYW1lbmRDb250YWN0UGFnZUFuZEZvcm0oZSk7XG4gICAgICBhcHBseU1pc2NDaGFuZ2VzKCk7XG4gICAgICBjaGFuZ2VDb250YWN0U291cmNlRmllbGRIZWxwVGV4dCgpO1xuICAgIH0pXG4gICAgLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgIGFkZFVzZXJNZW51VG9NYWluTWVudSgpO1xuICAgICAgYW1lbmRBcHBMb2dvTWVudUl0ZW0oKTtcbiAgICAgIGFtZW5kQXBwbGljYXRpb25Gb3JtKCk7XG4gICAgICB1c2VGb250QXdlc29tZUFycm93c0luU3ViTWVudUl0ZW1zKCk7XG4gICAgICB0b2dnbGVBY3RpdmVDbGFzc09uSG92ZXJPbkFueU1haW5NZW51SXRlbSgpO1xuICAgIH0pO1xuXG4gIC8qKlxuICAgKiBDdXN0b21pemVzIHRoZSBhcHAgbG9nbyBtZW51IGl0ZW0sIHN3aXRjaGluZyBmcm9tIHRoZSBDaXZpQ1JNIGxvZ29cbiAgICogdG8gdGhlIENpdmlIUiBsb2dvLCBhbmQgbWFraW5nIHRoZSBpdGVtIGEgZGlyZWN0IGxpbmsgaW5zdGVhZCBvZiBhXG4gICAqIHRvZ2dsZSBmb3IgYSBzdWIgbWVudSBkcm9wZG93blxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRBcHBMb2dvTWVudUl0ZW0gKCkge1xuICAgIHZhciAkbWVudUl0ZW0gPSAkKCcuY3JtLWxpbmstaG9tZScpO1xuICAgIHZhciAkd3JhcHBlZExvZ28gPSBzd2FwQW5kV3JhcEFwcExvZ28oJG1lbnVJdGVtKTtcbiAgICB2YXIgJGN1c3RvbUhvbWVMaW5rID0gY3VzdG9taXplSG9tZUxpbmtJbkxvZ29NZW51SXRlbSgkbWVudUl0ZW0sICR3cmFwcGVkTG9nbyk7XG5cbiAgICByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsoJG1lbnVJdGVtLCAkY3VzdG9tSG9tZUxpbmspO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIHVzZXIgbWVudSBieSBmZXRjaGluZyBpdCBmcm9tIHRoZSBocmNvcmUgZXh0ZW5zaW9uXG4gICAqL1xuICBmdW5jdGlvbiBhZGRVc2VyTWVudVRvTWFpbk1lbnUgKCkge1xuICAgICQuYWpheCgnL2Npdmljcm0vaHJjb3JlL3VzZXJtZW51P3NuaXBwZXQ9NCcsIHtcbiAgICAgIGRhdGFUeXBlOiAnaHRtbCcsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAobWVudU1hcmt1cCkge1xuICAgICAgICBpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlcihtZW51TWFya3VwLCAnY2l2aWhyLW1lbnUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSBHb3Zlcm5tZW50IElEIGZpZWxkIG9uIHRoZSBQZXJzb25hbCBEZXRhaWxzIHBhZ2UgYW5kIG9uIHRoZSBFZGl0XG4gICAqIENvbnRhY3QgZm9ybS5cbiAgICovXG4gIGZ1bmN0aW9uIGFkZEdvdmVybm1lbnRJZEZpZWxkICgpIHtcbiAgICAvLyBVcGRhdGVzIFBlcnNvbmFsIERldGFpbHMgUGFnZVxuICAgIHZhciBpbmxpbmVEYXRhQmxvY2sgPSAkKCcuSW5saW5lX0N1c3RvbV9EYXRhJyk7XG5cbiAgICBpbmxpbmVEYXRhQmxvY2suYXBwZW5kVG8oJCgnI2NvbnRhY3RpbmZvLWJsb2NrJykucGFyZW50KCdkaXYnKS5wYXJlbnQoJ2RpdicpKTtcbiAgICBpbmxpbmVEYXRhQmxvY2sucmVtb3ZlQ2xhc3MoJ2NybS1jb2xsYXBzaWJsZScpO1xuICAgIGlubGluZURhdGFCbG9jay5yZW1vdmVDbGFzcygnY29sbGFwc2VkJyk7XG4gICAgaW5saW5lRGF0YUJsb2NrLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1ibG9jaycpO1xuXG4gICAgJCgnLklubGluZV9DdXN0b21fRGF0YSBkaXYuY29sbGFwc2libGUtdGl0bGUnKS5jc3Moe2Rpc3BsYXk6ICdub25lJ30pO1xuICAgICQoJy5JbmxpbmVfQ3VzdG9tX0RhdGEgZGl2LmNybS1zdW1tYXJ5LWJsb2NrJykuY3NzKHtkaXNwbGF5OiAnYmxvY2snfSk7XG5cbiAgICAvLyBVcGRhdGVzIEVkaXQgQ29udGFjdCBGb3JtXG4gICAgaWYgKCQoJyNjdXN0b21GaWVsZHMnKS5sZW5ndGggPCAxKSB7XG4gICAgICAkKCcjSW5saW5lX0N1c3RvbV9EYXRhIGxhYmVsJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJyNuaWNrX25hbWUnKS5wYXJlbnQoKS5hZnRlcignPHRkIGlkPVwiY3VzdG9tRmllbGRzXCI+PC90ZD4nKTtcbiAgICAgICAgdmFyIG5vZGVJRCA9ICQodGhpcykuYXR0cignZm9yJyk7XG4gICAgICAgIHZhciBjdXN0b21GaWVsZCA9ICQoJyMnICsgbm9kZUlEKS5kZXRhY2goKTtcbiAgICAgICAgJCgnI2N1c3RvbUZpZWxkcycpLmFwcGVuZCgkKHRoaXMpKTtcbiAgICAgICAgJCgnI2N1c3RvbUZpZWxkcycpLmFwcGVuZChjdXN0b21GaWVsZCk7XG4gICAgICB9KTtcblxuICAgICAgJCgnI0lubGluZV9DdXN0b21fRGF0YScpLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgb24gaW5wdXRbdHlwZT1cImZpbGVcIl1cbiAgICogQHBhcmFtIHtqUXVlcnkgT2JqZWN0fSBzZWxlY3RvciBbc2VsZWN0b3IgZnJvbSBpbnB1dCBmaWxlXVxuICAgKi9cbiAgZnVuY3Rpb24gYWRkVXBsb2FkRmlsZUxpc3RlbmVyIChzZWxlY3Rvcikge1xuICAgIGlmICgkKHNlbGVjdG9yKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICQoc2VsZWN0b3IpLm9uKCdjaGFuZ2UnLCBpbnNlcnRGaWxlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSBhcHBsaWNhdGlvbiBmb3JtXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZEFwcGxpY2F0aW9uRm9ybSAoKSB7XG4gICAgJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fQXBwbGljYXRpb24nKS5hZGRDbGFzcygnY3JtLWZvcm0tYmxvY2snKTtcbiAgICAkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9BcHBsaWNhdGlvbiAuY3JtLXByb2ZpbGUtbmFtZS1hcHBsaWNhdGlvbl9wcm9maWxlJykuYWRkQ2xhc3MoJ2Zvcm0tbGF5b3V0LWNvbXByZXNzZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIGNvbnRhY3QgcGFnZSBhbmQgdGhlIGNvbnRhY3QgZm9ybVxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRDb250YWN0UGFnZUFuZEZvcm0gKGUpIHtcbiAgICBpZiAoQ1JNLmZvcm1OYW1lID09PSAnY29udGFjdEZvcm0nIHx8IENSTS5wYWdlTmFtZSA9PT0gJ3ZpZXdTdW1tYXJ5Jykge1xuICAgICAgLy8gUmVuYW1lIFwiU3VtbWFyeVwiIHRhYiB0byBcIlBlcnNvbmFsIERldGFpbHNcIlxuICAgICAgLy8gSGFjayB0byBjaGVjayBjb250YWN0IHR5cGUgLSBUaGlzIGZpZWxkIG9ubHkgYXBwZWFycyBmb3IgaW5kaXZpZHVhbHNcbiAgICAgIGlmICgkKCcuY3JtLWNvbnRhY3Qtam9iX3RpdGxlJywgJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpLmxlbmd0aCkge1xuICAgICAgICAkKCcuY3JtLWNvbnRhY3QtdGFicy1saXN0ICN0YWJfc3VtbWFyeSBhJywgZS50YXJnZXQpLnRleHQoJ1BlcnNvbmFsIERldGFpbHMnKTtcbiAgICAgIH1cblxuICAgICAgYWRkR292ZXJubWVudElkRmllbGQoZS50YXJnZXQpO1xuICAgICAgbWlzY0NvbnRhY3RQYWdlQ2hhbmdlcyhlLnRhcmdldCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFtZW5kcyB0aGUgdmFjYW5jeSBmb3JtXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZFZhY2FuY3lGb3JtICgpIHtcbiAgICBpZiAoJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fSFJWYWNhbmN5JykubGVuZ3RoID09PSAxKSB7XG4gICAgICBsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCgkKCdsYWJlbFtmb3I9XCJzdGFydF9kYXRlXCJdJykucGFyZW50cygndHInKSk7XG4gICAgICBsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCgkKCdsYWJlbFtmb3I9XCJlbmRfZGF0ZVwiXScpLnBhcmVudHMoJ3RyJykpO1xuXG4gICAgICAvLyBBZGQgYSBjbGFzcyB0byBpZGVudGlmeSB0aGUgZm9ybSAnTmV3IFZhY2FuY3kgVGVtcGxhdGUnXG4gICAgICBpZiAoJCgnW25hbWU9XCJlbnRyeVVSTFwiXScpLnZhbCgpLmluZGV4T2YoJzt0ZW1wbGF0ZT0xJykgPiAtMSkge1xuICAgICAgICAkKCQoJy5DUk1fSFJSZWNydWl0bWVudF9Gb3JtX0hSVmFjYW5jeSB0Ym9keScpLmdldCgwKSkuYWRkQ2xhc3MoJ0NSTV9IUlJlY3J1aXRtZW50X0Zvcm1fSFJWYWNhbmN5X1RlbXBsYXRlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFwcGxpZXMgbWlzY2VsbGFuZW91cyBVSSBjaGFuZ2VzXG4gICAqL1xuICBmdW5jdGlvbiBhcHBseU1pc2NDaGFuZ2VzICgpIHtcbiAgICAkKCcjYWN0aXZpdHlDdXN0b21EYXRhJykuYXR0cignY29sc3BhbicsIDMpO1xuICAgICQoJyNjcm0tYWN0aXZpdHktdmlldy10YWJsZSAuY3JtLWNhc2UtYWN0aXZpdHktdmlldy1DbGllbnQgLmxhYmVsJykuaHRtbCgnQ29udGFjdCcpO1xuICAgICQoJ3NwYW4uY3JtLWZyb3plbi1maWVsZCcsICcuY3JtLXByb2ZpbGUtbmFtZS1ocmlkZW50X3RhYicpLmNsb3Nlc3QoJ2RpdicpLnBhcmVudCgnZGl2JykuaGlkZSgpO1xuXG4gICAgJCgnLmNybS1hY2NvcmRpb24taGVhZGVyLmNybS1tYXN0ZXItYWNjb3JkaW9uLWhlYWRlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGlzdGluZy1ib3gnKSwgZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICBQcy5pbml0aWFsaXplKGVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICAgIH0sIDApO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENoYW5nZXMgb2Ygc29yY2UgaGVscCB0ZXh0XG4gICAqL1xuICBmdW5jdGlvbiBjaGFuZ2VDb250YWN0U291cmNlRmllbGRIZWxwVGV4dCAoKSB7XG4gICAgJCgnSU5QVVQjY29udGFjdF9zb3VyY2UnKS5wYXJlbnQoJ3RkJykuY2hpbGRyZW4oJ2EnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwIC5ub3RpZnktY29udGVudCcpLnJlbW92ZSgpO1xuXG4gICAgICBpZiAoJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCBwJykubGVuZ3RoKSB7XG4gICAgICAgICQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAgcCcpLnJlbW92ZSgpO1xuICAgICAgfVxuXG4gICAgICAkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwJykuYXBwZW5kKCc8cD5Tb3VyY2UgaXMgYSB1c2VmdWwgZmllbGQgd2hlcmUgZGF0YSBoYXMgYmVlbiBtaWdyYXRlZCB0byBDaXZpSFIgZnJvbSBvbmUgb3IgYSBudW1iZXIgb2Ygb3RoZXIgbGVnYWN5IHN5c3RlbXMuIFRoZSBTb3VyY2UgZmllbGQgd2lsbCBpbmRpY2F0ZSB3aGljaCBsZWdhY3kgc3lzdGVtIHRoZSBjb250YWN0IGhhcyBjb21lIGZyb20uPC9wPicpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBvcmlnaW5hbCBsaW5rIHRvIHRoZSBob21lcGFnZSwgY2hhbmdlcyB0aGUgdGV4dCwgd3JhcHMgaXQgaW4gYVxuICAgKiBgbWVudW1haW4tbGFiZWxgIGVsZW1lbnQgYW5kIHByZXBlbmRzIGludGVybmFsbHkgdGhlIGdpdmVuIGFwcCBsb2dvXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbGlua1xuICAgKiBAcGFyYW0ge29iamVjdH0gJGFwcExvZ29cbiAgICogQHJldHVybiB0aGUgY3VzdG9taXplZCBob21lIGxpbmtcbiAgICovXG4gIGZ1bmN0aW9uIGN1c3RvbWl6ZUhvbWVMaW5rSW5Mb2dvTWVudUl0ZW0gKCRtZW51SXRlbSwgJGFwcExvZ28pIHtcbiAgICB2YXIgJGhvbWVMaW5rID0gJCgnbGkgPiBhJywgJG1lbnVJdGVtKS5maXJzdCgpO1xuXG4gICAgcmV0dXJuICRob21lTGlua1xuICAgICAgLnRleHQoJ0hvbWUnKVxuICAgICAgLndyYXBJbm5lcignPHNwYW4gY2xhc3M9XCJtZW51bWFpbi1sYWJlbFwiPicpXG4gICAgICAucHJlcGVuZCgkYXBwTG9nbyk7XG4gIH1cblxuICAvKipcbiAgICogSW5qZWN0cyB0aGUgZ2l2ZW4gbWFya3VwIGluIGEgbWVudSB3cmFwcGVyIHdpdGggdGhlIGdpdmVuIGlkXG4gICAqIGNyZWF0ZWQgdG8gY29udGFpbiBib3RoIHRoZSBvcmlnaW5hbCBtZW51IGFuZCB0aGUgdXNlciBvbmVcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lbnVNYXJrdXBcbiAgICogQHBhcmFtIHtzdHJpbmd9IHdyYXBwZXJJZFxuICAgKi9cbiAgZnVuY3Rpb24gaW5qZWN0VXNlck1lbnVJbkFNYWluTWVudVdyYXBwZXIgKG1lbnVNYXJrdXAsIHdyYXBwZXJJZCkge1xuICAgIHZhciAkbWVudU1hcmt1cCA9ICQobWVudU1hcmt1cCk7XG4gICAgdmFyICRtZW51V3JhcHBlciA9ICQoJzxkaXY+Jyk7XG5cbiAgICAkbWVudVdyYXBwZXIuYXR0cignaWQnLCB3cmFwcGVySWQpO1xuICAgICRtZW51V3JhcHBlci5hcHBlbmQoJCgnI2Npdmljcm0tbWVudScpKTtcbiAgICAkbWVudVdyYXBwZXIuYXBwZW5kKCRtZW51TWFya3VwKTtcbiAgICAkbWVudVdyYXBwZXIuaW5zZXJ0QWZ0ZXIoJyNwYWdlJyk7XG4gIH1cblxuICAvKipcbiAgICogSW5zZXJ0IGEgRE9NIG5vZGUgYWZ0ZXIgaW5wdXRbdHlwZT1cImZpbGVcIl1cbiAgICogd2l0aCB0aGUgZmlsZW5hbWVcbiAgICovXG4gIGZ1bmN0aW9uIGluc2VydEZpbGUgKCkge1xuICAgIHZhciBmaWxlTmFtZSA9ICQodGhpcylbMF0uZmlsZXNbMF07XG5cbiAgICAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnJlbW92ZSgpO1xuICAgIGlmIChmaWxlTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAkKHRoaXMpLmFmdGVyKCc8c3BhbiBpZD1cImpzLXVwbG9hZGVkLWZpbGVcIiBjbGFzcz1cInVwbG9hZGVkLWZpbGVcIj4nICsgZmlsZU5hbWUubmFtZSArICcgPHNwYW4gY2xhc3M9XCJ1cGxvYWRlZC1maWxlLWljb24tdHJhc2hcIj48aSBjbGFzcz1cImZhIGZhLXRyYXNoLW9cIj48L2k+IFJlbW92ZTwvc3Bhbj4nKTtcblxuICAgICAgJCgnLnVwbG9hZGVkLWZpbGUtaWNvbi10cmFzaCcpLm9uKCdjbGljaycsIHJlbW92ZUZpbGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGFiZWwgJ2ZvcicgYXR0ciB0byB3b3JrcyB3aXRoIHRoZSBkYXRlcGlja2VyXG4gICAqXG4gICAqIEBwYXJhbSAge2pRdWVyeSBvYmplY3R9ICRsaW5lIFtkYXRlcGlja2VyJ3MgbGluZSBwYXJlbnRdXG4gICAqL1xuICBmdW5jdGlvbiBsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCAoJGxpbmUpIHtcbiAgICAkbGluZS5maW5kKCdsYWJlbCcpLmF0dHIoJ2ZvcicsICRsaW5lLmZpbmQoJy5jcm0tZm9ybS1kYXRlJykuYXR0cignaWQnKSk7XG4gIH1cblxuICAvKipcbiAgICogTWlzYyBjaGFuZ2VzIHRvIHRoZSBwYWdlIChoaWRpbmcgZWxlbWVudHMsIGluc2VydGluZyBuZXcgb25lcywgZXRjKVxuICAgKi9cbiAgZnVuY3Rpb24gbWlzY0NvbnRhY3RQYWdlQ2hhbmdlcyAodGFyZ2V0KSB7XG4gICAgLy8gSGlkZSBjdXJyZW50IGVtcGxveWVyIGFuZCBqb2IgdGl0bGVcbiAgICAvLyBDb250YWN0IHN1bW1hcnkgc2NyZWVuOlxuICAgICQoJ2Rpdi5jcm0tY29udGFjdC1jdXJyZW50X2VtcGxveWVyLCBkaXYuY3JtLWNvbnRhY3Qtam9iX3RpdGxlJywgJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpLnBhcmVudCgnZGl2LmNybS1zdW1tYXJ5LXJvdycpLmhpZGUoKTtcbiAgICAvLyBJbmxpbmUgZWRpdCBmb3JtXG4gICAgJCgnZm9ybSNDb250YWN0SW5mbyBpbnB1dCNlbXBsb3llcl9pZCwgZm9ybSNDb250YWN0SW5mbyBpbnB1dCNqb2JfdGl0bGUnLCB0YXJnZXQpLmNsb3Nlc3QoJ2Rpdi5jcm0tc3VtbWFyeS1yb3cnKS5oaWRlKCk7XG4gICAgLy8gQ29udGFjdCBlZGl0IHNjcmVlblxuICAgICQoJ2lucHV0I2VtcGxveWVyX2lkLCBpbnB1dCNqb2JfdGl0bGUnLCAnZm9ybSNDb250YWN0JykucGFyZW50KCd0ZCcpLmhpZGUoKTtcblxuICAgIC8qIENoYW5nZXMgb24gQWRkIEluZGl2aWR1YWwgcGFnZXMgYW5kIFBlcnNvbmFsIGRldGFpbHMgdGFiIGZvciBIUi0zNTggKi9cbiAgICAvLyBNb3ZlIEpvYiBzdW1tYXJ5IHRvIHRvcFxuICAgICQoJy5IUkpvYkNvbnRyYWN0X1N1bW1hcnknLCB0YXJnZXQpLmluc2VydEJlZm9yZSgkKCcuY3JtLXN1bW1hcnktY29udGFjdGluZm8tYmxvY2snKSk7XG4gICAgLy8gY2hhbmdlcyBvZiBlbWFpbCBibG9jaywgcmVtb3ZlIGJ1bGttYWlsIGFuZCBvbmhvbGRcbiAgICAkKCdkaXYuZW1haWwtc2lnbmF0dXJlLCB0ZCNFbWFpbC1CdWxrbWFpbC1odG1sJywgJ2Zvcm0jQ29udGFjdCcpLmhpZGUoKTtcbiAgICAkKCcjRW1haWwtUHJpbWFyeScsICdmb3JtI0NvbnRhY3QnKS5wcmV2KCd0ZCcpLnByZXYoJ3RkJykuaGlkZSgpO1xuICAgICQoJ3RkI0VtYWlsLUJ1bGttYWlsLWh0bWwsICNFbWFpbC1QcmltYXJ5JywgJ2Zvcm0jQ29udGFjdCcpLnByZXYoJ3RkJykuaGlkZSgpO1xuXG4gICAgLy8gc2hpZnQgZGVtb2dyYXBoaWMgYWJvdmUgZXh0ZW5kZWQgZGVtb2dyYXBoaWNcbiAgICAkKCcuY3JtLWRlbW9ncmFwaGljcy1hY2NvcmRpb24nLCAnZm9ybSNDb250YWN0JykuaW5zZXJ0QWZ0ZXIoJCgnLmNybS1jb250YWN0RGV0YWlscy1hY2NvcmRpb24nKSk7XG5cbiAgICBpZiAoJCgndHIjUGhvbmVfQmxvY2tfMicsICdmb3JtI0NvbnRhY3QnKS5sZW5ndGggPCAxKSB7XG4gICAgICAkKCcjYWRkUGhvbmUnKS5jbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlICNqcy11cGxvYWRlZC1maWxlIERJViBhbmRcbiAgICogY2xlYW4gaW5wdXRbdHlwZT1cImZpbGVcIl0gdmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIHJlbW92ZUZpbGUgKCkge1xuICAgIHZhciAkaW5wdXQgPSAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnBhcmVudCgpLmZpbmQoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAkKCcjanMtdXBsb2FkZWQtZmlsZScpLnJlbW92ZSgpO1xuICAgICRpbnB1dC52YWwoJycpO1xuICB9XG5cbiAgLyoqXG4gICAqIE1vdmVzIHRoZSBnaXZlbiBob21lIGxpbmsgcmlnaHQgdW5kZXIgdGhlIG1lbnUgaXRlbSBhbmQgZ2V0cyByaWRcbiAgICogb2YgdGhlIG9yaWdpbmFsIHN1YiBtZW51XG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbGlua1xuICAgKiBAcGFyYW0ge29iamVjdH0gJGhvbWVMaW5rXG4gICAqL1xuICBmdW5jdGlvbiByZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsgKCRtZW51SXRlbSwgJGhvbWVMaW5rKSB7XG4gICAgJG1lbnVJdGVtXG4gICAgICAub2ZmKCkgLy8gcmVtb3ZlcyBhbnkgaGFuZGxlciB0aGF0IHRoZSBvcmlnaW5hbCBpdGVtIGhhZFxuICAgICAgLmZpbmQoJyNjaXZpY3JtLWhvbWUnKVxuICAgICAgLmJlZm9yZSgkaG9tZUxpbmspXG4gICAgICAucmVtb3ZlKCk7XG4gIH1cblxuICAvKipcbiAgICogU3dhcHMgdGhlIENpdmlDUk0gbG9nbyB3aXRoIHRoZSBDaXZpSFIgbG9nb1xuICAgKiBhbmQgd3JhcHMgaXQgaW4gYSBgbWVudW1haW4taWNvbmAgZWxlbWVudFxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gJG1lbnVJdGVtIFRoZSBjb250ZXh0IHdoZXJlIHRvIGZpbmQgdGhlIGxvZ29cbiAgICogQHJldHVybiB0aGUgd3JhcHBlciBvZiB0aGUgbG9nb1xuICAgKi9cbiAgZnVuY3Rpb24gc3dhcEFuZFdyYXBBcHBMb2dvICgkbWVudUl0ZW0pIHtcbiAgICB2YXIgJGFwcExvZ28gPSAkKCcuY3JtLWxvZ28tc20nLCAkbWVudUl0ZW0pO1xuXG4gICAgcmV0dXJuICRhcHBMb2dvXG4gICAgICAuYWRkQ2xhc3MoJ2Nocl9sb2dvIGNocl9sb2dvLS1kZWZhdWx0LWNvbG9yJylcbiAgICAgIC5yZW1vdmVDbGFzcygnY3JtLWxvZ28tc20nKVxuICAgICAgLndyYXAoJzxzcGFuIGNsYXNzPVwibWVudW1haW4taWNvblwiPicpXG4gICAgICAucGFyZW50KCk7XG4gIH1cblxuICAvKipcbiAgICogQ2l2aUNSTSBieSBkZWZhdWx0IGFwcGxpZXMgb24gaG92ZXIgdGhlIC5hY3RpdmV0YXJnZXQgY2xhc3NcbiAgICogb25seSB0byBtYWluIG1lbnUgaXRlbXMgd2l0aCBhIHN1Ym1lbnVcbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgbWFrZXMgc3VyZSB0aGF0IGFueSBpdGVtIGdldHMgdGhlIGNsYXNzIGFwcGxpZWQsXG4gICAqIGV2ZW4gdGhvc2Ugd2l0aCBqdXN0IGEgZGlyZWN0IGxpbmtcbiAgICovXG4gIGZ1bmN0aW9uIHRvZ2dsZUFjdGl2ZUNsYXNzT25Ib3Zlck9uQW55TWFpbk1lbnVJdGVtICgpIHtcbiAgICB2YXIgY2xhc3NOYW1lID0gJ2FjdGl2ZXRhcmdldCc7XG5cbiAgICAkKCcubWVudW1haW4nKS5ub3QoJy5jcm0tU2VsZl9TZXJ2aWNlX1BvcnRhbCcpLmhvdmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBhcnJvdyBmb3IgbWVudSBpdGVtcyB3aXRoIHN1Yi1pdGVtcywgYW5kIHJlcGxhY2VzIGl0XG4gICAqIHdpdGggYSBmb250IGF3ZXNvbWUgY2FyZXRcbiAgICovXG4gIGZ1bmN0aW9uIHVzZUZvbnRBd2Vzb21lQXJyb3dzSW5TdWJNZW51SXRlbXMgKCkge1xuICAgICQoJyNyb290LW1lbnUtZGl2IC5tZW51LWl0ZW0tYXJyb3cnKS5lYWNoKGZ1bmN0aW9uICgkZWxlbWVudCkge1xuICAgICAgdmFyICRhcnJvdyA9ICQodGhpcyk7XG5cbiAgICAgICRhcnJvdy5iZWZvcmUoJzxpIGNsYXNzPVwiZmEgZmEtY2FyZXQtcmlnaHQgbWVudS1pdGVtLWFycm93XCI+PC9pPicpO1xuICAgICAgJGFycm93LnJlbW92ZSgpO1xuICAgIH0pO1xuICB9XG59KENSTS4kLCBDUk0uXykpO1xuIiwiKGZ1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlcjtcblxuICAvKlxuICBUaGlzIHBsdWdpbiBjcmVhdGVzIE11dGF0aW9uT2JzZXJ2ZXIgd2hpY2ggbGlzdGVucyB0byBhbGwgY2hhbmdlcyB0byBET00gTm9kZS5cbiAgSWYgY2hhbmdlIGhhcyBiZWVuIGRvbmUgdG8gaXQncyBhdHRyaWJ1dGVzIGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkLlxuXG4gIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gdG8gYmUgY2FsbGVkIHdoZW4gYXR0cmlidXRlcyBjaGFuZ2VcbiAgQHJldHVybnMge0FycmF5fSAtIGxpc3Qgb2YgYWxsIG9ic2VydmVkIGVsZW1lbnRzXG4gICovXG4gICQuZm4uYXR0cmNoYW5nZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgc3VidHJlZTogZmFsc2UsXG4gICAgICAgIGF0dHJpYnV0ZXM6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBjYWxsYmFjay5jYWxsKGUudGFyZ2V0LCBlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUodGhpcywgb3B0aW9ucyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKENSTS4kKTtcbiIsIi8qIGdsb2JhbHMgQ1JNICovXG5cbi8qKlxuICogSGVscHMgdG8gZGlzcGxheSBwb3B1cCBtZW51cyBpbnNpZGUgI2Jvb3RzdHJhcC10aGVtZSBlbGVtZW50cywgc2luY2UgLnBhbmVsJ3NcbiAqIGFuZCBvdGhlciBCb290c3RyYXAgZWxlbWVudHMgY2xhc2ggd2l0aCBDaXZpQ1JNIHN0eWxlcyBwcm9kdWNpbmcgdW5kZXNpcmVkXG4gKiByZXN1bHRzLlxuICpcbiAqIEl0IGFsc28gaGVscHMgd2l0aCBldmVudCBiaW5kaW5ncywgaW4gY2FzZSB0aGUgb3JpZ2luYWwgcG9wdXAgYnV0dG9uIHdhc1xuICogcmVtb3ZlZCBhbmQgcmVjcmVhdGVkLCBieSBmb3J3YXJkaW5nIHRoZSBldmVudHMgdG8gdGhlIG9yaWdpbmFsIHNvdXJjZS5cbiAqL1xuKGZ1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyICRib2R5ID0gJCgnYm9keScpO1xuXG4gICRib2R5Lm9uKCdjbGljaycsICcjYm9vdHN0cmFwLXRoZW1lIC5idG4tc2xpZGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRwb3B1cENsb25lO1xuICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKTtcbiAgICB2YXIgJHBvcHVwID0gJGJ1dHRvbi5jaGlsZHJlbigndWwucGFuZWwnKTtcblxuICAgIChmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgIGNsb3NlUG9wdXBQYW5lbHMoKTtcbiAgICAgIGNyZWF0ZVBvcHVwQ2xvbmUoKTtcbiAgICAgIG9wZW5Qb3B1cENsb25lKCk7XG4gICAgICBtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4oKTtcbiAgICAgIGxpc3RlblRvTW91c2VPdXRFdmVudCgpO1xuICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIGFueSBwb3B1cCBwYW5lbCB0aGF0IGlzIGN1cnJlbnRseSBvcGVuIGFuZCByZW1vdmVzIHRoZVxuICAgICAqIGAuY2l2aWhyLXBvcHVwLW9wZW5gIGNsYXNzIGZyb20gdGhlIGJvZHkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvc2VQb3B1cFBhbmVscyAoKSB7XG4gICAgICAkKCcuY2l2aWhyLXBvcHVwJykucmVtb3ZlKCk7XG4gICAgICAkYm9keS5yZW1vdmVDbGFzcygnY2l2aWhyLXBvcHVwLW9wZW4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgdGhlIHBvcHVwIGVsZW1lbnQgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGRvY3VtZW50IGJvZHkuXG4gICAgICogVGhpcyBwcmV2ZW50cyB0aGUgcG9wdXAgdG8gYmUgaGlkZGVuIGJ5IGFueSBgb3ZlcmZsb3c6IGhpZGRlbjtgIHJ1bGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUG9wdXBDbG9uZSAoKSB7XG4gICAgICAkcG9wdXBDbG9uZSA9ICRwb3B1cC5jbG9uZSh0cnVlKVxuICAgICAgICAuYXBwZW5kVG8oJGJvZHkpXG4gICAgICAgIC5hZGRDbGFzcygnY2l2aWhyLXBvcHVwJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlzdGVucyB0byBtb3VzZSBldmVudHMgaGFwcGVuaW5nIG91dHNpZGUgdGhlIG9mIHRoZSBwYW5lbCBpbiBvcmRlciB0b1xuICAgICAqIGNsb3NlIGl0LiBUaGUgd2F5IHRvIGRldGVjdGVkIG1vdXNlIG91dCBpcyBieSBsaXN0ZW5pbmcgdG8gdGhlXG4gICAgICogLmJ0bi1zbGlkZS1hY3RpdmUgY2xhc3MgY2hhbmdlLCB3aGljaCBpcyBhZGRlZCBhbmQgcmVtb3ZlZCBieSBDaXZpQ1JNLlxuICAgICAqIHRoZSBkYXRhICphdHRyY2hhbmdlLWlzLW9uKiBpcyBzZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBhdm9pZCBhZGRpbmdcbiAgICAgKiBtdWx0aXBsZSBsaXN0ZW5lcnMgdG8gdGhlIHNhbWUgZWxlbWVudC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsaXN0ZW5Ub01vdXNlT3V0RXZlbnQgKCkge1xuICAgICAgLy8gSWYgQXR0ckNoYW5nZSBldmVudCBpcyBhbHJlYWR5IGxpc3RlbmVkLCB0aGVuIHNraXA6XG4gICAgICBpZiAoJGJ1dHRvbi5kYXRhKCdhdHRyY2hhbmdlLWlzLW9uJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAkYnV0dG9uLmRhdGEoJ2F0dHJjaGFuZ2UtaXMtb24nLCB0cnVlKTtcbiAgICAgICRidXR0b24uYXR0cmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIElmIGJ1dHRvbiBpcyBhbHJlYWR5IG9wZW4sIHRoZW4gc2tpcDpcbiAgICAgICAgaWYgKCRidXR0b24uaGFzQ2xhc3MoJ2J0bi1zbGlkZS1hY3RpdmUnKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsb3NlUG9wdXBQYW5lbHMoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcHMgY2xpY2sgZXZlbnRzIG9uIHRoZSBwb3B1cCBvcHRpb25zIGJhY2sgdG8gdGhlaXIgb3JpZ2luYWwgc291cmNlLlxuICAgICAqIFRoaXMgaXMgZG9uZSBiZWNhdXNlIHBvcHVwIGFjdGlvbnMgYXJlIGV4ZWN1dGVkIGFzIGRlbGVnYXRlZCBldmVudHMgYW5kXG4gICAgICogdGhlIGxpc3RlbmVyIGlzIG5vdCB0aGUgKmJvZHkqIGVsZW1lbnQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwQ2xvbmVDbGlja0V2ZW50c1RvT3JpZ2luICgpIHtcbiAgICAgICRwb3B1cENsb25lLmZpbmQoJ2EnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhY3Rpb25JbmRleCA9ICQodGhpcykucGFyZW50KCkuaW5kZXgoKTtcblxuICAgICAgICAkcG9wdXAuZmluZCgnbGk6bnRoKCcgKyBhY3Rpb25JbmRleCArICcpIGEnKS5jbGljaygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIHBvcHVwIHBhbmVsIGNsb25lXG4gICAgICogYW5kIGFkZHMgdGhlIC5jaXZpaHItcG9wdXAtb3BlbiBjbGFzcyB0byB0aGUgYm9keVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9wZW5Qb3B1cENsb25lICgpIHtcbiAgICAgIHZhciBidXR0b25PZmZzZXQgPSAkYnV0dG9uLm9mZnNldCgpO1xuXG4gICAgICAkcG9wdXBDbG9uZS5jc3Moe1xuICAgICAgICBsZWZ0OiArYnV0dG9uT2Zmc2V0LmxlZnQgLSAoJHBvcHVwQ2xvbmUud2lkdGgoKSAtICRidXR0b24ub3V0ZXJXaWR0aCgpKSxcbiAgICAgICAgdG9wOiArYnV0dG9uT2Zmc2V0LnRvcCArICRidXR0b24ub3V0ZXJIZWlnaHQoKVxuICAgICAgfSk7XG4gICAgICAkcG9wdXBDbG9uZS5zaG93KCk7XG4gICAgICAkYm9keS5hZGRDbGFzcygnY2l2aWhyLXBvcHVwLW9wZW4nKTtcbiAgICB9XG4gIH0pO1xufSkoQ1JNLiQpO1xuIl19
