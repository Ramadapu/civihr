!function(t,o){function n(o){o&&o.departments&&o.departments.length>0?t(".crm-contact-detail-departments").html("<strong>Department:</strong> "+o.departments.join(", ")):t(".crm-contact-detail-departments").html("")}t(document).on("crmLoad",function(o){t(".crm-inline-edit").one("DOMSubtreeModified",function(){var o=t(this).find("form");1===o.length&&o.find("label").each(function(){var o=t(this),n=o.attr("for");t("#"+n).attr("placeholder",o.text())})})}).on("updateContactHeader",function(o,c){var a;void 0!==c.contract&&((a=c.contract)?(t(".crm-summary-contactname-block").removeClass("crm-summary-contactname-block-without-contract"),a.position&&t(".crm-contact-detail-position").html("<strong>Position:</strong> "+a.position),a.location&&t(".crm-contact-detail-location").html("<strong>Normal place of work:</strong> "+a.location)):(t(".crm-summary-contactname-block").addClass("crm-summary-contactname-block-without-contract"),t(".crm-contact-detail-position").html(""),t(".crm-contact-detail-location").html(""),n(null))),void 0!==c.roles&&n(c.roles)})}(CRM.$,CRM._);
!function(e,t){function a(){var t=e(this)[0].files[0];e("#js-uploaded-file").remove(),void 0!==t&&(e(this).after('<span id="js-uploaded-file" class="uploaded-file">'+t.name+' <span class="uploaded-file-icon-trash"><i class="fa fa-trash-o"></i> Remove</span>'),e(".uploaded-file-icon-trash").on("click",o))}function r(e){e.find("label").attr("for",e.find(".crm-form-date").attr("id"))}function o(){var t=e("#js-uploaded-file").parent().find('input[type="file"]');e("#js-uploaded-file").remove(),t.val("")}e(document).on("crmLoad",function(t){var o,i,n,c;1===e(o="input[type='file']").length&&e(o).on("change",a),1===e(".CRM_HRRecruitment_Form_HRVacancy").length&&(r(e('label[for="start_date"]').parents("tr")),r(e('label[for="end_date"]').parents("tr")),e('[name="entryURL"]').val().indexOf(";template=1")>-1&&e(e(".CRM_HRRecruitment_Form_HRVacancy tbody").get(0)).addClass("CRM_HRRecruitment_Form_HRVacancy_Template")),n=t,"contactForm"!==CRM.formName&&"viewSummary"!==CRM.pageName||(e(".crm-contact-job_title",".crm-summary-contactinfo-block").length&&e(".crm-contact-tabs-list #tab_summary a",n.target).text("Personal Details"),n.target,(i=e(".Inline_Custom_Data")).length&&i.removeClass("crm-collapsible collapsed").addClass("crm-summary-block").insertAfter(".crm-summary-contactinfo-block").find(".collapsible-title").hide().end().find(".crm-summary-block").show(),e("#customFields").length<1&&(e("#Inline_Custom_Data label").each(function(){e("#nick_name").parent().after('<td id="customFields"></td>');var t=e(this).attr("for"),a=e("#"+t).detach();e("#customFields").append(e(this)),e("#customFields").append(a)}),e("#Inline_Custom_Data").remove()),c=n.target,e("div.crm-contact-current_employer, div.crm-contact-job_title",".crm-summary-contactinfo-block").parent("div.crm-summary-row").hide(),e("form#ContactInfo input#employer_id, form#ContactInfo input#job_title",c).closest("div.crm-summary-row").hide(),e("input#employer_id, input#job_title","form#Contact").parent("td").hide(),e(".HRJobContract_Summary",c).insertBefore(e(".crm-summary-contactinfo-block")),e("div.email-signature, td#Email-Bulkmail-html","form#Contact").hide(),e("#Email-Primary","form#Contact").prev("td").prev("td").hide(),e("td#Email-Bulkmail-html, #Email-Primary","form#Contact").prev("td").hide(),e(".crm-demographics-accordion","form#Contact").insertAfter(e(".crm-contactDetails-accordion")),e("tr#Phone_Block_2","form#Contact").length<1&&e("#addPhone").click()),e("#activityCustomData").attr("colspan",3),e("#crm-activity-view-table .crm-case-activity-view-Client .label").html("Contact"),e("span.crm-frozen-field",".crm-profile-name-hrident_tab").closest("div").parent("div").hide(),e(".crm-accordion-header.crm-master-accordion-header").on("click",function(){window.setTimeout(function(){Array.prototype.forEach.call(document.querySelectorAll(".listing-box"),function(e){Ps.initialize(e)})},0)}),e("INPUT#contact_source").parent("td").children("a").click(function(){e("#crm-notification-container .crm-help .notify-content").remove(),e("#crm-notification-container .crm-help p").length&&e("#crm-notification-container .crm-help p").remove(),e("#crm-notification-container .crm-help").append("<p>Source is a useful field where data has been migrated to CiviHR from one or a number of other legacy systems. The Source field will indicate which legacy system the contact has come from.</p>")})}).ready(function(){var t,a,r,o,i,n;e.ajax("/civicrm/hrcore/usermenu?snippet=4",{dataType:"html",success:function(t){var a,r,o;a="civihr-menu",r=e(t),(o=e("<div>")).attr("id",a),o.append(e("#civicrm-menu")),o.append(r),o.insertAfter("#page")}}),t=e(".crm-link-home"),a=e(".crm-logo-sm",t).addClass("chr_logo chr_logo--default-color").removeClass("crm-logo-sm").wrap('<span class="menumain-icon">').parent(),o=a,r=e("li > a",t).first().text("Home").wrapInner('<span class="menumain-label">').prepend(o),i=r,t.off().find("#civicrm-home").before(i).remove(),e(".CRM_HRRecruitment_Form_Application").addClass("crm-form-block"),e(".CRM_HRRecruitment_Form_Application .crm-profile-name-application_profile").addClass("form-layout-compressed"),e("#root-menu-div .menu-item-arrow").each(function(t){var a=e(this);a.before('<i class="fa fa-caret-right menu-item-arrow"></i>'),a.remove()}),n="activetarget",e(".menumain").not(".crm-Self_Service_Portal").hover(function(){e(this).addClass(n)},function(){e(this).removeClass(n)})})}(CRM.$,CRM._);
!function(t){"use strict";var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t.fn.attrchange=function(t){if(n){var e={subtree:!1,attributes:!0},i=new n(function(n){n.forEach(function(n){t.call(n.target,n)})});return this.each(function(){i.observe(this,e)})}}}(CRM.$);
!function(t){"use strict";var i=t("body");i.on("click","#bootstrap-theme .btn-slide",function(){var n,a,e=t(this),o=e.children("ul.panel");function c(){t(".civihr-popup").remove(),i.removeClass("civihr-popup-open")}c(),n=o.clone(!0).appendTo(i).addClass("civihr-popup"),a=e.offset(),n.css({left:+a.left-(n.width()-e.outerWidth()),top:+a.top+e.outerHeight()}),n.show(),i.addClass("civihr-popup-open"),n.find("a").click(function(){var i=t(this).parent().index();o.find("li:nth("+i+") a").click()}),e.data("attrchange-is-on")||(e.data("attrchange-is-on",!0),e.attrchange(function(){e.hasClass("btn-slide-active")||c()}))})}(CRM.$);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3QuanMiLCJocnVpLmpzIiwiY2l2aWhyLXBvcHVwL2F0dHJjaGFuZ2UuanMiLCJjaXZpaHItcG9wdXAvY2l2aWhyLXBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJfIiwidXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyIsInJvbGVzIiwiZGVwYXJ0bWVudHMiLCJsZW5ndGgiLCJodG1sIiwiam9pbiIsImRvY3VtZW50Iiwib24iLCJlIiwib25lIiwiJGZvcm0iLCJ0aGlzIiwiZmluZCIsImVhY2giLCIkbGFiZWwiLCJpZCIsImF0dHIiLCJ0ZXh0IiwiZGF0YSIsImNvbnRyYWN0IiwicmVtb3ZlQ2xhc3MiLCJwb3NpdGlvbiIsImxvY2F0aW9uIiwiYWRkQ2xhc3MiLCJDUk0iLCJpbnNlcnRGaWxlIiwiZmlsZU5hbWUiLCJmaWxlcyIsInJlbW92ZSIsInVuZGVmaW5lZCIsImFmdGVyIiwibmFtZSIsInJlbW92ZUZpbGUiLCJsaW5rTGFiZWxUb0RhdGVwaWNrZXJJbnB1dCIsIiRsaW5lIiwiJGlucHV0IiwicGFyZW50IiwidmFsIiwic2VsZWN0b3IiLCIkaW5saW5lRGF0YUJsb2NrIiwidGFyZ2V0IiwicGFyZW50cyIsImluZGV4T2YiLCJnZXQiLCJmb3JtTmFtZSIsInBhZ2VOYW1lIiwiaW5zZXJ0QWZ0ZXIiLCJoaWRlIiwiZW5kIiwic2hvdyIsIm5vZGVJRCIsImN1c3RvbUZpZWxkIiwiZGV0YWNoIiwiYXBwZW5kIiwiY2xvc2VzdCIsImluc2VydEJlZm9yZSIsInByZXYiLCJjbGljayIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJBcnJheSIsInByb3RvdHlwZSIsImZvckVhY2giLCJjYWxsIiwicXVlcnlTZWxlY3RvckFsbCIsImVsZW1lbnQiLCJQcyIsImluaXRpYWxpemUiLCJjaGlsZHJlbiIsInJlYWR5IiwiJG1lbnVJdGVtIiwiJHdyYXBwZWRMb2dvIiwiJGN1c3RvbUhvbWVMaW5rIiwiJGFwcExvZ28iLCIkaG9tZUxpbmsiLCJjbGFzc05hbWUiLCJhamF4IiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwibWVudU1hcmt1cCIsIndyYXBwZXJJZCIsIiRtZW51TWFya3VwIiwiJG1lbnVXcmFwcGVyIiwid3JhcCIsImZpcnN0Iiwid3JhcElubmVyIiwicHJlcGVuZCIsIm9mZiIsImJlZm9yZSIsIiRlbGVtZW50IiwiJGFycm93Iiwibm90IiwiaG92ZXIiLCJNdXRhdGlvbk9ic2VydmVyIiwiV2ViS2l0TXV0YXRpb25PYnNlcnZlciIsIk1vek11dGF0aW9uT2JzZXJ2ZXIiLCJmbiIsImF0dHJjaGFuZ2UiLCJjYWxsYmFjayIsIm9wdGlvbnMiLCJzdWJ0cmVlIiwiYXR0cmlidXRlcyIsIm9ic2VydmVyIiwibXV0YXRpb25zIiwib2JzZXJ2ZSIsIiRib2R5IiwiJHBvcHVwQ2xvbmUiLCJidXR0b25PZmZzZXQiLCIkYnV0dG9uIiwiJHBvcHVwIiwiY2xvc2VQb3B1cFBhbmVscyIsImNsb25lIiwiYXBwZW5kVG8iLCJvZmZzZXQiLCJjc3MiLCJsZWZ0Iiwid2lkdGgiLCJvdXRlcldpZHRoIiwidG9wIiwib3V0ZXJIZWlnaHQiLCJhY3Rpb25JbmRleCIsImluZGV4IiwiaGFzQ2xhc3MiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEVBQUdDLEdBd0RaLFNBQVNDLEVBQWdDQyxHQUNuQ0EsR0FBU0EsRUFBTUMsYUFBZUQsRUFBTUMsWUFBWUMsT0FBUyxFQUMzREwsRUFBRSxtQ0FBbUNNLEtBQUssZ0NBQWtDSCxFQUFNQyxZQUFZRyxLQUFLLE9BRW5HUCxFQUFFLG1DQUFtQ00sS0FBSyxJQTFEOUNOLEVBQUVRLFVBQ0NDLEdBQUcsVUFBVyxTQUFTQyxHQUN0QlYsRUFBRSxvQkFBb0JXLElBQUkscUJBQXNCLFdBQzlDLElBQUlDLEVBQVFaLEVBQUVhLE1BQU1DLEtBQUssUUFFSixJQUFqQkYsRUFBTVAsUUFDUk8sRUFBTUUsS0FBSyxTQUFTQyxLQUFLLFdBQ3ZCLElBQUlDLEVBQVNoQixFQUFFYSxNQUNYSSxFQUFLRCxFQUFPRSxLQUFLLE9BQ3JCbEIsRUFB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QkFBK0IsV0FDL0MsSUFBSW1HLEVBeUVFQyxFQXhFRkMsRUFBVTlHLEVBQUVhLE1BQ1prRyxFQUFTRCxFQUFReEMsU0FBUyxZQWM5QixTQUFTMEMsSUFDUGhILEVBQUUsaUJBQWlCOEIsU0FDbkI2RSxFQUFNckYsWUFBWSxxQkFibEIwRixJQXFCQUosRUFBY0csRUFBT0UsT0FBTSxHQUN4QkMsU0FBU1AsR0FDVGxGLFNBQVMsZ0JBNkNSb0YsRUFBZUMsRUFBUUssU0FFM0JQLEVBQVlRLEtBQ1ZDLE1BQU9SLEVBQWFRLE1BQVFULEVBQVlVLFFBQVVSLEVBQVFTLGNBQzFEQyxLQUFNWCxFQUFhVyxJQUFNVixFQUFRVyxnQkFFbkNiLEVBQVl6RCxPQUNad0QsRUFBTWxGLFNBQVMscUJBbkJmbUYsRUFBWTlGLEtBQUssS0FBSzZDLE1BQU0sV0FDMUIsSUFBSStELEVBQWMxSCxFQUFFYSxNQUFNeUIsU0FBU3FGLFFBRW5DWixFQUFPakcsS0FBSyxVQUFZNEcsRUFBYyxPQUFPL0QsVUF4QjNDbUQsRUFBUTFGLEtBQUssc0JBSWpCMEYsRUFBUTFGLEtBQUssb0JBQW9CLEdBQ2pDMEYsRUFBUVgsV0FBVyxXQUViVyxFQUFRYyxTQUFTLHFCQUlyQlosU0F4RFIsQ0F3Rkd0RixJQUFJMUIiLCJmaWxlIjoiaHJ1aS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCQsIF8pIHtcblxuICAkKGRvY3VtZW50KVxuICAgIC5vbignY3JtTG9hZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICQoJy5jcm0taW5saW5lLWVkaXQnKS5vbmUoJ0RPTVN1YnRyZWVNb2RpZmllZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJGZvcm0gPSAkKHRoaXMpLmZpbmQoJ2Zvcm0nKTtcblxuICAgICAgICBpZiAoJGZvcm0ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgJGZvcm0uZmluZCgnbGFiZWwnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyICRsYWJlbCA9ICQodGhpcyk7XG4gICAgICAgICAgICB2YXIgaWQgPSAkbGFiZWwuYXR0cignZm9yJyk7XG4gICAgICAgICAgICAkKCcjJyArIGlkKS5hdHRyKCdwbGFjZWhvbGRlcicsICRsYWJlbC50ZXh0KCkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gICAgLm9uKCd1cGRhdGVDb250YWN0SGVhZGVyJywgZnVuY3Rpb24gKGUsIGRhdGEpIHtcbiAgICAgIGlmICh0eXBlb2YgZGF0YS5jb250cmFjdCAhPT0gJ3VuZGVmaW5lZCcpICB7XG4gICAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMoZGF0YS5jb250cmFjdCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgZGF0YS5yb2xlcyAhPT0gJ3VuZGVmaW5lZCcpICB7XG4gICAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJSb2xlc0RldGFpbHMoZGF0YS5yb2xlcyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRhY3QgaGVhZGVyIHdpdGggdGhlIGdpdmVuIGNvbnRyYWN0IGRldGFpbHNcbiAgICpcbiAgICogQHBhcmFtICB7b2JqZWN0fSBjb250cmFjdFxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlQ29udGFjdEhlYWRlckNvbnRyYWN0RGV0YWlscyhjb250cmFjdCkge1xuICAgIGlmIChjb250cmFjdCkgIHtcbiAgICAgICQoJy5jcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jaycpLnJlbW92ZUNsYXNzKCdjcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jay13aXRob3V0LWNvbnRyYWN0Jyk7XG5cbiAgICAgIGlmIChjb250cmFjdC5wb3NpdGlvbikge1xuICAgICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLXBvc2l0aW9uJykuaHRtbCgnPHN0cm9uZz5Qb3NpdGlvbjo8L3N0cm9uZz4gJysgY29udHJhY3QucG9zaXRpb24pO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29udHJhY3QubG9jYXRpb24pIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1sb2NhdGlvbicpLmh0bWwoJzxzdHJvbmc+Tm9ybWFsIHBsYWNlIG9mIHdvcms6PC9zdHJvbmc+ICcrIGNvbnRyYWN0LmxvY2F0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJCgnLmNybS1zdW1tYXJ5LWNvbnRhY3RuYW1lLWJsb2NrJykuYWRkQ2xhc3MoJ2NybS1zdW1tYXJ5LWNvbnRhY3RuYW1lLWJsb2NrLXdpdGhvdXQtY29udHJhY3QnKTtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtcG9zaXRpb24nKS5odG1sKCcnKTtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtbG9jYXRpb24nKS5odG1sKCcnKTtcblxuICAgICAgdXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyhudWxsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY29udGFjdCBoZWFkZXIgd2l0aCB0aGUgZ2l2ZW4gcm9sZXMgZGV0YWlsc1xuICAgKlxuICAgKiBAcGFyYW0gIHtvYmplY3R9IGNvbnRyYWN0XG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVDb250YWN0SGVhZGVyUm9sZXNEZXRhaWxzKHJvbGVzKSB7XG4gICAgaWYgKHJvbGVzICYmIHJvbGVzLmRlcGFydG1lbnRzICYmIHJvbGVzLmRlcGFydG1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtZGVwYXJ0bWVudHMnKS5odG1sKCc8c3Ryb25nPkRlcGFydG1lbnQ6PC9zdHJvbmc+ICcgKyByb2xlcy5kZXBhcnRtZW50cy5qb2luKCcsICcpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1kZXBhcnRtZW50cycpLmh0bWwoJycpO1xuICAgIH1cbiAgfVxufShDUk0uJCwgQ1JNLl8pKTtcbiIsIi8qIGdsb2JhbCBQcyAqL1xuXG4vLyBDb3B5cmlnaHQgQ2l2aUNSTSBMTEMgMjAxMy4gU2VlIGh0dHA6Ly9jaXZpY3JtLm9yZy9saWNlbnNpbmdcbihmdW5jdGlvbiAoJCwgXykge1xuICAkKGRvY3VtZW50KVxuICAgIC5vbignY3JtTG9hZCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBhZGRVcGxvYWRGaWxlTGlzdGVuZXIoXCJpbnB1dFt0eXBlPSdmaWxlJ11cIik7XG4gICAgICBhbWVuZFZhY2FuY3lGb3JtKCk7XG4gICAgICBhbWVuZENvbnRhY3RQYWdlQW5kRm9ybShlKTtcbiAgICAgIGFwcGx5TWlzY0NoYW5nZXMoKTtcbiAgICAgIGNoYW5nZUNvbnRhY3RTb3VyY2VGaWVsZEhlbHBUZXh0KCk7XG4gICAgfSlcbiAgICAucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgYWRkVXNlck1lbnVUb01haW5NZW51KCk7XG4gICAgICBhbWVuZEFwcExvZ29NZW51SXRlbSgpO1xuICAgICAgYW1lbmRBcHBsaWNhdGlvbkZvcm0oKTtcbiAgICAgIHVzZUZvbnRBd2Vzb21lQXJyb3dzSW5TdWJNZW51SXRlbXMoKTtcbiAgICAgIHRvZ2dsZUFjdGl2ZUNsYXNzT25Ib3Zlck9uQW55TWFpbk1lbnVJdGVtKCk7XG4gICAgfSk7XG5cbiAgLyoqXG4gICAqIEN1c3RvbWl6ZXMgdGhlIGFwcCBsb2dvIG1lbnUgaXRlbSwgc3dpdGNoaW5nIGZyb20gdGhlIENpdmlDUk0gbG9nb1xuICAgKiB0byB0aGUgQ2l2aUhSIGxvZ28sIGFuZCBtYWtpbmcgdGhlIGl0ZW0gYSBkaXJlY3QgbGluayBpbnN0ZWFkIG9mIGFcbiAgICogdG9nZ2xlIGZvciBhIHN1YiBtZW51IGRyb3Bkb3duXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZEFwcExvZ29NZW51SXRlbSAoKSB7XG4gICAgdmFyICRtZW51SXRlbSA9ICQoJy5jcm0tbGluay1ob21lJyk7XG4gICAgdmFyICR3cmFwcGVkTG9nbyA9IHN3YXBBbmRXcmFwQXBwTG9nbygkbWVudUl0ZW0pO1xuICAgIHZhciAkY3VzdG9tSG9tZUxpbmsgPSBjdXN0b21pemVIb21lTGlua0luTG9nb01lbnVJdGVtKCRtZW51SXRlbSwgJHdyYXBwZWRMb2dvKTtcblxuICAgIHJlbW92ZUxvZ29TdWJNZW51QW5kS2VlcE9ubHlIb21lTGluaygkbWVudUl0ZW0sICRjdXN0b21Ib21lTGluayk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB0aGUgdXNlciBtZW51IGJ5IGZldGNoaW5nIGl0IGZyb20gdGhlIGhyY29yZSBleHRlbnNpb25cbiAgICovXG4gIGZ1bmN0aW9uIGFkZFVzZXJNZW51VG9NYWluTWVudSAoKSB7XG4gICAgJC5hamF4KCcvY2l2aWNybS9ocmNvcmUvdXNlcm1lbnU/c25pcHBldD00Jywge1xuICAgICAgZGF0YVR5cGU6ICdodG1sJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChtZW51TWFya3VwKSB7XG4gICAgICAgIGluamVjdFVzZXJNZW51SW5BTWFpbk1lbnVXcmFwcGVyKG1lbnVNYXJrdXAsICdjaXZpaHItbWVudScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhbiBldmVudCBsaXN0ZW5lciBvbiBpbnB1dFt0eXBlPVwiZmlsZVwiXVxuICAgKiBAcGFyYW0ge2pRdWVyeSBPYmplY3R9IHNlbGVjdG9yIFtzZWxlY3RvciBmcm9tIGlucHV0IGZpbGVdXG4gICAqL1xuICBmdW5jdGlvbiBhZGRVcGxvYWRGaWxlTGlzdGVuZXIgKHNlbGVjdG9yKSB7XG4gICAgaWYgKCQoc2VsZWN0b3IpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgJChzZWxlY3Rvcikub24oJ2NoYW5nZScsIGluc2VydEZpbGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIGFwcGxpY2F0aW9uIGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIGFtZW5kQXBwbGljYXRpb25Gb3JtICgpIHtcbiAgICAkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9BcHBsaWNhdGlvbicpLmFkZENsYXNzKCdjcm0tZm9ybS1ibG9jaycpO1xuICAgICQoJy5DUk1fSFJSZWNydWl0bWVudF9Gb3JtX0FwcGxpY2F0aW9uIC5jcm0tcHJvZmlsZS1uYW1lLWFwcGxpY2F0aW9uX3Byb2ZpbGUnKS5hZGRDbGFzcygnZm9ybS1sYXlvdXQtY29tcHJlc3NlZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFtZW5kcyB0aGUgY29udGFjdCBwYWdlIGFuZCB0aGUgY29udGFjdCBmb3JtXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZENvbnRhY3RQYWdlQW5kRm9ybSAoZSkge1xuICAgIGlmIChDUk0uZm9ybU5hbWUgPT09ICdjb250YWN0Rm9ybScgfHwgQ1JNLnBhZ2VOYW1lID09PSAndmlld1N1bW1hcnknKSB7XG4gICAgICAvLyBSZW5hbWUgXCJTdW1tYXJ5XCIgdGFiIHRvIFwiUGVyc29uYWwgRGV0YWlsc1wiXG4gICAgICAvLyBIYWNrIHRvIGNoZWNrIGNvbnRhY3QgdHlwZSAtIFRoaXMgZmllbGQgb25seSBhcHBlYXJzIGZvciBpbmRpdmlkdWFsc1xuICAgICAgaWYgKCQoJy5jcm0tY29udGFjdC1qb2JfdGl0bGUnLCAnLmNybS1zdW1tYXJ5LWNvbnRhY3RpbmZvLWJsb2NrJykubGVuZ3RoKSB7XG4gICAgICAgICQoJy5jcm0tY29udGFjdC10YWJzLWxpc3QgI3RhYl9zdW1tYXJ5IGEnLCBlLnRhcmdldCkudGV4dCgnUGVyc29uYWwgRGV0YWlscycpO1xuICAgICAgfVxuXG4gICAgICBtYW5pcHVsYXRlRE9NT2ZJbmxpbmVDdXN0b21EYXRhKGUudGFyZ2V0KTtcbiAgICAgIG1pc2NDb250YWN0UGFnZUNoYW5nZXMoZS50YXJnZXQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIHZhY2FuY3kgZm9ybVxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRWYWNhbmN5Rm9ybSAoKSB7XG4gICAgaWYgKCQoJy5DUk1fSFJSZWNydWl0bWVudF9Gb3JtX0hSVmFjYW5jeScpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgbGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQoJCgnbGFiZWxbZm9yPVwic3RhcnRfZGF0ZVwiXScpLnBhcmVudHMoJ3RyJykpO1xuICAgICAgbGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQoJCgnbGFiZWxbZm9yPVwiZW5kX2RhdGVcIl0nKS5wYXJlbnRzKCd0cicpKTtcblxuICAgICAgLy8gQWRkIGEgY2xhc3MgdG8gaWRlbnRpZnkgdGhlIGZvcm0gJ05ldyBWYWNhbmN5IFRlbXBsYXRlJ1xuICAgICAgaWYgKCQoJ1tuYW1lPVwiZW50cnlVUkxcIl0nKS52YWwoKS5pbmRleE9mKCc7dGVtcGxhdGU9MScpID4gLTEpIHtcbiAgICAgICAgJCgkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3kgdGJvZHknKS5nZXQoMCkpLmFkZENsYXNzKCdDUk1fSFJSZWNydWl0bWVudF9Gb3JtX0hSVmFjYW5jeV9UZW1wbGF0ZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBsaWVzIG1pc2NlbGxhbmVvdXMgVUkgY2hhbmdlc1xuICAgKi9cbiAgZnVuY3Rpb24gYXBwbHlNaXNjQ2hhbmdlcyAoKSB7XG4gICAgJCgnI2FjdGl2aXR5Q3VzdG9tRGF0YScpLmF0dHIoJ2NvbHNwYW4nLCAzKTtcbiAgICAkKCcjY3JtLWFjdGl2aXR5LXZpZXctdGFibGUgLmNybS1jYXNlLWFjdGl2aXR5LXZpZXctQ2xpZW50IC5sYWJlbCcpLmh0bWwoJ0NvbnRhY3QnKTtcbiAgICAkKCdzcGFuLmNybS1mcm96ZW4tZmllbGQnLCAnLmNybS1wcm9maWxlLW5hbWUtaHJpZGVudF90YWInKS5jbG9zZXN0KCdkaXYnKS5wYXJlbnQoJ2RpdicpLmhpZGUoKTtcblxuICAgICQoJy5jcm0tYWNjb3JkaW9uLWhlYWRlci5jcm0tbWFzdGVyLWFjY29yZGlvbi1oZWFkZXInKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpc3RpbmctYm94JyksIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgUHMuaW5pdGlhbGl6ZShlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9LCAwKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGFuZ2VzIG9mIHNvcmNlIGhlbHAgdGV4dFxuICAgKi9cbiAgZnVuY3Rpb24gY2hhbmdlQ29udGFjdFNvdXJjZUZpZWxkSGVscFRleHQgKCkge1xuICAgICQoJ0lOUFVUI2NvbnRhY3Rfc291cmNlJykucGFyZW50KCd0ZCcpLmNoaWxkcmVuKCdhJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCAubm90aWZ5LWNvbnRlbnQnKS5yZW1vdmUoKTtcblxuICAgICAgaWYgKCQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAgcCcpLmxlbmd0aCkge1xuICAgICAgICAkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwIHAnKS5yZW1vdmUoKTtcbiAgICAgIH1cblxuICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCcpLmFwcGVuZCgnPHA+U291cmNlIGlzIGEgdXNlZnVsIGZpZWxkIHdoZXJlIGRhdGEgaGFzIGJlZW4gbWlncmF0ZWQgdG8gQ2l2aUhSIGZyb20gb25lIG9yIGEgbnVtYmVyIG9mIG90aGVyIGxlZ2FjeSBzeXN0ZW1zLiBUaGUgU291cmNlIGZpZWxkIHdpbGwgaW5kaWNhdGUgd2hpY2ggbGVnYWN5IHN5c3RlbSB0aGUgY29udGFjdCBoYXMgY29tZSBmcm9tLjwvcD4nKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kcyB0aGUgb3JpZ2luYWwgbGluayB0byB0aGUgaG9tZXBhZ2UsIGNoYW5nZXMgdGhlIHRleHQsIHdyYXBzIGl0IGluIGFcbiAgICogYG1lbnVtYWluLWxhYmVsYCBlbGVtZW50IGFuZCBwcmVwZW5kcyBpbnRlcm5hbGx5IHRoZSBnaXZlbiBhcHAgbG9nb1xuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gJG1lbnVJdGVtIFRoZSBjb250ZXh0IHdoZXJlIHRvIGZpbmQgdGhlIGxpbmtcbiAgICogQHBhcmFtIHtvYmplY3R9ICRhcHBMb2dvXG4gICAqIEByZXR1cm4gdGhlIGN1c3RvbWl6ZWQgaG9tZSBsaW5rXG4gICAqL1xuICBmdW5jdGlvbiBjdXN0b21pemVIb21lTGlua0luTG9nb01lbnVJdGVtICgkbWVudUl0ZW0sICRhcHBMb2dvKSB7XG4gICAgdmFyICRob21lTGluayA9ICQoJ2xpID4gYScsICRtZW51SXRlbSkuZmlyc3QoKTtcblxuICAgIHJldHVybiAkaG9tZUxpbmtcbiAgICAgIC50ZXh0KCdIb21lJylcbiAgICAgIC53cmFwSW5uZXIoJzxzcGFuIGNsYXNzPVwibWVudW1haW4tbGFiZWxcIj4nKVxuICAgICAgLnByZXBlbmQoJGFwcExvZ28pO1xuICB9XG5cbiAgLyoqXG4gICAqIEluamVjdHMgdGhlIGdpdmVuIG1hcmt1cCBpbiBhIG1lbnUgd3JhcHBlciB3aXRoIHRoZSBnaXZlbiBpZFxuICAgKiBjcmVhdGVkIHRvIGNvbnRhaW4gYm90aCB0aGUgb3JpZ2luYWwgbWVudSBhbmQgdGhlIHVzZXIgb25lXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZW51TWFya3VwXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB3cmFwcGVySWRcbiAgICovXG4gIGZ1bmN0aW9uIGluamVjdFVzZXJNZW51SW5BTWFpbk1lbnVXcmFwcGVyIChtZW51TWFya3VwLCB3cmFwcGVySWQpIHtcbiAgICB2YXIgJG1lbnVNYXJrdXAgPSAkKG1lbnVNYXJrdXApO1xuICAgIHZhciAkbWVudVdyYXBwZXIgPSAkKCc8ZGl2PicpO1xuXG4gICAgJG1lbnVXcmFwcGVyLmF0dHIoJ2lkJywgd3JhcHBlcklkKTtcbiAgICAkbWVudVdyYXBwZXIuYXBwZW5kKCQoJyNjaXZpY3JtLW1lbnUnKSk7XG4gICAgJG1lbnVXcmFwcGVyLmFwcGVuZCgkbWVudU1hcmt1cCk7XG4gICAgJG1lbnVXcmFwcGVyLmluc2VydEFmdGVyKCcjcGFnZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluc2VydCBhIERPTSBub2RlIGFmdGVyIGlucHV0W3R5cGU9XCJmaWxlXCJdXG4gICAqIHdpdGggdGhlIGZpbGVuYW1lXG4gICAqL1xuICBmdW5jdGlvbiBpbnNlcnRGaWxlICgpIHtcbiAgICB2YXIgZmlsZU5hbWUgPSAkKHRoaXMpWzBdLmZpbGVzWzBdO1xuXG4gICAgJCgnI2pzLXVwbG9hZGVkLWZpbGUnKS5yZW1vdmUoKTtcbiAgICBpZiAoZmlsZU5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgJCh0aGlzKS5hZnRlcignPHNwYW4gaWQ9XCJqcy11cGxvYWRlZC1maWxlXCIgY2xhc3M9XCJ1cGxvYWRlZC1maWxlXCI+JyArIGZpbGVOYW1lLm5hbWUgKyAnIDxzcGFuIGNsYXNzPVwidXBsb2FkZWQtZmlsZS1pY29uLXRyYXNoXCI+PGkgY2xhc3M9XCJmYSBmYS10cmFzaC1vXCI+PC9pPiBSZW1vdmU8L3NwYW4+Jyk7XG5cbiAgICAgICQoJy51cGxvYWRlZC1maWxlLWljb24tdHJhc2gnKS5vbignY2xpY2snLCByZW1vdmVGaWxlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGxhYmVsICdmb3InIGF0dHIgdG8gd29ya3Mgd2l0aCB0aGUgZGF0ZXBpY2tlclxuICAgKlxuICAgKiBAcGFyYW0gIHtqUXVlcnkgb2JqZWN0fSAkbGluZSBbZGF0ZXBpY2tlcidzIGxpbmUgcGFyZW50XVxuICAgKi9cbiAgZnVuY3Rpb24gbGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQgKCRsaW5lKSB7XG4gICAgJGxpbmUuZmluZCgnbGFiZWwnKS5hdHRyKCdmb3InLCAkbGluZS5maW5kKCcuY3JtLWZvcm0tZGF0ZScpLmF0dHIoJ2lkJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIE1hbmlwdWxhdGVzLCBhdCB0aGUgRE9NIGxldmVsLCB0aGUgYmxvY2tzL2ZpZWxkcyBiZWxvbmdpbmcgdG8gdGhlXG4gICAqIElubGluZSBDdXN0b20gRGF0YSBjdXN0b20gZmllbGRzIHNldFxuICAgKi9cbiAgZnVuY3Rpb24gbWFuaXB1bGF0ZURPTU9mSW5saW5lQ3VzdG9tRGF0YSAoKSB7XG4gICAgLy8gSW4gUGVyc29uYWwgRGV0YWlscyBQYWdlXG4gICAgdmFyICRpbmxpbmVEYXRhQmxvY2sgPSAkKCcuSW5saW5lX0N1c3RvbV9EYXRhJyk7XG5cbiAgICBpZiAoJGlubGluZURhdGFCbG9jay5sZW5ndGgpIHtcbiAgICAgICRpbmxpbmVEYXRhQmxvY2tcbiAgICAgICAgLnJlbW92ZUNsYXNzKCdjcm0tY29sbGFwc2libGUgY29sbGFwc2VkJylcbiAgICAgICAgLmFkZENsYXNzKCdjcm0tc3VtbWFyeS1ibG9jaycpXG4gICAgICAgIC5pbnNlcnRBZnRlcignLmNybS1zdW1tYXJ5LWNvbnRhY3RpbmZvLWJsb2NrJylcbiAgICAgICAgLmZpbmQoJy5jb2xsYXBzaWJsZS10aXRsZScpLmhpZGUoKS5lbmQoKVxuICAgICAgICAuZmluZCgnLmNybS1zdW1tYXJ5LWJsb2NrJykuc2hvdygpO1xuICAgIH1cblxuICAgIC8vIEluIEVkaXQgQ29udGFjdCBGb3JtXG4gICAgaWYgKCQoJyNjdXN0b21GaWVsZHMnKS5sZW5ndGggPCAxKSB7XG4gICAgICAkKCcjSW5saW5lX0N1c3RvbV9EYXRhIGxhYmVsJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJyNuaWNrX25hbWUnKS5wYXJlbnQoKS5hZnRlcignPHRkIGlkPVwiY3VzdG9tRmllbGRzXCI+PC90ZD4nKTtcbiAgICAgICAgdmFyIG5vZGVJRCA9ICQodGhpcykuYXR0cignZm9yJyk7XG4gICAgICAgIHZhciBjdXN0b21GaWVsZCA9ICQoJyMnICsgbm9kZUlEKS5kZXRhY2goKTtcbiAgICAgICAgJCgnI2N1c3RvbUZpZWxkcycpLmFwcGVuZCgkKHRoaXMpKTtcbiAgICAgICAgJCgnI2N1c3RvbUZpZWxkcycpLmFwcGVuZChjdXN0b21GaWVsZCk7XG4gICAgICB9KTtcblxuICAgICAgJCgnI0lubGluZV9DdXN0b21fRGF0YScpLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNaXNjIGNoYW5nZXMgdG8gdGhlIHBhZ2UgKGhpZGluZyBlbGVtZW50cywgaW5zZXJ0aW5nIG5ldyBvbmVzLCBldGMpXG4gICAqL1xuICBmdW5jdGlvbiBtaXNjQ29udGFjdFBhZ2VDaGFuZ2VzICh0YXJnZXQpIHtcbiAgICAvLyBIaWRlIGN1cnJlbnQgZW1wbG95ZXIgYW5kIGpvYiB0aXRsZVxuICAgIC8vIENvbnRhY3Qgc3VtbWFyeSBzY3JlZW46XG4gICAgJCgnZGl2LmNybS1jb250YWN0LWN1cnJlbnRfZW1wbG95ZXIsIGRpdi5jcm0tY29udGFjdC1qb2JfdGl0bGUnLCAnLmNybS1zdW1tYXJ5LWNvbnRhY3RpbmZvLWJsb2NrJykucGFyZW50KCdkaXYuY3JtLXN1bW1hcnktcm93JykuaGlkZSgpO1xuICAgIC8vIElubGluZSBlZGl0IGZvcm1cbiAgICAkKCdmb3JtI0NvbnRhY3RJbmZvIGlucHV0I2VtcGxveWVyX2lkLCBmb3JtI0NvbnRhY3RJbmZvIGlucHV0I2pvYl90aXRsZScsIHRhcmdldCkuY2xvc2VzdCgnZGl2LmNybS1zdW1tYXJ5LXJvdycpLmhpZGUoKTtcbiAgICAvLyBDb250YWN0IGVkaXQgc2NyZWVuXG4gICAgJCgnaW5wdXQjZW1wbG95ZXJfaWQsIGlucHV0I2pvYl90aXRsZScsICdmb3JtI0NvbnRhY3QnKS5wYXJlbnQoJ3RkJykuaGlkZSgpO1xuXG4gICAgLyogQ2hhbmdlcyBvbiBBZGQgSW5kaXZpZHVhbCBwYWdlcyBhbmQgUGVyc29uYWwgZGV0YWlscyB0YWIgZm9yIEhSLTM1OCAqL1xuICAgIC8vIE1vdmUgSm9iIHN1bW1hcnkgdG8gdG9wXG4gICAgJCgnLkhSSm9iQ29udHJhY3RfU3VtbWFyeScsIHRhcmdldCkuaW5zZXJ0QmVmb3JlKCQoJy5jcm0tc3VtbWFyeS1jb250YWN0aW5mby1ibG9jaycpKTtcbiAgICAvLyBjaGFuZ2VzIG9mIGVtYWlsIGJsb2NrLCByZW1vdmUgYnVsa21haWwgYW5kIG9uaG9sZFxuICAgICQoJ2Rpdi5lbWFpbC1zaWduYXR1cmUsIHRkI0VtYWlsLUJ1bGttYWlsLWh0bWwnLCAnZm9ybSNDb250YWN0JykuaGlkZSgpO1xuICAgICQoJyNFbWFpbC1QcmltYXJ5JywgJ2Zvcm0jQ29udGFjdCcpLnByZXYoJ3RkJykucHJldigndGQnKS5oaWRlKCk7XG4gICAgJCgndGQjRW1haWwtQnVsa21haWwtaHRtbCwgI0VtYWlsLVByaW1hcnknLCAnZm9ybSNDb250YWN0JykucHJldigndGQnKS5oaWRlKCk7XG5cbiAgICAvLyBzaGlmdCBkZW1vZ3JhcGhpYyBhYm92ZSBleHRlbmRlZCBkZW1vZ3JhcGhpY1xuICAgICQoJy5jcm0tZGVtb2dyYXBoaWNzLWFjY29yZGlvbicsICdmb3JtI0NvbnRhY3QnKS5pbnNlcnRBZnRlcigkKCcuY3JtLWNvbnRhY3REZXRhaWxzLWFjY29yZGlvbicpKTtcblxuICAgIGlmICgkKCd0ciNQaG9uZV9CbG9ja18yJywgJ2Zvcm0jQ29udGFjdCcpLmxlbmd0aCA8IDEpIHtcbiAgICAgICQoJyNhZGRQaG9uZScpLmNsaWNrKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgI2pzLXVwbG9hZGVkLWZpbGUgRElWIGFuZFxuICAgKiBjbGVhbiBpbnB1dFt0eXBlPVwiZmlsZVwiXSB2YWx1ZVxuICAgKi9cbiAgZnVuY3Rpb24gcmVtb3ZlRmlsZSAoKSB7XG4gICAgdmFyICRpbnB1dCA9ICQoJyNqcy11cGxvYWRlZC1maWxlJykucGFyZW50KCkuZmluZCgnaW5wdXRbdHlwZT1cImZpbGVcIl0nKTtcblxuICAgICQoJyNqcy11cGxvYWRlZC1maWxlJykucmVtb3ZlKCk7XG4gICAgJGlucHV0LnZhbCgnJyk7XG4gIH1cblxuICAvKipcbiAgICogTW92ZXMgdGhlIGdpdmVuIGhvbWUgbGluayByaWdodCB1bmRlciB0aGUgbWVudSBpdGVtIGFuZCBnZXRzIHJpZFxuICAgKiBvZiB0aGUgb3JpZ2luYWwgc3ViIG1lbnVcbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICRtZW51SXRlbSBUaGUgY29udGV4dCB3aGVyZSB0byBmaW5kIHRoZSBsaW5rXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkaG9tZUxpbmtcbiAgICovXG4gIGZ1bmN0aW9uIHJlbW92ZUxvZ29TdWJNZW51QW5kS2VlcE9ubHlIb21lTGluayAoJG1lbnVJdGVtLCAkaG9tZUxpbmspIHtcbiAgICAkbWVudUl0ZW1cbiAgICAgIC5vZmYoKSAvLyByZW1vdmVzIGFueSBoYW5kbGVyIHRoYXQgdGhlIG9yaWdpbmFsIGl0ZW0gaGFkXG4gICAgICAuZmluZCgnI2Npdmljcm0taG9tZScpXG4gICAgICAuYmVmb3JlKCRob21lTGluaylcbiAgICAgIC5yZW1vdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTd2FwcyB0aGUgQ2l2aUNSTSBsb2dvIHdpdGggdGhlIENpdmlIUiBsb2dvXG4gICAqIGFuZCB3cmFwcyBpdCBpbiBhIGBtZW51bWFpbi1pY29uYCBlbGVtZW50XG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAkbWVudUl0ZW0gVGhlIGNvbnRleHQgd2hlcmUgdG8gZmluZCB0aGUgbG9nb1xuICAgKiBAcmV0dXJuIHRoZSB3cmFwcGVyIG9mIHRoZSBsb2dvXG4gICAqL1xuICBmdW5jdGlvbiBzd2FwQW5kV3JhcEFwcExvZ28gKCRtZW51SXRlbSkge1xuICAgIHZhciAkYXBwTG9nbyA9ICQoJy5jcm0tbG9nby1zbScsICRtZW51SXRlbSk7XG5cbiAgICByZXR1cm4gJGFwcExvZ29cbiAgICAgIC5hZGRDbGFzcygnY2hyX2xvZ28gY2hyX2xvZ28tLWRlZmF1bHQtY29sb3InKVxuICAgICAgLnJlbW92ZUNsYXNzKCdjcm0tbG9nby1zbScpXG4gICAgICAud3JhcCgnPHNwYW4gY2xhc3M9XCJtZW51bWFpbi1pY29uXCI+JylcbiAgICAgIC5wYXJlbnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaXZpQ1JNIGJ5IGRlZmF1bHQgYXBwbGllcyBvbiBob3ZlciB0aGUgLmFjdGl2ZXRhcmdldCBjbGFzc1xuICAgKiBvbmx5IHRvIG1haW4gbWVudSBpdGVtcyB3aXRoIGEgc3VibWVudVxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBtYWtlcyBzdXJlIHRoYXQgYW55IGl0ZW0gZ2V0cyB0aGUgY2xhc3MgYXBwbGllZCxcbiAgICogZXZlbiB0aG9zZSB3aXRoIGp1c3QgYSBkaXJlY3QgbGlua1xuICAgKi9cbiAgZnVuY3Rpb24gdG9nZ2xlQWN0aXZlQ2xhc3NPbkhvdmVyT25BbnlNYWluTWVudUl0ZW0gKCkge1xuICAgIHZhciBjbGFzc05hbWUgPSAnYWN0aXZldGFyZ2V0JztcblxuICAgICQoJy5tZW51bWFpbicpLm5vdCgnLmNybS1TZWxmX1NlcnZpY2VfUG9ydGFsJykuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGFycm93IGZvciBtZW51IGl0ZW1zIHdpdGggc3ViLWl0ZW1zLCBhbmQgcmVwbGFjZXMgaXRcbiAgICogd2l0aCBhIGZvbnQgYXdlc29tZSBjYXJldFxuICAgKi9cbiAgZnVuY3Rpb24gdXNlRm9udEF3ZXNvbWVBcnJvd3NJblN1Yk1lbnVJdGVtcyAoKSB7XG4gICAgJCgnI3Jvb3QtbWVudS1kaXYgLm1lbnUtaXRlbS1hcnJvdycpLmVhY2goZnVuY3Rpb24gKCRlbGVtZW50KSB7XG4gICAgICB2YXIgJGFycm93ID0gJCh0aGlzKTtcblxuICAgICAgJGFycm93LmJlZm9yZSgnPGkgY2xhc3M9XCJmYSBmYS1jYXJldC1yaWdodCBtZW51LWl0ZW0tYXJyb3dcIj48L2k+Jyk7XG4gICAgICAkYXJyb3cucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cbn0oQ1JNLiQsIENSTS5fKSk7XG4iLCIoZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgTXV0YXRpb25PYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5Nb3pNdXRhdGlvbk9ic2VydmVyO1xuXG4gIC8qXG4gIFRoaXMgcGx1Z2luIGNyZWF0ZXMgTXV0YXRpb25PYnNlcnZlciB3aGljaCBsaXN0ZW5zIHRvIGFsbCBjaGFuZ2VzIHRvIERPTSBOb2RlLlxuICBJZiBjaGFuZ2UgaGFzIGJlZW4gZG9uZSB0byBpdCdzIGF0dHJpYnV0ZXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQuXG5cbiAgQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB0byBiZSBjYWxsZWQgd2hlbiBhdHRyaWJ1dGVzIGNoYW5nZVxuICBAcmV0dXJucyB7QXJyYXl9IC0gbGlzdCBvZiBhbGwgb2JzZXJ2ZWQgZWxlbWVudHNcbiAgKi9cbiAgJC5mbi5hdHRyY2hhbmdlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBzdWJ0cmVlOiBmYWxzZSxcbiAgICAgICAgYXR0cmlidXRlczogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwoZS50YXJnZXQsIGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLCBvcHRpb25zKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoQ1JNLiQpO1xuIiwiLyogZ2xvYmFscyBDUk0gKi9cblxuLyoqXG4gKiBIZWxwcyB0byBkaXNwbGF5IHBvcHVwIG1lbnVzIGluc2lkZSAjYm9vdHN0cmFwLXRoZW1lIGVsZW1lbnRzLCBzaW5jZSAucGFuZWwnc1xuICogYW5kIG90aGVyIEJvb3RzdHJhcCBlbGVtZW50cyBjbGFzaCB3aXRoIENpdmlDUk0gc3R5bGVzIHByb2R1Y2luZyB1bmRlc2lyZWRcbiAqIHJlc3VsdHMuXG4gKlxuICogSXQgYWxzbyBoZWxwcyB3aXRoIGV2ZW50IGJpbmRpbmdzLCBpbiBjYXNlIHRoZSBvcmlnaW5hbCBwb3B1cCBidXR0b24gd2FzXG4gKiByZW1vdmVkIGFuZCByZWNyZWF0ZWQsIGJ5IGZvcndhcmRpbmcgdGhlIGV2ZW50cyB0byB0aGUgb3JpZ2luYWwgc291cmNlLlxuICovXG4oZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7XG5cbiAgJGJvZHkub24oJ2NsaWNrJywgJyNib290c3RyYXAtdGhlbWUgLmJ0bi1zbGlkZScsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHBvcHVwQ2xvbmU7XG4gICAgdmFyICRidXR0b24gPSAkKHRoaXMpO1xuICAgIHZhciAkcG9wdXAgPSAkYnV0dG9uLmNoaWxkcmVuKCd1bC5wYW5lbCcpO1xuXG4gICAgKGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgY2xvc2VQb3B1cFBhbmVscygpO1xuICAgICAgY3JlYXRlUG9wdXBDbG9uZSgpO1xuICAgICAgb3BlblBvcHVwQ2xvbmUoKTtcbiAgICAgIG1hcENsb25lQ2xpY2tFdmVudHNUb09yaWdpbigpO1xuICAgICAgbGlzdGVuVG9Nb3VzZU91dEV2ZW50KCk7XG4gICAgfSkoKTtcblxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgYW55IHBvcHVwIHBhbmVsIHRoYXQgaXMgY3VycmVudGx5IG9wZW4gYW5kIHJlbW92ZXMgdGhlXG4gICAgICogYC5jaXZpaHItcG9wdXAtb3BlbmAgY2xhc3MgZnJvbSB0aGUgYm9keS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9zZVBvcHVwUGFuZWxzICgpIHtcbiAgICAgICQoJy5jaXZpaHItcG9wdXAnKS5yZW1vdmUoKTtcbiAgICAgICRib2R5LnJlbW92ZUNsYXNzKCdjaXZpaHItcG9wdXAtb3BlbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjbG9uZSBvZiB0aGUgcG9wdXAgZWxlbWVudCBhbmQgYXBwZW5kcyBpdCB0byB0aGUgZG9jdW1lbnQgYm9keS5cbiAgICAgKiBUaGlzIHByZXZlbnRzIHRoZSBwb3B1cCB0byBiZSBoaWRkZW4gYnkgYW55IGBvdmVyZmxvdzogaGlkZGVuO2AgcnVsZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVQb3B1cENsb25lICgpIHtcbiAgICAgICRwb3B1cENsb25lID0gJHBvcHVwLmNsb25lKHRydWUpXG4gICAgICAgIC5hcHBlbmRUbygkYm9keSlcbiAgICAgICAgLmFkZENsYXNzKCdjaXZpaHItcG9wdXAnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMaXN0ZW5zIHRvIG1vdXNlIGV2ZW50cyBoYXBwZW5pbmcgb3V0c2lkZSB0aGUgb2YgdGhlIHBhbmVsIGluIG9yZGVyIHRvXG4gICAgICogY2xvc2UgaXQuIFRoZSB3YXkgdG8gZGV0ZWN0ZWQgbW91c2Ugb3V0IGlzIGJ5IGxpc3RlbmluZyB0byB0aGVcbiAgICAgKiAuYnRuLXNsaWRlLWFjdGl2ZSBjbGFzcyBjaGFuZ2UsIHdoaWNoIGlzIGFkZGVkIGFuZCByZW1vdmVkIGJ5IENpdmlDUk0uXG4gICAgICogdGhlIGRhdGEgKmF0dHJjaGFuZ2UtaXMtb24qIGlzIHNldCB0byB0cnVlIGluIG9yZGVyIHRvIGF2b2lkIGFkZGluZ1xuICAgICAqIG11bHRpcGxlIGxpc3RlbmVycyB0byB0aGUgc2FtZSBlbGVtZW50LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpc3RlblRvTW91c2VPdXRFdmVudCAoKSB7XG4gICAgICAvLyBJZiBBdHRyQ2hhbmdlIGV2ZW50IGlzIGFscmVhZHkgbGlzdGVuZWQsIHRoZW4gc2tpcDpcbiAgICAgIGlmICgkYnV0dG9uLmRhdGEoJ2F0dHJjaGFuZ2UtaXMtb24nKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgICRidXR0b24uZGF0YSgnYXR0cmNoYW5nZS1pcy1vbicsIHRydWUpO1xuICAgICAgJGJ1dHRvbi5hdHRyY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSWYgYnV0dG9uIGlzIGFscmVhZHkgb3BlbiwgdGhlbiBza2lwOlxuICAgICAgICBpZiAoJGJ1dHRvbi5oYXNDbGFzcygnYnRuLXNsaWRlLWFjdGl2ZScpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xvc2VQb3B1cFBhbmVscygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFwcyBjbGljayBldmVudHMgb24gdGhlIHBvcHVwIG9wdGlvbnMgYmFjayB0byB0aGVpciBvcmlnaW5hbCBzb3VyY2UuXG4gICAgICogVGhpcyBpcyBkb25lIGJlY2F1c2UgcG9wdXAgYWN0aW9ucyBhcmUgZXhlY3V0ZWQgYXMgZGVsZWdhdGVkIGV2ZW50cyBhbmRcbiAgICAgKiB0aGUgbGlzdGVuZXIgaXMgbm90IHRoZSAqYm9keSogZWxlbWVudC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4gKCkge1xuICAgICAgJHBvcHVwQ2xvbmUuZmluZCgnYScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFjdGlvbkluZGV4ID0gJCh0aGlzKS5wYXJlbnQoKS5pbmRleCgpO1xuXG4gICAgICAgICRwb3B1cC5maW5kKCdsaTpudGgoJyArIGFjdGlvbkluZGV4ICsgJykgYScpLmNsaWNrKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgcG9wdXAgcGFuZWwgY2xvbmVcbiAgICAgKiBhbmQgYWRkcyB0aGUgLmNpdmloci1wb3B1cC1vcGVuIGNsYXNzIHRvIHRoZSBib2R5XG4gICAgICovXG4gICAgZnVuY3Rpb24gb3BlblBvcHVwQ2xvbmUgKCkge1xuICAgICAgdmFyIGJ1dHRvbk9mZnNldCA9ICRidXR0b24ub2Zmc2V0KCk7XG5cbiAgICAgICRwb3B1cENsb25lLmNzcyh7XG4gICAgICAgIGxlZnQ6ICtidXR0b25PZmZzZXQubGVmdCAtICgkcG9wdXBDbG9uZS53aWR0aCgpIC0gJGJ1dHRvbi5vdXRlcldpZHRoKCkpLFxuICAgICAgICB0b3A6ICtidXR0b25PZmZzZXQudG9wICsgJGJ1dHRvbi5vdXRlckhlaWdodCgpXG4gICAgICB9KTtcbiAgICAgICRwb3B1cENsb25lLnNob3coKTtcbiAgICAgICRib2R5LmFkZENsYXNzKCdjaXZpaHItcG9wdXAtb3BlbicpO1xuICAgIH1cbiAgfSk7XG59KShDUk0uJCk7XG4iXX0=
